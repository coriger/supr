(function(){var a=window.location.host,b="http://"+a+"/ueditor/",c="http://s.srcdd.com/js/lib/ueditor/",d="http://s.libdd.com";window.UEDITOR_HOME_URL=b,UEDITOR_CONFIG={imagePath:b+"server/upload/",compressSide:0,maxImageSideLength:900,relativePath:!0,filePath:b+"server/upload/",catchRemoteImageEnable:!1,catcherUrl:b+"server/submit/getRemoteImage.php",localDomain:"baidu.com",imageManagerPath:b+"server/submit/imageManager.php",UEDITOR_HOME_URL:b,toolbars:[["FullScreen","Source","|","Undo","Redo","|","Bold","Italic","Underline","StrikeThrough","Superscript","Subscript","RemoveFormat","FormatMatch","|","BlockQuote","|","PastePlain","|","ForeColor","BackColor","InsertOrderedList","InsertUnorderedList","|","CustomStyle","Paragraph","RowSpacing","LineHeight","FontFamily","FontSize","|","DirectionalityLtr","DirectionalityRtl","|","","Indent","|","JustifyLeft","JustifyCenter","JustifyRight","JustifyJustify","|","Link","Unlink","Anchor","|","ImageNone","ImageLeft","ImageRight","ImageCenter","|","InsertImage","Emotion","InsertVideo","Map","GMap","InsertFrame","PageBreak","HighlightCode","|","Horizontal","Date","Time","Spechars","|","InsertTable","DeleteTable","InsertParagraphBeforeTable","InsertRow","DeleteRow","InsertCol","DeleteCol","MergeCells","MergeRight","MergeDown","SplittoCells","SplittoRows","SplittoCols","|","SelectAll","ClearDoc","SearchReplace","SnapScreen","Print","Preview","CheckImage","Attachment","Help","AutoTypeSet","Intro","Code"]],labelMap:{anchor:"\u951a\u70b9",undo:"\u64a4\u9500",redo:"\u91cd\u505a",bold:"\u52a0\u7c97",indent:"\u9996\u884c\u7f29\u8fdb",snapscreen:"\u622a\u56fe",italic:"\u659c\u4f53",underline:"\u4e0b\u5212\u7ebf",strikethrough:"\u5220\u9664\u7ebf",subscript:"\u4e0b\u6807",superscript:"\u4e0a\u6807",formatmatch:"\u683c\u5f0f\u5237",source:"\u6e90\u4ee3\u7801",blockquote:"\u5f15\u7528",pasteplain:"\u7eaf\u6587\u672c\u7c98\u8d34\u6a21\u5f0f",selectall:"\u5168\u9009",print:"\u6253\u5370",preview:"\u9884\u89c8",horizontal:"\u5206\u9694\u7ebf",removeformat:"\u6e05\u9664\u683c\u5f0f",time:"\u65f6\u95f4",date:"\u65e5\u671f",unlink:"\u53d6\u6d88\u94fe\u63a5",insertrow:"\u524d\u63d2\u5165\u884c",insertcol:"\u524d\u63d2\u5165\u5217",mergeright:"\u53f3\u5408\u5e76\u5355\u5143\u683c",mergedown:"\u4e0b\u5408\u5e76\u5355\u5143\u683c",deleterow:"\u5220\u9664\u884c",deletecol:"\u5220\u9664\u5217",splittorows:"\u62c6\u5206\u6210\u884c",splittocols:"\u62c6\u5206\u6210\u5217",splittocells:"\u5b8c\u5168\u62c6\u5206\u5355\u5143\u683c",mergecells:"\u5408\u5e76\u591a\u4e2a\u5355\u5143\u683c",deletetable:"\u5220\u9664\u8868\u683c",insertparagraphbeforetable:"\u8868\u683c\u524d\u63d2\u884c",cleardoc:"\u6e05\u7a7a\u6587\u6863",fontfamily:"\u5b57\u4f53",fontsize:"\u5b57\u53f7",paragraph:"\u6bb5\u843d\u683c\u5f0f",insertimage:"\u56fe\u7247",inserttable:"\u8868\u683c",link:"\u94fe\u63a5",emotion:"\u8868\u60c5",spechars:"\u7279\u6b8a\u5b57\u7b26",searchreplace:"\u67e5\u8be2\u66ff\u6362",map:"Baidu\u5730\u56fe",gmap:"Google\u5730\u56fe",insertvideo:"\u89c6\u9891",help:"\u5e2e\u52a9",justifyleft:"\u5c45\u5de6\u5bf9\u9f50",justifyright:"\u5c45\u53f3\u5bf9\u9f50",justifycenter:"\u5c45\u4e2d\u5bf9\u9f50",justifyjustify:"\u4e24\u7aef\u5bf9\u9f50",forecolor:"\u5b57\u4f53\u989c\u8272",backcolor:"\u80cc\u666f\u8272",insertorderedlist:"\u6709\u5e8f\u5217\u8868",insertunorderedlist:"\u65e0\u5e8f\u5217\u8868",fullscreen:"\u5168\u5c4f",directionalityltr:"\u4ece\u5de6\u5411\u53f3\u8f93\u5165",directionalityrtl:"\u4ece\u53f3\u5411\u5de6\u8f93\u5165",rowspacing:"\u6bb5\u95f4\u8ddd",highlightcode:"\u63d2\u5165\u4ee3\u7801",pagebreak:"\u5206\u9875",insertframe:"\u63d2\u5165Iframe",imagenone:"\u9ed8\u8ba4",imageleft:"\u5c45\u5de6",imageright:"\u5c45\u53f3",attachment:"\u9644\u4ef6",imagecenter:"\u5c45\u4e2d",checkimage:"\u56fe\u7247\u8f6c\u5b58",lineheight:"\u884c\u95f4\u8ddd",customstyle:"\u81ea\u5b9a\u4e49\u6807\u9898",autotypeset:"\u81ea\u52a8\u6392\u7248",insertcode:"\u63d2\u5165\u4ee3\u7801",code:"\u63d2\u5165\u4ee3\u7801",intro:"\u67e5\u770b\u7f16\u8f91\u5668\u4f7f\u7528\u8bf4\u660e"},iframeUrlMap:{anchor:"~/dialogs/anchor/anchor.html",insertimage:"~/dialogs/image/image.html",inserttable:"~/dialogs/table/table.html",link:"~/link?host="+document.domain,insertcode:"~/code?host="+document.domain,spechars:"~/dialogs/spechars/spechars.html",searchreplace:"~/dialogs/searchreplace/searchreplace.html",map:"~/dialogs/map/map.html",gmap:"~/dialogs/gmap/gmap.html",insertvideo:"~/dialogs/video/video.html",help:"~/dialogs/help/help.html",highlightcode:"~/dialogs/code/code.html",emotion:"~/dialogs/emotion/emotion.html",wordimage:"~/dialogs/wordimage/wordimage.html",attachment:"~/dialogs/attachment/attachment.html",insertframe:"~/dialogs/insertframe/insertframe.html",edittd:"~/dialogs/table/edittd.html",snapscreen:"~/dialogs/snapscreen/snapscreen.html"},listMap:{fontfamily:["\u5b8b\u4f53","\u6977\u4f53","\u96b6\u4e66","\u9ed1\u4f53","andale mono","arial","arial black","comic sans ms","impact","times new roman"],fontsize:[10,11,12,14,16,18,20,24,36],paragraph:["p:\u6bb5\u843d","h1:\u6807\u9898 1","h2:\u6807\u9898 2","h3:\u6807\u9898 3","h4:\u6807\u9898 4","h5:\u6807\u9898 5","h6:\u6807\u9898 6"],rowspacing:["5","10","15","20","25"],lineheight:["100","125","150","200","300","400","500"],customstyle:[{tag:"h1",label:"\u5c45\u4e2d\u6807\u9898",style:"border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;"},{tag:"h1",label:"\u5c45\u5de6\u6807\u9898",style:"border-bottom:#ccc 2px solid;padding:0 4px 0 0;margin:0 0 10px 0;"},{tag:"span",label:"\u5f3a\u8c03",style:"font-style:italic;font-weight:bold"},{tag:"span",label:"\u660e\u663e\u5f3a\u8c03",style:"font-style:italic;font-weight:bold;color:rgb(51, 153, 204)"}]},fontMap:{"\u5b8b\u4f53":["\u5b8b\u4f53","SimSun"],"\u6977\u4f53":["\u6977\u4f53","\u6977\u4f53_GB2312","SimKai"],"\u9ed1\u4f53":["\u9ed1\u4f53","SimHei"],"\u96b6\u4e66":["\u96b6\u4e66","SimLi"],"andale mono":["andale mono"],arial:["arial","helvetica","sans-serif"],"arial black":["arial black","avant garde"],"comic sans ms":["comic sans ms"],impact:["impact","chicago"],"times new roman":["times new roman"]},contextMenu:[],initialStyle:'.selectTdClass{background-color:#3399FF !important}table{clear:both;margin-bottom:10px;border-collapse:collapse;word-break:break-all;}.pagebreak{border-bottom:1px dotted #999999 !important;border-top:1px dotted #999999 !important;clear:both !important;cursor:default !important;height: 5px !important;padding: 0 !important;width: 100% !important;margin-bottom:10px;height:5px !important;overflow: hidden;}.anchorclass{background: url("'+c+'themes/default/images/anchor.gif") no-repeat scroll left center transparent;border: 1px dotted #0000FF;cursor: auto;display: inline-block;height: 16px;width: 15px;}'+".view{padding:0;word-wrap:break-word;word-break:break-all;cursor:text;height:100%;}\n"+'body{margin:8px;font-family:"\u5b8b\u4f53";font-size:16px;}'+"li{clear:both}"+"p{margin:5px 0;}"+".tableclear{clear:both;margin:0;padding:0;}",initialContent:"",autoClearinitialContent:!1,iframeCssUrl:c+"themes/default/iframe.css",removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign",enterTag:"p",maxUndoCount:20,maxInputCount:20,selectedTdClass:"selectTdClass",pasteplain:!1,textarea:"editorValue",focus:!1,indentValue:"2em",pageBreakTag:"_dd_page_break_tag_",minFrameHeight:320,autoHeightEnabled:!0,autoFloatEnabled:!0,elementPathEnabled:!0,wordCount:!0,maximumWords:1e4,tabSize:4,tabNode:"&nbsp;",imagePopup:!0,emotionLocalization:!0,sourceEditor:"textarea",tdHeight:"20",highlightJsUrl:d+"/js/lib/SyntaxHighlighter/shCore.$6941.js",highlightCssUrl:c+"third-party/SyntaxHighlighter/shCoreDefault.css",zIndex:999,fullscrren:!1,snapscreenHost:"localhost",snapscreenServerFile:b+"server/upload/php/snapImgUp.php",snapscreenServerPort:80,snapscreenImgAlign:"center",snapscreenImgIsUseImagePath:1,messages:{pasteMsg:"\u7f16\u8f91\u5668\u5c06\u8fc7\u6ee4\u6389\u60a8\u7c98\u8d34\u5185\u5bb9\u4e2d\u7684\u4e0d\u652f\u6301\u683c\u5f0f\uff01",wordCountMsg:"\u5f53\u524d\u5df2\u8f93\u5165 {#count} \u4e2a\u5b57\u7b26\uff0c\u60a8\u8fd8\u53ef\u4ee5\u8f93\u5165{#leave} \u4e2a\u5b57\u7b26 ",wordOverFlowMsg:"\u4f60\u8f93\u5165\u7684\u5b57\u7b26\u4e2a\u6570\u5df2\u7ecf\u8d85\u51fa\u6700\u5927\u5141\u8bb8\u503c\uff0c\u670d\u52a1\u5668\u53ef\u80fd\u4f1a\u62d2\u7edd\u4fdd\u5b58\uff01",pasteWordImgMsg:"\u60a8\u7c98\u8d34\u7684\u5185\u5bb9\u4e2d\u5305\u542b\u672c\u5730\u56fe\u7247\uff0c\u9700\u8981\u8f6c\u5b58\u540e\u624d\u80fd\u6b63\u786e\u663e\u793a\uff01",snapScreenNotIETip:"\u622a\u56fe\u529f\u80fd\u9700\u8981\u5728ie\u6d4f\u89c8\u5668\u4e0b\u4f7f\u7528",snapScreenMsg:"\u622a\u56fe\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u4f60\u7684PHP\u73af\u5883\u3002 "},serialize:function(){return{blackList:{style:1,script:1,link:1,object:1,applet:1,input:1,meta:1,base:1,button:1,select:1,textarea:1,"#comment":1,map:1,area:1}}}(),ComboxInitial:{FONT_FAMILY:"\u5b57\u4f53",FONT_SIZE:"\u5b57\u53f7",ROW_SPACING:"\u6bb5\u95f4\u8ddd",PARAGRAPH:"\u6bb5\u843d\u683c\u5f0f",LINE_HEIGHT:"\u884c\u95f4\u8ddd",CUSTOMSTYLE:"\u81ea\u5b9a\u4e49\u6837\u5f0f"},autotypeset:{mergeEmptyline:!0,removeClass:!0,removeEmptyline:!1,textAlign:"left",lineHeight:"100",rowSpacing:"10",imageBlockLine:"center",pasteFilter:!1,clearFontSize:!1,clearFontFamily:!1,removeEmptyNode:!1,removeTagNames:{div:1,a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},indent:!1,indentValue:"2em"}}})(),function(){function getListener(a,b,c){var d;return b=b.toLowerCase(),(d=a.__allListeners||c&&(a.__allListeners={}))&&(d[b]||c&&(d[b]=[]))}function getDomNode(a,b,c,d,e,f){var g=d&&a[b],h;!g&&(g=a[c]);while(!g&&(h=(h||a).parentNode)){if(h.tagName=="BODY"||f&&!f(h))return null;g=h[c]}return g&&e&&!e(g)?getDomNode(g,b,c,!1,e):g}UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var baidu=window.baidu||{};window.baidu=baidu,window.UE=baidu.editor={},UE.plugins={},UE.commands={},UE.version="1.2.0.0";var dom=UE.dom={},browser=UE.browser=function(){var a=navigator.userAgent.toLowerCase(),b=window.opera,c={ie:!!window.ActiveXObject,opera:!!b&&b.version,webkit:a.indexOf(" applewebkit/")>-1,mac:a.indexOf("macintosh")>-1,quirks:document.compatMode=="BackCompat"};c.gecko=navigator.product=="Gecko"&&!c.webkit&&!c.opera;var d=0;c.ie&&(d=parseFloat(a.match(/msie (\d+)/)[1]),c.ie8=!!document.documentMode,c.ie8Compat=document.documentMode==8,c.ie7Compat=d==7&&!document.documentMode||document.documentMode==7,c.ie6Compat=d<7||c.quirks);if(c.gecko){var e=a.match(/rv:([\d\.]+)/);e&&(e=e[1].split("."),d=e[0]*1e4+(e[1]||0)*100+(e[2]||0)*1)}return/chrome\/(\d+\.\d)/i.test(a)&&(c.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(a)&&!/chrome/i.test(a)&&(c.safari=+(RegExp.$1||RegExp.$2)),c.opera&&(d=parseFloat(b.version())),c.webkit&&(d=parseFloat(a.match(/ applewebkit\/(\d+)/)[1])),c.version=d,c.isCompatible=!c.mobile&&(c.ie&&d>=6||c.gecko&&d>=10801||c.opera&&d>=9.5||c.air&&d>=1||c.webkit&&d>=522||!1),c}(),ie=browser.ie,webkit=browser.webkit,gecko=browser.gecko,utils=UE.utils={makeInstance:function(a){var b=new Function;return b.prototype=a,a=new b,b.prototype=null,a},extend:function(a,b,c){if(b)for(var d in b)if(!c||!a.hasOwnProperty(d))a[d]=b[d];return a},isArray:function(a){return Object.prototype.toString.apply(a)==="[object Array]"},isString:function(a){return typeof a=="string"||a.constructor==String},inherits:function(a,b){var c=a.prototype,d=utils.makeInstance(b.prototype);return utils.extend(d,c,!0),a.prototype=d,d.constructor=a},bind:function(a,b){return function(){return a.apply(b,arguments)}},defer:function(a,b,c){var d;return function(){c&&clearTimeout(d),d=setTimeout(a,b)}},indexOf:function(a,b,c){for(var d=c||0,e=a.length;d<e;d++)if(a[d]===b)return d;return-1},findNode:function(a,b,c){for(var d=0,e;e=a[d++];)if(c?c(e):this.indexOf(b,e.tagName.toLowerCase())!=-1)return e},removeItem:function(a,b){for(var c=0,d=a.length;c<d;c++)a[c]===b&&(a.splice(c,1),c--)},trim:function(a){return a.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(a){if(!a)return{};a=utils.isArray(a)?a:a.split(",");for(var b=0,c,d={};c=a[b++];)d[c.toUpperCase()]=d[c]=1;return d},unhtml:function(a){return a?a.replace(/[&<">]/g,function(a){return{"<":"&lt;","&":"&amp",'"':"&quot;",">":"&gt;"}[a]}):""},cssStyleToDomStyle:function(){var a=document.createElement("div").style,b={"float":a.cssFloat!=undefined?"cssFloat":a.styleFloat!=undefined?"styleFloat":"float"};return function(a){return b[a]||(b[a]=a.toLowerCase().replace(/-./g,function(a){return a.charAt(1).toUpperCase()}))}}(),loadFile:function(a,b,c){if(b.id&&a.getElementById(b.id))return;var d=a.createElement(b.tag);delete b.tag;for(var e in b)d.setAttribute(e,b[e]);d.onload=d.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState))c&&c(),d.onload=d.onreadystatechange=null},a.getElementsByTagName("head")[0].appendChild(d)},isEmptyObject:function(a){for(var b in a)return!1;return!0},fixColor:function(a,b){if(/color/i.test(a)&&/rgba?/.test(b)){var c=b.split(",");if(c.length>3)return"";b="#";for(var d=0,e;e=c[d++];)e=parseInt(e.replace(/[^\d]/gi,""),10).toString(16),b+=e.length==1?"0"+e:e;b=b.toUpperCase()}return b},optCss:function(a){function e(a,b){if(!a)return"";var c=a.top,d=a.bottom,e=a.left,f=a.right,g="";if(!c||!e||!d||!f)for(var h in a)g+=";"+b+"-"+h+":"+a[h]+";";else g+=";"+b+":"+(c==d&&d==e&&e==f?c:c==d&&e==f?c+" "+e:e==f?c+" "+e+" "+d:c+" "+f+" "+d+" "+e)+";";return g}var b,c,d;return a=a.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(a,d,e,f){if(f.split(" ").length==1)switch(d){case"padding":return!b&&(b={}),b[e]=f,"";case"margin":return!c&&(c={}),c[e]=f,"";case"border":return f=="initial"?"":a}return a}),a+=e(b,"padding")+e(c,"margin"),a.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(a,b){return b?b+";;":";"})}},EventBase=UE.EventBase=function(){};EventBase.prototype={addListener:function(a,b){getListener(this,a,!0).push(b)},removeListener:function(a,b){var c=getListener(this,a);c&&utils.removeItem(c,b)},fireEvent:function(a){var b=getListener(this,a),c,d,e;if(b){e=b.length;while(e--)d=b[e].apply(this,arguments),d!==undefined&&(c=d)}if(d=this["on"+a.toLowerCase()])c=d.apply(this,arguments);return c}};var dtd=dom.dtd=function(){function a(a){for(var b in a)a[b.toUpperCase()]=a[b];return a}function b(a){var b=arguments;for(var c=1;c<b.length;c++){var d=b[c];for(var e in d)a.hasOwnProperty(e)||(a[e]=d[e])}return a}var c=a({isindex:1,fieldset:1}),d=a({input:1,button:1,select:1,textarea:1,label:1}),e=b(a({a:1}),d),f=b({iframe:1},e),g=a({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),h=a({ins:1,del:1,script:1,style:1}),i=b(a({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),h),j=b(a({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),i),k=b(a({p:1}),j),l=b(a({iframe:1}),j,d),m=a({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),n=b(a({a:0}),l),o=a({tr:1}),p=a({"#":1}),q=b(a({param:1}),m),r=b(a({form:1}),c,f,g,k),s=a({li:1}),t=a({style:1,script:1}),u=a({base:1,link:1,meta:1,title:1}),v=b(u,t),w=a({head:1,body:1}),x=a({html:1}),y=a({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),z=a({area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1,embed:1});return a({$nonBodyContent:b(x,w,u),$block:y,$inline:n,$body:b(a({script:1,style:1}),y),$cdata:a({script:1,style:1}),$empty:z,$nonChild:a({iframe:1}),$listItem:a({dd:1,dt:1,li:1}),$list:a({ul:1,ol:1,dl:1}),$isNotEmpty:a({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1}),$removeEmpty:a({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:a({p:1,div:1}),$tableContent:a({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:a({pre:1,script:1,style:1,textarea:1}),html:w,head:v,style:p,script:p,body:r,base:{},link:{},meta:{},title:p,col:{},tr:a({td:1,th:1}),img:{},embed:{},colgroup:a({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:r,td:r,br:{},th:r,center:r,kbd:n,button:b(k,g),basefont:{},h5:n,h4:n,samp:n,h6:n,ol:s,h1:n,h3:n,option:p,h2:n,form:b(c,f,g,k),select:a({optgroup:1,option:1}),font:n,ins:n,menu:s,abbr:n,label:n,table:a({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:n,tfoot:o,cite:n,li:r,input:{},iframe:r,strong:n,textarea:p,noframes:r,big:n,small:n,span:a({"#":1,br:1}),hr:n,dt:n,sub:n,optgroup:a({option:1}),param:{},bdo:n,"var":n,div:r,object:q,sup:n,dd:r,strike:n,area:{},dir:s,map:b(a({area:1,form:1,p:1}),c,h,g),applet:q,dl:a({dt:1,dd:1}),del:n,isindex:{},fieldset:b(a({legend:1}),m),thead:o,ul:s,acronym:n,b:n,a:b(a({a:1}),l),blockquote:b(a({td:1,tr:1,tbody:1,li:1}),r),caption:n,i:n,u:n,tbody:o,s:n,address:b(f,k),tt:n,legend:n,q:n,pre:b(i,e),p:b(a({a:1}),n),em:n,dfn:n})}(),attrFix=ie&&browser.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},styleBlock=utils.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]),domUtils=dom.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:ie&&browser.version=="6"?"\ufeff":"\u200b",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(a,b){if(a===b)return 0;var c,d=[a],e=[b];c=a;while(c=c.parentNode){if(c===b)return 10;d.push(c)}c=b;while(c=c.parentNode){if(c===a)return 20;e.push(c)}d.reverse(),e.reverse();if(d[0]!==e[0])return 1;var f=-1;while(f++,d[f]===e[f]);a=d[f],b=e[f];while(a=a.nextSibling)if(a===b)return 4;return 2},getNodeIndex:function(a){var b=a.parentNode.firstChild,c=0;while(a!==b)c++,b=b.nextSibling;return c},inDoc:function(a,b){while(a=a.parentNode)if(a===b)return!0;return!1},findParent:function(a,b,c){if(!domUtils.isBody(a)){a=c?a:a.parentNode;while(a){if(!b||b(a)||this.isBody(a))return b&&!b(a)&&this.isBody(a)?null:a;a=a.parentNode}}return null},findParentByTagName:function(a,b,c,d){if(a&&a.nodeType&&!this.isBody(a)&&(a.nodeType==1||a.nodeType)){b=utils.listToMap(utils.isArray(b)?b:[b]),a=a.nodeType==3||!c?a.parentNode:a;while(a&&a.tagName&&a.nodeType!=9){if(d&&d(a))break;if(b[a.tagName])return a;a=a.parentNode}}return null},findParents:function(a,b,c,d){var e=b&&(c&&c(a)||!c)?[a]:[];while(a=domUtils.findParent(a,c))e.push(a);return d?e:e.reverse()},insertAfter:function(a,b){return a.parentNode.insertBefore(b,a.nextSibling)},remove:function(a,b){var c=a.parentNode,d;if(c){if(b&&a.hasChildNodes())while(d=a.firstChild)c.insertBefore(d,a);c.removeChild(a)}return a},getNextDomNode:function(a,b,c,d){return getDomNode(a,"firstChild","nextSibling",b,c,d)},isBookmarkNode:function(a){return a.nodeType==1&&a.id&&/^_baidu_bookmark_/i.test(a.id)},getWindow:function(a){var b=a.ownerDocument||a;return b.defaultView||b.parentWindow},getCommonAncestor:function(a,b){if(a===b)return a;var c=[a],d=[b],e=a,f=-1;while(e=e.parentNode){if(e===b)return e;c.push(e)}e=b;while(e=e.parentNode){if(e===a)return e;d.push(e)}c.reverse(),d.reverse();while(f++,c[f]===d[f]);return f==0?null:c[f-1]},clearEmptySibling:function(a,b,c){function d(a,b){var c;while(a&&!domUtils.isBookmarkNode(a)&&(domUtils.isEmptyInlineElement(a)||domUtils.isWhitespace(a)))c=a[b],domUtils.remove(a),a=c}!b&&d(a.nextSibling,"nextSibling"),!c&&d(a.previousSibling,"previousSibling")},split:function(a,b){var c=a.ownerDocument;if(browser.ie&&b==a.nodeValue.length){var d=c.createTextNode("");return domUtils.insertAfter(a,d)}var e=a.splitText(b);if(browser.ie8){var f=c.createTextNode("");domUtils.insertAfter(e,f),domUtils.remove(f)}return e},isWhitespace:function(a){return!(new RegExp("[^ 	\n\r"+domUtils.fillChar+"]")).test(a.nodeValue)},getXY:function(a){var b=0,c=0;while(a.offsetParent)c+=a.offsetTop,b+=a.offsetLeft,a=a.offsetParent;return{x:b,y:c}},on:function(a,b,c){var d=b instanceof Array?b:[b],e=d.length;if(e)while(e--){b=d[e];if(a.addEventListener)a.addEventListener(b,c,!1);else{c._d||(c._d={});var f=b+c.toString();c._d[f]||(c._d[f]=function(a){return c.call(a.srcElement,a||window.event)},a.attachEvent("on"+b,c._d[f]))}}a=null},un:function(a,b,c){var d=b instanceof Array?b:[b],e=d.length;if(e)while(e--){b=d[e];if(a.removeEventListener)a.removeEventListener(b,c,!1);else{var f=b+c.toString();a.detachEvent("on"+b,c._d?c._d[f]:c),c._d&&c._d[f]&&delete c._d[f]}}},isSameElement:function(a,b){if(a.tagName!=b.tagName)return 0;var c=a.attributes,d=b.attributes;if(!ie&&c.length!=d.length)return 0;var e,f,g=0,h=0;for(var i=0;e=c[i++];){if(e.nodeName=="style"){e.specified&&g++;if(domUtils.isSameStyle(a,b))continue;return 0}if(ie){if(!e.specified)continue;g++,f=d.getNamedItem(e.nodeName)}else f=b.attributes[e.nodeName];if(!f.specified)return 0;if(e.nodeValue!=f.nodeValue)return 0}if(ie){for(i=0;f=d[i++];)f.specified&&h++;if(g!=h)return 0}return 1},isSameStyle:function(a,b){var c=a.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),d=b.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(!c||!d)return c==d?1:0;c=c.split(";"),d=d.split(";");if(c.length!=d.length)return 0;for(var e=0,f;f=c[e++];)if(utils.indexOf(d,f)==-1)return 0;return 1},isBlockElm:function(a){return a.nodeType==1&&(dtd.$block[a.tagName]||styleBlock[domUtils.getComputedStyle(a,"display")])&&!dtd.$nonChild[a.tagName]},isBody:function(a){return a&&a.nodeType==1&&a.tagName.toLowerCase()=="body"},breakParent:function(a,b){var c,d=a,e=a,f,g;do{d=d.parentNode,f?(c=d.cloneNode(!1),c.appendChild(f),f=c,c=d.cloneNode(!1),c.appendChild(g),g=c):(f=d.cloneNode(!1),g=f.cloneNode(!1));while(c=e.previousSibling)f.insertBefore(c,f.firstChild);while(c=e.nextSibling)g.appendChild(c);e=d}while(b!==d);return c=b.parentNode,c.insertBefore(f,b),c.insertBefore(g,b),c.insertBefore(a,g),domUtils.remove(b),a},isEmptyInlineElement:function(a){if(a.nodeType!=1||!dtd.$removeEmpty[a.tagName])return 0;a=a.firstChild;while(a){if(domUtils.isBookmarkNode(a))return 0;if(a.nodeType==1&&!domUtils.isEmptyInlineElement(a)||a.nodeType==3&&!domUtils.isWhitespace(a))return 0;a=a.nextSibling}return 1},trimWhiteTextNode:function(a){function b(b){var c;while((c=a[b])&&c.nodeType==3&&domUtils.isWhitespace(c))a.removeChild(c)}b("firstChild"),b("lastChild")},mergChild:function(a,b,c){var d=domUtils.getElementsByTagName(a,a.tagName.toLowerCase());for(var e=0,f;f=d[e++];){if(!f.parentNode||domUtils.isBookmarkNode(f))continue;if(f.tagName.toLowerCase()=="span"){if(a===f.parentNode){domUtils.trimWhiteTextNode(a);if(a.childNodes.length==1){a.style.cssText=f.style.cssText+";"+a.style.cssText,domUtils.remove(f,!0);continue}}f.style.cssText=a.style.cssText+";"+f.style.cssText;if(c){var g=c.style;if(g){g=g.split(";");for(var h=0,i;i=g[h++];)f.style[utils.cssStyleToDomStyle(i.split(":")[0])]=i.split(":")[1]}}domUtils.isSameStyle(f,a)&&domUtils.remove(f,!0);continue}domUtils.isSameElement(a,f)&&domUtils.remove(f,!0)}if(b=="span"){var j=domUtils.getElementsByTagName(a,"a");for(var e=0,k;k=j[e++];)k.style.cssText=";"+a.style.cssText,k.style.textDecoration="underline"}},getElementsByTagName:function(a,b){var c=a.getElementsByTagName(b),d=[];for(var e=0,f;f=c[e++];)d.push(f);return d},mergToParent:function(a){var b=a.parentNode;while(b&&dtd.$removeEmpty[b.tagName]){if(b.tagName==a.tagName||b.tagName=="A"){domUtils.trimWhiteTextNode(b);if(b.tagName=="SPAN"&&!domUtils.isSameStyle(b,a)||b.tagName=="A"&&a.tagName=="SPAN"){if(b.childNodes.length>1||b!==a.parentNode){a.style.cssText=b.style.cssText+";"+a.style.cssText,b=b.parentNode;continue}b.style.cssText+=";"+a.style.cssText,b.tagName=="A"&&(b.style.textDecoration="underline")}if(b.tagName!="A"){b===a.parentNode&&domUtils.remove(a,!0);break}}b=b.parentNode}},mergSibling:function(a,b,c){function d(a,b,c){var d;if((d=c[a])&&!domUtils.isBookmarkNode(d)&&d.nodeType==1&&domUtils.isSameElement(c,d)){while(d.firstChild)b=="firstChild"?c.insertBefore(d.lastChild,c.firstChild):c.appendChild(d.firstChild);domUtils.remove(d)}}!b&&d("previousSibling","firstChild",a),!c&&d("nextSibling","lastChild",a)},unselectable:gecko?function(a){a.style.MozUserSelect="none"}:webkit?function(a){a.style.KhtmlUserSelect="none"}:function(a){a.onselectstart=function(){return!1},a.onclick=a.onkeyup=a.onkeydown=function(){return!1},a.unselectable="on",a.setAttribute("unselectable","on");for(var b=0,c;c=a.all[b++];)switch(c.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:c.unselectable="on",a.setAttribute("unselectable","on")}},removeAttributes:function(a,b){for(var c=0,d;d=b[c++];){d=attrFix[d]||d;switch(d){case"className":a[d]="";break;case"style":a.style.cssText="",!browser.ie&&a.removeAttributeNode(a.getAttributeNode("style"))}a.removeAttribute(d)}},setAttributes:function(a,b){for(var c in b){var d=b[c];switch(c){case"class":a.className=d;break;case"style":a.style.cssText=a.style.cssText+";"+d;break;case"innerHTML":a[c]=d;break;case"value":a.value=d;break;default:a.setAttribute(attrFix[c]||c,d)}}return a},getComputedStyle:function(a,b){function c(a,b){return a=="font-size"&&/pt$/.test(b)&&(b=Math.round(parseFloat(b)/.75)+"px"),b}a.nodeType==3&&(a=a.parentNode);if(browser.ie&&browser.version<9&&b=="font-size"&&!a.style.fontSize&&!dtd.$empty[a.tagName]&&!dtd.$nonChild[a.tagName]){var d=a.ownerDocument.createElement("span");d.style.cssText="padding:0;border:0;font-family:simsun;",d.innerHTML=".",a.appendChild(d);var e=d.offsetHeight;return a.removeChild(d),d=null,e+"px"}try{var f=domUtils.getStyle(a,b)||(window.getComputedStyle?domUtils.getWindow(a).getComputedStyle(a,"").getPropertyValue(b):(a.currentStyle||a.style)[utils.cssStyleToDomStyle(b)])}catch(g){return null}return c(b,utils.fixColor(b,f))},removeClasses:function(a,b){a.className=(" "+a.className+" ").replace(new RegExp("(?:\\s+(?:"+b.join("|")+"))+\\s+","g")," ")},removeStyle:function(a,b){a.style[utils.cssStyleToDomStyle(b)]="",a.style.cssText||domUtils.removeAttributes(a,["style"])},hasClass:function(a,b){return(" "+a.className+" ").indexOf(" "+b+" ")>-1},preventDefault:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1},getStyle:function(a,b){var c=a.style[utils.cssStyleToDomStyle(b)];return utils.fixColor(b,c)},setStyle:function(a,b,c){a.style[utils.cssStyleToDomStyle(b)]=c},setStyles:function(a,b){for(var c in b)b.hasOwnProperty(c)&&domUtils.setStyle(a,c,b[c])},removeDirtyAttr:function(a){for(var b=0,c,d=a.getElementsByTagName("*");c=d[b++];)c.removeAttribute("_moz_dirty");a.removeAttribute("_moz_dirty")},getChildCount:function(a,b){var c=0,d=a.firstChild;b=b||function(){return 1};while(d)b(d)&&c++,d=d.nextSibling;return c},isEmptyNode:function(a){return!a.firstChild||domUtils.getChildCount(a,function(a){return!domUtils.isBr(a)&&!domUtils.isBookmarkNode(a)&&!domUtils.isWhitespace(a)})==0},clearSelectedArr:function(a){var b;while(b=a.pop())domUtils.removeAttributes(b,["class"])},scrollToView:function(a,b,c){var d=function(){var a=b.document,c=a.compatMode=="CSS1Compat";return{width:(c?a.documentElement.clientWidth:a.body.clientWidth)||0,height:(c?a.documentElement.clientHeight:a.body.clientHeight)||0}},e=function(a){if("pageXOffset"in a)return{x:a.pageXOffset||0,y:a.pageYOffset||0};var b=a.document;return{x:b.documentElement.scrollLeft||b.body.scrollLeft||0,y:b.documentElement.scrollTop||b.body.scrollTop||0}},f=d().height,g=f*-1+c;g+=a.offsetHeight||0;var h=domUtils.getXY(a);g+=h.y;var i=e(b).y;(g>i||g<i-f)&&b.scrollTo(0,g+(g<0?-20:20))},isBr:function(a){return a.nodeType==1&&a.tagName=="BR"},isFillChar:function(a){return a.nodeType==3&&!a.nodeValue.replace(new RegExp(domUtils.fillChar),"").length},isStartInblock:function(a){var b=a.cloneRange(),c=0,d=b.startContainer,e;while(d&&domUtils.isFillChar(d))e=d,d=d.previousSibling;e&&(b.setStartBefore(e),d=b.startContainer),d.nodeType==1&&domUtils.isEmptyNode(d)&&b.startOffset==1&&b.setStart(d,0).collapse(!0);while(!b.startOffset){d=b.startContainer;if(domUtils.isBlockElm(d)||domUtils.isBody(d)){c=1;break}var f=b.startContainer.previousSibling,g;if(!f)b.setStartBefore(b.startContainer);else{while(f&&domUtils.isFillChar(f))g=f,f=f.previousSibling;g?b.setStartBefore(g):b.setStartBefore(b.startContainer)}}return c&&!domUtils.isBody(b.startContainer)?1:0},isEmptyBlock:function(a){var b=new RegExp("[ 	\r\n"+domUtils.fillChar+"]","g");if(a[browser.ie?"innerText":"textContent"].replace(b,"").length>0)return 0;for(var c in dtd.$isNotEmpty)if(a.getElementsByTagName(c).length)return 0;return 1},setViewportOffset:function(a,b){var c=parseInt(a.style.left)|0,d=parseInt(a.style.top)|0,e=a.getBoundingClientRect(),f=b.left-e.left,g=b.top-e.top;f&&(a.style.left=c+f+"px"),g&&(a.style.top=d+g+"px")},fillNode:function(a,b){var c=browser.ie?a.createTextNode(domUtils.fillChar):a.createElement("br");b.innerHTML="",b.appendChild(c)},moveChild:function(a,b,c){while(a.firstChild)c&&b.firstChild?b.insertBefore(a.lastChild,b.firstChild):b.appendChild(a.firstChild)},hasNoAttributes:function(a){return browser.ie?/^<\w+\s*?>/.test(a.outerHTML):a.attributes.length==0}},fillCharReg=new RegExp(domUtils.fillChar,"g");(function(){function d(a){a.collapsed=a.startContainer&&a.endContainer&&a.startContainer===a.endContainer&&a.startOffset==a.endOffset}function e(a,b,c,e){return b.nodeType==1&&(dtd.$empty[b.tagName]||dtd.$nonChild[b.tagName])&&(c=domUtils.getNodeIndex(b)+(a?0:1),b=b.parentNode),a?(e.startContainer=b,e.startOffset=c,e.endContainer||e.collapse(!0)):(e.endContainer=b,e.endOffset=c,e.startContainer||e.collapse(!1)),d(e),e}function f(a,b){var c=a.startContainer,d=a.endContainer,e=a.startOffset,f=a.endOffset,g=a.document,h=g.createDocumentFragment(),i,j;c.nodeType==1&&(c=c.childNodes[e]||(i=c.appendChild(g.createTextNode("")))),d.nodeType==1&&(d=d.childNodes[f]||(j=d.appendChild(g.createTextNode(""))));if(c===d&&c.nodeType==3)return h.appendChild(g.createTextNode(c.substringData(e,f-e))),b&&(c.deleteData(e,f-e),a.collapse(!0)),h;var k,l,m=h,n=domUtils.findParents(c,!0),o=domUtils.findParents(d,!0);for(var p=0;n[p]==o[p];p++);for(var q=p,r;r=n[q];q++){k=r.nextSibling,r==c?i||(a.startContainer.nodeType==3?(m.appendChild(g.createTextNode(c.nodeValue.slice(e))),b&&c.deleteData(e,c.nodeValue.length-e)):m.appendChild(b?c:c.cloneNode(!0))):(l=r.cloneNode(!1),m.appendChild(l));while(k){if(k===d||k===o[q])break;r=k.nextSibling,m.appendChild(b?k:k.cloneNode(!0)),k=r}m=l}m=h,n[p]||(m.appendChild(n[p-1].cloneNode(!1)),m=m.firstChild);for(var q=p,s;s=o[q];q++){k=s.previousSibling,s==d?!j&&a.endContainer.nodeType==3&&(m.appendChild(g.createTextNode(d.substringData(0,f))),b&&d.deleteData(0,f)):(l=s.cloneNode(!1),m.appendChild(l));if(q!=p||!n[p])while(k){if(k===c)break;s=k.previousSibling,m.insertBefore(b?k:k.cloneNode(!0),m.firstChild),k=s}m=l}return b&&a.setStartBefore(o[p]?n[p]?o[p]:n[p-1]:o[p-1]).collapse(!0),i&&domUtils.remove(i),j&&domUtils.remove(j),h}function h(a,b){try{if(c&&domUtils.inDoc(c,a))if(!c.nodeValue.replace(fillCharReg,"").length){var d=c.parentNode;domUtils.remove(c);while(d&&domUtils.isEmptyInlineElement(d)&&!d.contains(b))c=d.parentNode,domUtils.remove(d),d=c}else c.nodeValue=c.nodeValue.replace(fillCharReg,"")}catch(e){}}function i(a,b){var c;a=a[b];while(a&&domUtils.isFillChar(a))c=a[b],domUtils.remove(a),a=c}var a=0,b=domUtils.fillChar,c,g=dom.Range=function(a){var b=this;b.startContainer=b.startOffset=b.endContainer=b.
endOffset=null,b.document=a,b.collapsed=!0};g.prototype={cloneContents:function(){return this.collapsed?null:f(this,0)},deleteContents:function(){this.collapsed||f(this,1);if(browser.webkit){var a=this.startContainer;a.nodeType==3&&!a.nodeValue.length&&(this.setStartBefore(a).collapse(!0),domUtils.remove(a))}return this},extractContents:function(){return this.collapsed?null:f(this,2)},setStart:function(a,b){return e(!0,a,b,this)},setEnd:function(a,b){return e(!1,a,b,this)},setStartAfter:function(a){return this.setStart(a.parentNode,domUtils.getNodeIndex(a)+1)},setStartBefore:function(a){return this.setStart(a.parentNode,domUtils.getNodeIndex(a))},setEndAfter:function(a){return this.setEnd(a.parentNode,domUtils.getNodeIndex(a)+1)},setEndBefore:function(a){return this.setEnd(a.parentNode,domUtils.getNodeIndex(a))},selectNode:function(a){return this.setStartBefore(a).setEndAfter(a)},selectNodeContents:function(a){return this.setStart(a,0).setEnd(a,a.nodeType==3?a.nodeValue.length:a.childNodes.length)},cloneRange:function(){var a=this,b=new g(a.document);return b.setStart(a.startContainer,a.startOffset).setEnd(a.endContainer,a.endOffset)},collapse:function(a){var b=this;return a?(b.endContainer=b.startContainer,b.endOffset=b.startOffset):(b.startContainer=b.endContainer,b.startOffset=b.endOffset),b.collapsed=!0,b},shrinkBoundary:function(a){var b=this,c,d=b.collapsed;while(b.startContainer.nodeType==1&&(c=b.startContainer.childNodes[b.startOffset])&&c.nodeType==1&&!domUtils.isBookmarkNode(c)&&!dtd.$empty[c.tagName]&&!dtd.$nonChild[c.tagName])b.setStart(c,0);if(d)return b.collapse(!0);if(!a)while(b.endContainer.nodeType==1&&b.endOffset>0&&(c=b.endContainer.childNodes[b.endOffset-1])&&c.nodeType==1&&!domUtils.isBookmarkNode(c)&&!dtd.$empty[c.tagName]&&!dtd.$nonChild[c.tagName])b.setEnd(c,c.childNodes.length);return b},getCommonAncestor:function(a,b){var c=this.startContainer,d=this.endContainer;return c===d?a&&c.nodeType==1&&this.startOffset==this.endOffset-1?c.childNodes[this.startOffset]:b&&c.nodeType==3?c.parentNode:c:domUtils.getCommonAncestor(c,d)},trimBoundary:function(a){this.txtToElmBoundary();var b=this.startContainer,c=this.startOffset,d=this.collapsed,e=this.endContainer;if(b.nodeType==3){if(c==0)this.setStartBefore(b);else if(c>=b.nodeValue.length)this.setStartAfter(b);else{var f=domUtils.split(b,c);b===e?this.setEnd(f,this.endOffset-c):b.parentNode===e&&(this.endOffset+=1),this.setStartBefore(f)}if(d)return this.collapse(!0)}return a||(c=this.endOffset,e=this.endContainer,e.nodeType==3&&(c==0?this.setEndBefore(e):c>=e.nodeValue.length?this.setEndAfter(e):(domUtils.split(e,c),this.setEndAfter(e)))),this},txtToElmBoundary:function(){function a(a,b){var c=a[b+"Container"],d=a[b+"Offset"];c.nodeType==3&&(d?d>=c.nodeValue.length&&a["set"+b.replace(/(\w)/,function(a){return a.toUpperCase()})+"After"](c):a["set"+b.replace(/(\w)/,function(a){return a.toUpperCase()})+"Before"](c))}return this.collapsed||(a(this,"start"),a(this,"end")),this},insertNode:function(a){var b=a,c=1;a.nodeType==11&&(b=a.firstChild,c=a.childNodes.length),this.trimBoundary(!0);var d=this.startContainer,e=this.startOffset,f=d.childNodes[e];return f?d.insertBefore(a,f):d.appendChild(a),b.parentNode===this.endContainer&&(this.endOffset=this.endOffset+c),this.setStartBefore(b)},setCursor:function(a,b){return this.collapse(a?!1:!0).select(b)},createBookmark:function(b,c){var d,e=this.document.createElement("span");return e.style.cssText="display:none;line-height:0px;",e.appendChild(this.document.createTextNode("\ufeff")),e.id="_baidu_bookmark_start_"+(c?"":a++),this.collapsed||(d=e.cloneNode(!0),d.id="_baidu_bookmark_end_"+(c?"":a++)),this.insertNode(e),d&&(this.collapse(!1).insertNode(d),this.setEndBefore(d)),this.setStartAfter(e),{start:b?e.id:e,end:d?b?d.id:d:null,id:b}},moveToBookmark:function(a){var b=a.id?this.document.getElementById(a.start):a.start,c=a.end&&a.id?this.document.getElementById(a.end):a.end;return this.setStartBefore(b),domUtils.remove(b),c?(this.setEndBefore(c),domUtils.remove(c)):this.collapse(!0),this},enlarge:function(a,b){var c=domUtils.isBody,d,e,f=this.document.createTextNode("");if(a){e=this.startContainer,e.nodeType==1?e.childNodes[this.startOffset]?d=e=e.childNodes[this.startOffset]:(e.appendChild(f),d=e=f):d=e;for(;;){if(domUtils.isBlockElm(e)){e=d;while((d=e.previousSibling)&&!domUtils.isBlockElm(d))e=d;this.setStartBefore(e);break}d=e,e=e.parentNode}e=this.endContainer,e.nodeType==1?((d=e.childNodes[this.endOffset])?e.insertBefore(f,d):e.appendChild(f),d=e=f):d=e;for(;;){if(domUtils.isBlockElm(e)){e=d;while((d=e.nextSibling)&&!domUtils.isBlockElm(d))e=d;this.setEndAfter(e);break}d=e,e=e.parentNode}f.parentNode===this.endContainer&&this.endOffset--,domUtils.remove(f)}if(!this.collapsed){while(this.startOffset==0){if(b&&b(this.startContainer))break;if(c(this.startContainer))break;this.setStartBefore(this.startContainer)}while(this.endOffset==(this.endContainer.nodeType==1?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)){if(b&&b(this.endContainer))break;if(c(this.endContainer))break;this.setEndAfter(this.endContainer)}}return this},adjustmentBoundary:function(){if(!this.collapsed){while(!domUtils.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length)this.setStartAfter(this.startContainer);while(!domUtils.isBody(this.endContainer)&&!this.endOffset)this.setEndBefore(this.endContainer)}return this},applyInlineStyle:function(a,b,c){if(this.collapsed)return this;this.trimBoundary().enlarge(!1,function(a){return a.nodeType==1&&domUtils.isBlockElm(a)}).adjustmentBoundary();var d=this.createBookmark(),e=d.end,f=function(a){return a.nodeType==1?a.tagName.toLowerCase()!="br":!domUtils.isWhitespace(a)},g=domUtils.getNextDomNode(d.start,!1,f),h,i,j=this.cloneRange();while(g&&domUtils.getPosition(g,e)&domUtils.POSITION_PRECEDING)if(g.nodeType==3||dtd[a][g.tagName]){j.setStartBefore(g),h=g;while(h&&(h.nodeType==3||dtd[a][h.tagName])&&h!==e)i=h,h=domUtils.getNextDomNode(h,h.nodeType==1,null,function(b){return dtd[a][b.tagName]});var k=j.setEndAfter(i).extractContents(),l;if(c&&c.length>0){var m,n;n=m=c[0].cloneNode(!1);for(var o=1,p;p=c[o++];)m.appendChild(p.cloneNode(!1)),m=m.firstChild;l=m}else l=j.document.createElement(a);b&&domUtils.setAttributes(l,b),l.appendChild(k),j.insertNode(c?n:l);var q;a=="span"&&b.style&&/text\-decoration/.test(b.style)&&(q=domUtils.findParentByTagName(l,"a",!0))?(domUtils.setAttributes(q,b),domUtils.remove(l,!0),l=q):(domUtils.mergSibling(l),domUtils.clearEmptySibling(l)),domUtils.mergChild(l,a,b),g=domUtils.getNextDomNode(l,!1,f),domUtils.mergToParent(l);if(h===e)break}else g=domUtils.getNextDomNode(g,!0,f);return this.moveToBookmark(d)},removeInlineStyle:function(a){if(this.collapsed)return this;a=utils.isArray(a)?a:[a],this.shrinkBoundary().adjustmentBoundary();var b=this.startContainer,c=this.endContainer;for(;;){if(b.nodeType==1){if(utils.indexOf(a,b.tagName.toLowerCase())>-1)break;if(b.tagName.toLowerCase()=="body"){b=null;break}}b=b.parentNode}for(;;){if(c.nodeType==1){if(utils.indexOf(a,c.tagName.toLowerCase())>-1)break;if(c.tagName.toLowerCase()=="body"){c=null;break}}c=c.parentNode}var d=this.createBookmark(),e,f;b&&(f=this.cloneRange().setEndBefore(d.start).setStartBefore(b),e=f.extractContents(),f.insertNode(e),domUtils.clearEmptySibling(b,!0),b.parentNode.insertBefore(d.start,b)),c&&(f=this.cloneRange().setStartAfter(d.end).setEndAfter(c),e=f.extractContents(),f.insertNode(e),domUtils.clearEmptySibling(c,!1,!0),c.parentNode.insertBefore(d.end,c.nextSibling));var g=domUtils.getNextDomNode(d.start,!1,function(a){return a.nodeType==1}),h;while(g&&g!==d.end)h=domUtils.getNextDomNode(g,!0,function(a){return a.nodeType==1}),utils.indexOf(a,g.tagName.toLowerCase())>-1&&domUtils.remove(g,!0),g=h;return this.moveToBookmark(d)},getClosedNode:function(){var a;if(!this.collapsed){var b=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(b.startContainer.nodeType==1&&b.startContainer===b.endContainer&&b.endOffset-b.startOffset==1){var c=b.startContainer.childNodes[b.startOffset];c&&c.nodeType==1&&(dtd.$empty[c.tagName]||dtd.$nonChild[c.tagName])&&(a=c)}}return a},select:browser.ie?function(a,d){var e;this.collapsed||this.shrinkBoundary();var f=this.getClosedNode();if(f&&!d){try{e=this.document.body.createControlRange(),e.addElement(f),e.select()}catch(g){}return this}var j=this.createBookmark(),k=j.start,l;e=this.document.body.createTextRange(),e.moveToElementText(k),e.moveStart("character",1);if(!this.collapsed){var m=this.document.body.createTextRange();l=j.end,m.moveToElementText(l),e.setEndPoint("EndToEnd",m)}else if(!a&&this.startContainer.nodeType!=3){var n=this.document.createTextNode(b),o=this.document.createElement("span");o.appendChild(this.document.createTextNode(b)),k.parentNode.insertBefore(o,k),k.parentNode.insertBefore(n,k),h(this.document,n),c=n,i(o,"previousSibling"),i(k,"nextSibling"),e.moveStart("character",-1),e.collapse(!0)}return this.moveToBookmark(j),o&&domUtils.remove(o),e.select(),this}:function(a){var d=domUtils.getWindow(this.document),e=d.getSelection(),f;browser.gecko?this.document.body.focus():d.focus();if(e){e.removeAllRanges(),this.collapsed&&!a&&(f=this.document.createTextNode(b),this.insertNode(f),h(this.document,f),i(f,"previousSibling"),i(f,"nextSibling"),c=f,this.setStart(f,browser.webkit?1:0).collapse(!0));var g=this.document.createRange();g.setStart(this.startContainer,this.startOffset),g.setEnd(this.endContainer,this.endOffset),e.addRange(g)}return this},scrollToView:function(a,b){a=a?window:domUtils.getWindow(this.document);var c=this.document.createElement("span");c.innerHTML="&nbsp;";var d=this.cloneRange();return d.insertNode(c),domUtils.scrollToView(c,a,b),domUtils.remove(c),this}}})(),function(){function a(a,b){var c=domUtils.getNodeIndex;a=a.duplicate(),a.collapse(b);var d=a.parentElement();if(!d.hasChildNodes())return{container:d,offset:0};var e=d.children,f,g=a.duplicate(),h=0,i=e.length-1,j=-1,k;while(h<=i){j=Math.floor((h+i)/2),f=e[j],g.moveToElementText(f);var l=g.compareEndPoints("StartToStart",a);if(l>0)i=j-1;else{if(!(l<0))return{container:d,offset:c(f)};h=j+1}}if(j==-1){g.moveToElementText(d),g.setEndPoint("StartToStart",a),k=g.text.replace(/(\r\n|\r)/g,"\n").length,e=d.childNodes;if(!k)return f=e[e.length-1],{container:f,offset:f.nodeValue.length};var m=e.length;while(k>0)k-=e[--m].nodeValue.length;return{container:e[m],offset:-k}}g.collapse(l>0),g.setEndPoint(l>0?"StartToStart":"EndToStart",a),k=g.text.replace(/(\r\n|\r)/g,"\n").length;if(!k)return dtd.$empty[f.tagName]||dtd.$nonChild[f.tagName]?{container:d,offset:c(f)+(l>0?0:1)}:{container:f,offset:l>0?0:f.childNodes.length};while(k>0)try{var n=f;f=f[l>0?"previousSibling":"nextSibling"],k-=f.nodeValue.length}catch(o){return{container:d,offset:c(n)}}return{container:f,offset:l>0?-k:f.nodeValue.length+k}}function b(b,c){if(b.item)c.selectNode(b.item(0));else{var d=a(b,!0);c.setStart(d.container,d.offset),b.compareEndPoints("StartToEnd",b)!=0&&(d=a(b,!1),c.setEnd(d.container,d.offset))}return c}function c(a){var b;try{b=a.getNative().createRange()}catch(c){return null}var d=b.item?b.item(0):b.parentElement();return(d.ownerDocument||d)===a.document?b:null}var d=dom.Selection=function(a){var b=this,d;b.document=a,ie&&(d=domUtils.getWindow(a).frameElement,domUtils.on(d,"beforedeactivate",function(){b._bakIERange=b.getIERange()}),domUtils.on(d,"activate",function(){try{!c(b)&&b._bakIERange&&b._bakIERange.select()}catch(a){}b._bakIERange=null})),d=a=null};d.prototype={getNative:function(){var a=this.document;return a?ie?a.selection:domUtils.getWindow(a).getSelection():null},getIERange:function(){var a=c(this);return!a&&this._bakIERange?this._bakIERange:a},cache:function(){this.clear(),this._cachedRange=this.getRange(),this._cachedStartElement=this.getStart(),this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var a=this.getStart();return a?domUtils.findParents(a,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){return browser.ie&&c(this)||!browser.ie&&this.getNative().rangeCount?!0:!1},getRange:function(){function c(b){var c=a.document.body.firstChild,d=b.collapsed;while(c&&c.firstChild)b.setStart(c,0),c=c.firstChild;b.startContainer||b.setStart(a.document.body,0),d&&b.collapse(!0)}var a=this;if(a._cachedRange!=null)return this._cachedRange;var d=new baidu.editor.dom.Range(a.document);if(ie){var e=a.getIERange();e?b(e,d):c(d)}else{var f=a.getNative();if(f&&f.rangeCount){var g=f.getRangeAt(0),h=f.getRangeAt(f.rangeCount-1);d.setStart(g.startContainer,g.startOffset).setEnd(h.endContainer,h.endOffset),d.collapsed&&domUtils.isBody(d.startContainer)&&!d.startOffset&&c(d)}else{if(this._bakRange&&domUtils.inDoc(this._bakRange.startContainer,this.document))return this._bakRange;c(d)}}return this._bakRange=d},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var a=ie?this.getIERange():this.getRange(),b,c,d,e;if(ie){if(!a)return this.document.body.firstChild;if(a.item)return a.item(0);b=a.duplicate(),b.text.length>0&&b.moveStart("character",1),b.collapse(1),c=b.parentElement(),e=d=a.parentElement();while(d=d.parentNode)if(d==c){c=e;break}}else{a.shrinkBoundary(),c=a.startContainer,c.nodeType==1&&c.hasChildNodes()&&(c=c.childNodes[Math.min(c.childNodes.length-1,a.startOffset)]);if(c.nodeType==3)return c.parentNode}return c},getText:function(){if(this.isFocus()){var a=this.getNative(),b=browser.ie?a.createRange():a.getRangeAt(0);return b.text||b.toString()}return""}}}(),function(){function c(a){var b=a.getElementsByTagName("img"),c;for(var d=0,e;e=b[d++];)if(c=e.getAttribute("orgSrc"))e.src=c,e.removeAttribute("orgSrc");var f=a.getElementsByTagName("a");for(var d=0,g;g=f[d++];d++)g.getAttribute("data_ue_src")&&g.setAttribute("href",g.getAttribute("data_ue_src"))}var a=0,b,d=UE.Editor=function(b){var c=this;c.uid=a++,EventBase.call(c),c.commands={},c.options=utils.extend(b||{},UEDITOR_CONFIG,!0);for(var d in UE.plugins)UE.plugins[d].call(c)};d.prototype={destroy:function(){this.fireEvent("destroy"),this.container.innerHTML="",domUtils.remove(this.container)},render:function(a){a.constructor===String&&(a=document.getElementById(a)),a&&(a.innerHTML='<iframe id="baidu_editor_'+this.uid+'"'+'width="100%" height="100%"  frameborder="0"></iframe>',a.style.overflow="hidden",this._setup(a.firstChild.contentWindow.document))},_setup:function(a){var b=this.options,c=this;!browser.webkit&&a.open();var d=ie&&browser.version<9;a.write((ie&&browser.version<9?"":"<!DOCTYPE html>")+'<html xmlns="http://www.w3.org/1999/xhtml"'+(d?"":' class="view"')+"><head>"+(b.iframeCssUrl?'<link rel="stylesheet" type="text/css" href="'+utils.unhtml(/^http/.test(b.iframeCssUrl)?b.iframeCssUrl:b.UEDITOR_HOME_URL+b.iframeCssUrl)+'"/>':"")+'<style type="text/css">'+(b.initialStyle||" ")+"</style></head><body"+(d?' class="view"':"")+"></body></html>"),!browser.webkit&&a.close(),ie?(a.body.disabled=!0,a.body.contentEditable=!0,a.body.disabled=!1):(a.body.contentEditable=!0,a.body.spellcheck=!1),this.document=a,this.window=a.defaultView||a.parentWindow,this.iframe=this.window.frameElement,this.body=a.body,this.options.minFrameHeight&&(this.setHeight(this.options.minFrameHeight),this.body.style.height=this.options.minFrameHeight),this.selection=new dom.Selection(a),browser.gecko&&this.selection.getNative().removeAllRanges(),this._initEvents();if(c.options.initialContent)if(c.options.autoClearinitialContent){var e=c.execCommand;c.execCommand=function(){c.fireEvent("firstBeforeExecCommand"),e.apply(c,arguments)},this.setDefaultContent(this.options.initialContent)}else this.setContent(this.options.initialContent,!0);for(var f=this.iframe.parentNode;!domUtils.isBody(f);f=f.parentNode)if(f.tagName=="FORM"){domUtils.on(f,"submit",function(){var a=document.getElementById("ueditor_textarea_"+c.options.textarea);a||(a=document.createElement("textarea"),a.setAttribute("name",c.options.textarea),a.id="ueditor_textarea_"+c.options.textarea,a.style.display="none",this.appendChild(a)),a.value=c.getContent()});break}domUtils.isEmptyNode(c.body)&&(this.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>"),c.options.focus&&setTimeout(function(){c.focus(),!c.options.autoClearinitialContent&&c._selectionChange()}),this.container||(this.container=this.iframe.parentNode),c.options.fullscreen&&c.ui&&c.ui.setFullScreen(!0),this.fireEvent("ready"),browser.ie||domUtils.on(c.window,"blur",function(){c._bakRange=c.selection.getRange(),c.selection.getNative().removeAllRanges()}),browser.gecko&&browser.version<=10902&&(c.body.contentEditable=!1,setTimeout(function(){c.body.contentEditable=!0},100),setInterval(function(){c.body.style.height=c.iframe.offsetHeight-20+"px"},100))},sync:function(a){function d(a){var c=document.getElementById("ueditor_textarea_"+b.options.textarea);c||(c=document.createElement("textarea"),c.setAttribute("name",b.options.textarea),c.id="ueditor_textarea_"+b.options.textarea,c.style.display="none",a.appendChild(c)),c.value=b.getContent()}var b=this,c;if(a)c=document.getElementById(a),c&&d(c);else for(c=b.iframe.parentNode;!domUtils.isBody(c);c=c.parentNode)if(c.tagName=="FORM"){d(c);break}},setHeight:function(a){a!==parseInt(this.iframe.parentNode.style.height)&&(this.iframe.parentNode.style.height=a+"px"),browser.ie&&browser.version==9&&(this.document.body.style.height=a-20+"px")},getContent:function(a){this.fireEvent("beforegetcontent",a);var b=new RegExp(domUtils.fillChar,"g"),c=this.document.body.innerHTML.replace(b,"").replace(/>[\t\r\n]*?</g,"><");this.fireEvent("aftergetcontent",a);if(this.serialize){var d=this.serialize.parseHTML(c);d=this.serialize.transformOutput(d),c=this.serialize.toHTML(d)}return c},getContentTxt:function(){var a=new RegExp(domUtils.fillChar,"g");return this.body[browser.ie?"innerText":"textContent"].replace(a,"")},setContent:function(a,b){var d=this,e=utils.extend({a:1,A:1},dtd.$inline,!0),f;a=a.replace(/^[ \t\r\n]*?</,"<").replace(/>[ \t\r\n]*?$/,">").replace(/>[\t\r\n]*?</g,"><").replace(/[\s\/]?(\w+)?>[ \t\r\n]*?<\/?(\w+)/gi,function(a,b,c){return b?f=c:b=f,!e[b]&&!e[c]?a.replace(/>[ \t\r\n]*?</,"><"):a}),d.fireEvent("beforesetcontent");var g=this.serialize;if(g){var h=g.parseHTML(a);h=g.transformInput(h),h=g.filter(h),a=g.toHTML(h)}this.document.body.innerHTML=a.replace(new RegExp("[\r"+domUtils.fillChar+"]*","g"),""),browser.ie&&browser.version<7&&d.options.relativePath&&c(this.document.body);if(d.options.enterTag=="p"){var i=this.body.firstChild,j=d.document.createElement("p"),k;if(!i||i.nodeType==1&&dtd.$cdata[i.tagName])this.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>"+this.body.innerHTML;else while(i)i.nodeType==3||i.nodeType==1&&dtd.p[i.tagName]?(k=i.nextSibling,j.appendChild(i),i=k,i||d.body.appendChild(j)):(j.firstChild&&(d.body.insertBefore(j,i),j=d.document.createElement("p")),i=i.nextSibling)}d.adjustTable&&d.adjustTable(d.body),d.fireEvent("aftersetcontent"),d.fireEvent("contentchange"),!b&&d._selectionChange(),d._bakRange=d._bakIERange=null,browser.gecko&&d.selection.getNative().removeAllRanges()},focus:function(){this.selection.getRange().select(!0)},_initEvents:function(){var a=this,b=a.document,c=a.window;a._proxyDomEvent=utils.bind(a._proxyDomEvent,a),domUtils.on(b,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],a._proxyDomEvent),domUtils.on(c,["focus","blur"],a._proxyDomEvent),domUtils.on(b,["mouseup","keydown"],function(b){if(b.type=="keydown"&&(b.ctrlKey||b.metaKey||b.shiftKey||b.altKey))return;if(b.button==2)return;a._selectionChange(250,b)});var d=0,e=browser.ie?a.body:a.document,f;domUtils.on(e,"dragstart",function(){d=1}),domUtils.on(e,browser.webkit?"dragover":"drop",function(){return browser.webkit?function(){clearTimeout(f),f=setTimeout(function(){if(!d){var b=a.selection,c=b.getRange();if(c){var e=c.getCommonAncestor();if(e&&a.serialize){var f=a.serialize,g=f.filter(f.transformInput(f.parseHTML(f.word(e.innerHTML))));e.innerHTML=f.toHTML(g)}}}d=0},200)}:function(a){d||(a.preventDefault?a.preventDefault():a.returnValue=!1),d=0}}())},_proxyDomEvent:function(a){return this.fireEvent(a.type.replace(/^on/,""),a)},_selectionChange:function(a,c){var d=this;if(!d.selection.isFocus())return;var e=!1,f,g;if(browser.ie&&browser.version<9&&c&&c.type=="mouseup"){var h=this.selection.getRange();h.collapsed||(e=!0,f=c.clientX,g=c.clientY)}clearTimeout(b),b=setTimeout(function(){if(!d.selection.getNative())return;var a;if(e&&d.selection.getNative().type=="None"){a=d.document.body.createTextRange();try{a.moveToPoint(f,g)}catch(b){a=null}}var h;a&&(h=d.selection.getIERange,d.selection.getIERange=function(){return a}),d.selection.cache(),h&&(d.selection.getIERange=h),d.selection._cachedRange&&d.selection._cachedStartElement&&(d.fireEvent("beforeselectionchange"),d.fireEvent("selectionchange",!!c),d.fireEvent("afterselectionchange"),d.selection.clear())},a||50)},_callCmdFn:function(a,b){var c=b[0].toLowerCase(),d,e;e=(d=this.commands[c])&&d[a]||(d=UE.commands[c])&&d[a];if(d&&!e&&a=="queryCommandState")return!1;if(e)return e.apply(this,b)},execCommand:function(a){a=a.toLowerCase();var b=this,c,d=b.commands[a]||UE.commands[a];if(!d||!d.execCommand)return;return!d.notNeedUndo&&!b.__hasEnterExecCommand?(b.__hasEnterExecCommand=!0,b.queryCommandState(a)!=-1&&(b.fireEvent("beforeexeccommand",a),c=this._callCmdFn("execCommand",arguments),b.fireEvent("afterexeccommand",a)),b.__hasEnterExecCommand=!1):c=this._callCmdFn("execCommand",arguments),b._selectionChange(),c},queryCommandState:function(a){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(a){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(a){if(a)for(var b=0,c;c=a[b++];)if(this.document.getElementsByTagName(c).length>0)return!0;return domUtils.isEmptyBlock(this.body)?!1:!0},reset:function(){this.fireEvent("reset")},setDefaultContent:function(){function a(){var b=this;if(b.document.getElementById("initContent")){b.document.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>";var c=b.selection.getRange();b.removeListener("firstBeforeExecCommand",a),b.removeListener("focus",a),setTimeout(function(){c.setStart(b.document.body.firstChild,0).collapse(!0).select(!0),b._selectionChange()})}}return function(b){var d=this;d.document.body.innerHTML='<p id="initContent">'+b+"</p>",browser.ie&&browser.version<7&&d.options.relativePath&&c(d.document.body),d.addListener("firstBeforeExecCommand",a),d.addListener("focus",a)}}()},utils.inherits(d,EventBase)}(),UE.ajax=function(){function a(a){var b=[];for(var c in a){if(c=="method"||c=="timeout"||c=="async")continue;(typeof a[c]).toLowerCase()!="function"&&(typeof a[c]).toLowerCase()!="object"&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]))}return b.join("&")}function b(){var a=null;if(window.XMLHttpRequest)a=new XMLHttpRequest;else try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}return a}return{request:function(c,d){var e=b(),f=!1,g={method:"POST",timeout:5e3,async:!0,data:{},onsuccess:function(){},onerror:function(){}};typeof c=="object"&&(d=c,c=d.url);if(!e||!c)return;var h=d?utils.extend(g,d):g,i=a(h);utils.isEmptyObject(h.data)||(i+=(i?"&":"")+a(h.data));var j=setTimeout(function(){e.readyState!=4&&(f=!0,e.abort(),clearTimeout(j))},h.timeout),k=h.method.toUpperCase(),l=c+(c.indexOf("?")==-1?"?":"&")+(k=="POST"?"":i)+"&noCache="+ +(new Date);e.open(k,l,h.async),e.onreadystatechange=function(){e.readyState==4&&(!f&&e.status==200?h.onsuccess(e):h.onerror(e))},k=="POST"?(e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send(i)):e.send(null)}}}(),UE.commands.inserthtml={execCommand:function(a,b){var c=this,d,e,f,g,h,i=c.currentSelectedArr;d=c.selection.getRange(),h=d.document.createElement("div"),h.style.display="inline",h.innerHTML=utils.trim(b);try{c.adjustTable&&c.adjustTable(h)}catch(j){}if(i&&i.length){for(var f=0,k;k=i[f++];)k.className="";i[0].innerHTML="",d.setStart(i[0],0).collapse(!0),c.currentSelectedArr=[]}if(!d.collapsed){d.deleteContents();if(d.startContainer.nodeType==1){var l=d.startContainer.childNodes[d.startOffset],m;if(l&&domUtils.isBlockElm(l)&&(m=l.previousSibling)&&domUtils.isBlockElm(m)){d.setEnd(m,m.childNodes.length).collapse();while(l.firstChild)m.appendChild(l.firstChild);domUtils.remove(l)}}}var l,n,m,o,p=0;while(l=h.firstChild){d.insertNode(l);if(!p&&l.nodeType==domUtils.NODE_ELEMENT&&domUtils.isBlockElm(l)){n=domUtils.findParent(l,function(a){return domUtils.isBlockElm(a)});if(n&&n.tagName.toLowerCase()!="body"&&(!dtd[n.tagName][l.nodeName]||l.parentNode!==n)){if(!dtd[n.tagName][l.nodeName])m=n;else{o=l.parentNode;while(o!==n)m=o,o=o.parentNode}domUtils.breakParent(l,m||o);var m=l.previousSibling;domUtils.trimWhiteTextNode(m),m.childNodes.length||domUtils.remove(m),p=1}}var q=l.nextSibling;if(!h.firstChild&&q&&domUtils.isBlockElm(q)){d.setStart(q,0).collapse(!0);break}d.setEndAfter(l).collapse()}l=d.startContainer,domUtils.isBlockElm(l)&&domUtils.isEmptyNode(l)&&(l.innerHTML=browser.ie?"":"<br/>"),d.select(!0),setTimeout(function(){d=c.selection.getRange(),d.scrollToView(c.autoHeightEnabled,c.autoHeightEnabled?domUtils.getXY(c.iframe).y:0)},200)}},UE.plugins.autotypeset=function(){function g(a,b){if(a&&a.parentNode&&e[a.tagName.toLowerCase()])return f&&f.contains(a)||a.getAttribute("pagebreak")?0:b?!domUtils.isEmptyBlock(a):domUtils.isEmptyBlock(a)}function h(a){a.style.cssText||(domUtils.removeAttributes(a,["style"]),a.tagName.toLowerCase()=="span"&&domUtils.hasNoAttributes(a)&&domUtils.remove(a,!0))}function i(e,i){var j;if(i){if(!b.pasteFilter)return;j=a.document.createElement("div"),j.innerHTML=i.html}else j=a.document.body;var k=domUtils.getElementsByTagName(j,"*");for(var l=0,m;m=k[l++];){!f&&m.tagName=="DIV"&&m.getAttribute("highlighter")&&(f=m),b.clearFontSize&&m.style.fontSize&&(m.style.fontSize="",h(m)),b.clearFontFamily&&m.style.fontFamily&&(m.style.fontFamily="",h(m));if(g(m)){if(b.mergeEmptyline){var n=m.nextSibling,o;while(g(n))o=n,n=o.nextSibling,domUtils.remove(o)}if(b.removeEmptyline&&domUtils.inDoc(m,j)&&!d[m.parentNode.tagName.toLowerCase()]){domUtils.remove(m);continue}}g(m,!0)&&(b.indent&&(m.style.textIndent=b.indentValue),b.textAlign&&(m.style.textAlign=b.textAlign));if(b.removeClass&&m.className&&!c[m.className.toLowerCase()]){if(f&&f.contains(m))continue;domUtils.removeAttributes(m,["class"])}if(b.imageBlockLine&&m.tagName.toLowerCase()=="img"&&!m.getAttribute("emotion"))if(i){var p=m;switch(b.imageBlockLine){case"left":case"right":case"none":var q=p.parentNode,o,r,n;while(dtd.$inline[q.tagName]||q.tagName=="A")q=q.parentNode;o=q;if(o.tagName=="P"&&domUtils.getStyle(o,"text-align")=="center"&&!domUtils.isBody(o)&&domUtils.getChildCount(o,function(a){return!domUtils.isBr(a)&&!domUtils.isWhitespace(a)})==1){r=o.previousSibling,n=o.nextSibling;if(r&&n&&r.nodeType==1&&n.nodeType==1&&r.tagName==n.tagName&&domUtils.isBlockElm(r)){r.appendChild(o.firstChild);while(n.firstChild)r.appendChild(n.firstChild);domUtils.remove(o),domUtils.remove(n)}else domUtils.setStyle(o,"text-align","")}domUtils.setStyle(p,"float",b.imageBlockLine);break;case"center":if(a.queryCommandValue("imagefloat")!="center"){q=p.parentNode,domUtils.setStyle(p,"float","none"),o=p;while(q&&domUtils.getChildCount(q,function(a){return!domUtils.isBr(a)&&!domUtils.isWhitespace(a)})==1&&(dtd.$inline[q.tagName]||q.tagName=="A"))o=q,q=q.parentNode;var s=a.document.createElement("p");domUtils.setAttributes(s,{style:"text-align:center"}),o.parentNode.insertBefore(s,o),s.appendChild(o),domUtils.setStyle(o,"float","")}}}else{var t=a.selection.getRange();t.selectNode(m).select(),a.execCommand("imagefloat",b.imageBlockLine)}b.removeEmptyNode&&b.removeTagNames[m.tagName.toLowerCase()]&&domUtils.hasNoAttributes(m)&&domUtils.isEmptyBlock(m)&&domUtils.remove(m)}i&&(i.html=j.innerHTML)}if(!this.options.autotypeset)return;var a=this,b=a.options.autotypeset,c={selectTdClass:1,pagebreak:1,anchorclass:1},d={li:1},e={div:1,p:1},f;b.pasteFilter&&a.addListener("beforepaste",i),a.commands.autotypeset={execCommand:function(){a.removeListener("beforepaste",i),b.pasteFilter&&a.addListener("beforepaste",i),i()}}},UE.commands.imagefloat={execCommand:function(a,b){var c=this,d=c.selection.getRange();if(!d.collapsed){var e=d.getClosedNode();if(e&&e.tagName=="IMG")switch(b){case"left":case"right":case"none":var f=e.parentNode,g,h,i;while(dtd.$inline[f.tagName]||f.tagName=="A")f=f.parentNode;g=f;if(g.tagName=="P"&&domUtils.getStyle(g,"text-align")=="center"){if(!domUtils.isBody(g)&&domUtils.getChildCount(g,function(a){return!domUtils.isBr(a)&&!domUtils.isWhitespace(a)})==1){h=g.previousSibling,i=g.nextSibling;if(h&&i&&h.nodeType==1&&i.nodeType==1&&h.tagName==i.tagName&&domUtils.isBlockElm(h)){h.appendChild(g.firstChild);while(i.firstChild)h.appendChild(i.firstChild);domUtils.remove(g),domUtils.remove(i)}else domUtils.setStyle(g,"text-align","")}d.selectNode(e).select()}domUtils.setStyle(e,"float",b);break;case"center":if(c.queryCommandValue("imagefloat")!="center"){f=e.parentNode,domUtils.setStyle(e,"float","none"),g=e;while(f&&domUtils.getChildCount(f,function(a){return!domUtils.isBr(a)&&!domUtils.isWhitespace(a)})==1&&(dtd.$inline[f.tagName]||f.tagName=="A"))g=f,f=f.parentNode;d.setStartBefore(g).setCursor(!1),f=c.document.createElement("div"),f.appendChild(g),domUtils.setStyle(g,"float",""),c.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+f.innerHTML+"</p>"),g=c.document.getElementById("_img_parent_tmp"),g.removeAttribute("id"),g=g.firstChild,d.selectNode(g).select(),i=g.parentNode.nextSibling,i&&domUtils.isEmptyNode(i)&&domUtils.remove(i)}}}},queryCommandValue:function(){var a=this.selection.getRange(),b,c;return a.collapsed?"none":(b=a.getClosedNode(),b&&b.nodeType==1&&b.tagName=="IMG"?(c=domUtils.getComputedStyle(b,"float"),c=="none"&&(c=domUtils.getComputedStyle(b.parentNode,"text-align")=="center"?"center":c),{left:1,right:1,center:1}[c]?c:"none"):"none")},queryCommandState:function(){if(this.highlight)return-1;var a=this.selection.getRange(),b;return a.collapsed?-1:(b=a.getClosedNode(),b&&b.nodeType==1&&b.tagName=="IMG"?0:-1)}},UE.commands.insertimage={execCommand:function(a,b){b=utils.isArray(b)?b:[b];if(!b.length)return;var c=this,d=c.selection.getRange(),e=d.getClosedNode();if(e&&/img/i.test(e.tagName)&&e.className!="edui-faked-video"&&!e.getAttribute("word_img")){var f=b.shift(),g=f.floatStyle;delete f.floatStyle,domUtils.setAttributes(e,f),c.execCommand("imagefloat",g),b.length>0&&(d.setStartAfter(e).setCursor(!1,!0),c.execCommand("insertimage",b))}else{var h=[],i="",j;j=b[0];if(b.length==1)i='<img src="'+j.src+'" '+(j.data_ue_src?' data_ue_src="'+j.data_ue_src+'" ':"")+(j.width?'width="'+j.width+'" ':"")+(j.height?' height="'+j.height+'" ':"")+(j.floatStyle&&j["floatStyle"]!="center"?' style="float:'+j.floatStyle+';"':"")+(j.title?' title="'+j.title+'"':"")+' border="'+(j.border||0)+'" hspace = "'+(j.hspace||0)+'" vspace = "'+(j.vspace||0)+'" />',j["floatStyle"]=="center"&&(i='<p style="text-align: center">'+i+"</p>"),h.push(i);else for(var k=0;j=b[k++];)i="<p "+(j["floatStyle"]=="center"?'style="text-align: center" ':"")+'><img src="'+j.src+'" '+(j.width?'width="'+j.width+'" ':"")+(j.data_ue_src?' data_ue_src="'+j.data_ue_src+'" ':"")+(j.height?' height="'+j.height+'" ':"")+' style="'+(j.floatStyle&&j["floatStyle"]!="center"?"float:"+j.floatStyle+";":"")+(j.border||"")+'" '+(j.title?' title="'+j.title+'"':"")+" /></p>",h.push(i);c.execCommand("insertHtml",h.join(""))}},queryCommandState:function(){return this.highlight?-1:0}},function(){var a=domUtils.isBlockElm,b={left:1,right:1,center:1,justify:1},c=function(b,c){var d=b.createBookmark(),e=function(a){return a.nodeType==1?a.tagName.toLowerCase()!="br"&&!domUtils.isBookmarkNode(a):!domUtils.isWhitespace(a)};b.enlarge(!0);var f=b.createBookmark(),g=domUtils.getNextDomNode(f.start,!1,e),h=b.cloneRange(),i;while(g&&!(domUtils.getPosition(g,f.end)&domUtils.POSITION_FOLLOWING))if(g.nodeType==3||!a(g)){h.setStartBefore(g);while(g&&g!==f.end&&!a(g))i=g,g=domUtils.getNextDomNode(g,!1,null,function(b){return!a(b)});h.setEndAfter(i);var j=h.getCommonAncestor();if(!domUtils.isBody(j)&&a(j))domUtils.setStyles(j,utils.isString(c)?{"text-align":c}:c),g=j;else{var k=b.document.createElement("p");domUtils.setStyles(k,utils.isString(c)?{"text-align":c}:c);var l=h.extractContents();k.appendChild(l),h.insertNode(k),g=k}g=domUtils.getNextDomNode(g,!1,e)}else g=domUtils
.getNextDomNode(g,!0,e);return b.moveToBookmark(f).moveToBookmark(d)};UE.commands.justify={execCommand:function(a,b){var d=this.selection.getRange(),e;if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(var f=0,g;g=this.currentSelectedArr[f++];)domUtils.isEmptyNode(g)?(e=this.document.createTextNode("p"),d.setStart(g,0).collapse(!0).insertNode(e).selectNode(e)):d.selectNodeContents(g),c(d,b),e&&domUtils.remove(e);d.selectNode(this.currentSelectedArr[0]).select()}else d.collapsed&&(e=this.document.createTextNode("p"),d.insertNode(e)),c(d,b),e&&(d.setStartBefore(e).collapse(!0),domUtils.remove(e)),d.select();return!0},queryCommandValue:function(){var a=this.selection.getStart(),c=domUtils.getComputedStyle(a,"text-align");return b[c]?c:"left"},queryCommandState:function(){return this.highlight?-1:0}}}(),function(){var a={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration"};for(var b in a)(function(a,b){UE.commands[a]={execCommand:function(c,d){d=d||(this.queryCommandState(c)?"none":c=="underline"?"underline":"line-through");var e=this,f=this.selection.getRange(),g;if(d=="default")f.collapsed&&(g=e.document.createTextNode("font"),f.insertNode(g).select()),e.execCommand("removeFormat","span,a",b),g&&(f.setStartBefore(g).setCursor(),domUtils.remove(g));else if(e.currentSelectedArr&&e.currentSelectedArr.length>0){for(var h=0,i;i=e.currentSelectedArr[h++];)f.selectNodeContents(i),f.applyInlineStyle("span",{style:b+":"+d});f.selectNodeContents(this.currentSelectedArr[0]).select()}else if(!f.collapsed)(a=="underline"||a=="strikethrough")&&e.queryCommandValue(a)&&e.execCommand("removeFormat","span,a",b),f=e.selection.getRange(),f.applyInlineStyle("span",{style:b+":"+d}).select();else{var j=domUtils.findParentByTagName(f.startContainer,"span",!0);g=e.document.createTextNode("font");if(j&&!j.children.length&&!j[browser.ie?"innerText":"textContent"].replace(fillCharReg,"").length){f.insertNode(g);if(a=="underline"||a=="strikethrough")f.selectNode(g).select(),e.execCommand("removeFormat","span,a",b,null),j=domUtils.findParentByTagName(g,"span",!0),f.setStartBefore(g);j.style.cssText=j.style.cssText+";"+b+":"+d,f.collapse(!0).select()}else{f.insertNode(g),f.selectNode(g).select(),j=f.document.createElement("span");if(a=="underline"||a=="strikethrough"){if(domUtils.findParentByTagName(g,"a",!0)){f.setStartBefore(g).setCursor(),domUtils.remove(g);return}e.execCommand("removeFormat","span,a",b)}j.style.cssText=b+":"+d,g.parentNode.insertBefore(j,g);if(!browser.ie||browser.ie&&browser.version==9){var k=j.parentNode;while(!domUtils.isBlockElm(k))k.tagName=="SPAN"&&(j.style.cssText=k.style.cssText+j.style.cssText),k=k.parentNode}f.setStart(j,0).setCursor()}domUtils.remove(g)}return!0},queryCommandValue:function(a){var c=this.selection.getStart();if(a=="underline"||a=="strikethrough"){var d=c,e;while(d&&!domUtils.isBlockElm(d)&&!domUtils.isBody(d)){if(d.nodeType==1){e=domUtils.getComputedStyle(d,b);if(e!="none")return e}d=d.parentNode}return"none"}return domUtils.getComputedStyle(c,b)},queryCommandState:function(a){return this.highlight?-1:a!="underline"&&a!="strikethrough"?0:this.queryCommandValue(a)==(a=="underline"?"underline":"line-through")}}})(b,a[b])}(),function(){function a(a){var b=a.startContainer,c=a.endContainer;(b=domUtils.findParentByTagName(b,"a",!0))&&a.setStartBefore(b),(c=domUtils.findParentByTagName(c,"a",!0))&&a.setEndAfter(c)}function b(b,c){a(b=b.adjustmentBoundary());var d=b.startContainer;d.nodeType==1&&(d=d.childNodes[b.startOffset],d&&d.nodeType==1&&d.tagName=="A"&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(d[browser.ie?"innerText":"textContent"])&&(d.innerHTML=c.href)),b.removeInlineStyle("a");if(b.collapsed){var e=b.document.createElement("a");domUtils.setAttributes(e,c),e.innerHTML=c.html||c.href,b.insertNode(e).selectNode(e)}else b.applyInlineStyle("a",c)}UE.commands.unlink={execCommand:function(){var b,c=new dom.Range(this.document),d=this.currentSelectedArr,e;if(d&&d.length>0){for(var f=0,g;g=d[f++];){b=domUtils.getElementsByTagName(g,"a");for(var h=0,i;i=b[h++];)domUtils.remove(i,!0)}domUtils.isEmptyNode(d[0])?c.setStart(d[0],0).setCursor():c.selectNodeContents(d[0]).select()}else{c=this.selection.getRange();if(c.collapsed&&!domUtils.findParentByTagName(c.startContainer,"a",!0))return;e=c.createBookmark(),a(c),c.removeInlineStyle("a").moveToBookmark(e).select()}},queryCommandState:function(){return!this.highlight&&this.queryCommandValue("link")?0:-1}},UE.commands.link={queryCommandState:function(){return this.highlight?-1:0},execCommand:function(a,c){var d=new dom.Range(this.document),e=this.currentSelectedArr;if(e&&e.length){for(var f=0,g;g=e[f++];)domUtils.isEmptyNode(g)&&(g.innerHTML=c.href),b(d.selectNodeContents(g),c);d.selectNodeContents(e[0]).select()}else b(d=this.selection.getRange(),c),d.collapse().select(browser.gecko?!0:!1)},queryCommandValue:function(){var a=new dom.Range(this.document),b=this.currentSelectedArr,c,d;if(b&&b.length)for(var e=0,f;f=b[e++];){c=f.getElementsByTagName("a");if(c[0])return c[0]}else{a=this.selection.getRange();if(!a.collapsed){a.shrinkBoundary();var g=a.startContainer.nodeType==3||!a.startContainer.childNodes[a.startOffset]?a.startContainer:a.startContainer.childNodes[a.startOffset],h=a.endContainer.nodeType==3||a.endOffset==0?a.endContainer:a.endContainer.childNodes[a.endOffset-1],i=a.getCommonAncestor();d=domUtils.findParentByTagName(i,"a",!0);if(!d&&i.nodeType==1){var c=i.getElementsByTagName("a"),j,k;for(var e=0,l;l=c[e++];){j=domUtils.getPosition(l,g),k=domUtils.getPosition(l,h);if((j&domUtils.POSITION_FOLLOWING||j&domUtils.POSITION_CONTAINS)&&(k&domUtils.POSITION_PRECEDING||k&domUtils.POSITION_CONTAINS)){d=l;break}}}return d}d=this.selection.getStart();if(d&&(d=domUtils.findParentByTagName(d,"a",!0)))return d}}}}(),UE.commands.gmap=UE.commands.map={queryCommandState:function(){return this.highlight?-1:0}},UE.commands.insertframe={queryCommandState:function(){return this.highlight?-1:0}},UE.commands.removeformat={execCommand:function(a,b,c,d,e){function m(a){if(a.nodeType==3||a.tagName.toLowerCase()!="span")return 0;if(browser.ie){var b=a.attributes;if(b.length){for(var c=0,d=b.length;c<d;c++)if(b[c].specified)return 0;return 1}}return!a.attributes.length}function n(a){var b=a.createBookmark();a.collapsed&&a.enlarge(!0);if(!e){var d=domUtils.findParentByTagName(a.startContainer,"a",!0);d&&a.setStartBefore(d),d=domUtils.findParentByTagName(a.endContainer,"a",!0),d&&a.setEndAfter(d)}i=a.createBookmark(),o=i.start;while((k=o.parentNode)&&!domUtils.isBlockElm(k))domUtils.breakParent(o,k),domUtils.clearEmptySibling(o);if(i.end){o=i.end;while((k=o.parentNode)&&!domUtils.isBlockElm(k))domUtils.breakParent(o,k),domUtils.clearEmptySibling(o);var h=domUtils.getNextDomNode(i.start,!1,l),j;while(h){if(h==i.end)break;j=domUtils.getNextDomNode(h,!0,l),!dtd.$empty[h.tagName.toLowerCase()]&&!domUtils.isBookmarkNode(h)&&(f.test(h.tagName)?c?(domUtils.removeStyle(h,c),m(h)&&c!="text-decoration"&&domUtils.remove(h,!0)):domUtils.remove(h,!0):!dtd.$tableContent[h.tagName]&&!dtd.$list[h.tagName]&&(domUtils.removeAttributes(h,g),m(h)&&domUtils.remove(h,!0))),h=j}}var n=i.start.parentNode;domUtils.isBlockElm(n)&&!dtd.$tableContent[n.tagName]&&!dtd.$list[n.tagName]&&domUtils.removeAttributes(n,g),n=i.end.parentNode,i.end&&domUtils.isBlockElm(n)&&!dtd.$tableContent[n.tagName]&&!dtd.$list[n.tagName]&&domUtils.removeAttributes(n,g),a.moveToBookmark(i).moveToBookmark(b);var o=a.startContainer,p,q=a.collapsed;while(o.nodeType==1&&domUtils.isEmptyNode(o)&&dtd.$removeEmpty[o.tagName])p=o.parentNode,a.setStartBefore(o),a.startContainer===a.endContainer&&a.endOffset--,domUtils.remove(o),o=p;if(!q){o=a.endContainer;while(o.nodeType==1&&domUtils.isEmptyNode(o)&&dtd.$removeEmpty[o.tagName])p=o.parentNode,a.setEndBefore(o),domUtils.remove(o),o=p}}var f=new RegExp("^(?:"+(b||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),g=c?[]:(d||this.options.removeFormatAttributes).split(","),h=new dom.Range(this.document),i,j,k,l=function(a){return a.nodeType==1};if(this.currentSelectedArr&&this.currentSelectedArr.length){for(var o=0,p;p=this.currentSelectedArr[o++];)h.selectNodeContents(p),n(h);h.selectNodeContents(this.currentSelectedArr[0]).select()}else h=this.selection.getRange(),n(h),h.select()},queryCommandState:function(){return this.highlight?-1:0}},function(){var a=function(a){return utils.findNode(a.selection.getStartElementPath(),["blockquote"])};UE.commands.blockquote={execCommand:function(b,c){var d=this.selection.getRange(),e=a(this),f=dtd.blockquote,g=d.createBookmark(),h=this.currentSelectedArr;if(e)if(h&&h.length)domUtils.remove(e,!0);else{var i=d.startContainer,j=domUtils.isBlockElm(i)?i:domUtils.findParent(i,function(a){return domUtils.isBlockElm(a)}),k=d.endContainer,l=domUtils.isBlockElm(k)?k:domUtils.findParent(k,function(a){return domUtils.isBlockElm(a)});j=domUtils.findParentByTagName(j,"li",!0)||j,l=domUtils.findParentByTagName(l,"li",!0)||l,j.tagName=="LI"||j.tagName=="TD"||j===e?domUtils.remove(e,!0):domUtils.breakParent(j,e),j!==l&&(e=domUtils.findParentByTagName(l,"blockquote"),e&&(l.tagName=="LI"||l.tagName=="TD"?domUtils.remove(e,!0):domUtils.breakParent(l,e)));var m=domUtils.getElementsByTagName(this.document,"blockquote");for(var n=0,o;o=m[n++];)o.childNodes.length?domUtils.getPosition(o,j)&domUtils.POSITION_FOLLOWING&&domUtils.getPosition(o,l)&domUtils.POSITION_PRECEDING&&domUtils.remove(o,!0):domUtils.remove(o)}else{var p=d.cloneRange(),q=p.startContainer.nodeType==1?p.startContainer:p.startContainer.parentNode,r=q,s=1;for(;;){if(domUtils.isBody(q)){r!==q?d.collapsed?(p.selectNode(r),s=0):p.setStartBefore(r):p.setStart(q,0);break}if(!f[q.tagName]){d.collapsed?p.selectNode(r):p.setStartBefore(r);break}r=q,q=q.parentNode}if(s){r=q=q=p.endContainer.nodeType==1?p.endContainer:p.endContainer.parentNode;for(;;){if(domUtils.isBody(q)){r!==q?p.setEndAfter(r):p.setEnd(q,q.childNodes.length);break}if(!f[q.tagName]){p.setEndAfter(r);break}r=q,q=q.parentNode}}q=d.document.createElement("blockquote"),domUtils.setAttributes(q,c),q.appendChild(p.extractContents()),p.insertNode(q);var t=domUtils.getElementsByTagName(q,"blockquote");for(var n=0,u;u=t[n++];)u.parentNode&&domUtils.remove(u,!0)}d.moveToBookmark(g).select()},queryCommandState:function(){return this.highlight?-1:a(this)?1:0}}}(),UE.commands.indent={execCommand:function(){var a=this,b=a.queryCommandState("indent")?"0em":a.options.indentValue||"2em";a.execCommand("Paragraph","p",{style:"text-indent:"+b})},queryCommandState:function(){if(this.highlight)return-1;var a=utils.findNode(this.selection.getStartElementPath(),["p","h1","h2","h3","h4","h5","h6"]),b=a&&a.style.textIndent?parseInt(a.style.textIndent):"";return b?1:0}},UE.commands.print={execCommand:function(){this.window.print()},notNeedUndo:1},UE.commands.preview={execCommand:function(){var a=this,b=window.open("","_blank",""),c=b.document,d=a.document.getElementById("syntaxhighlighter_css"),e=document.getElementById("syntaxhighlighter_js"),f="<style type='text/css'>"+a.options.initialStyle+"</style>",g=a.getContent();browser.ie&&(g=g.replace(/<\s*br\s*\/?\s*>/gi,"<br/><br/>")),c.open(),c.write("<html><head>"+f+'<link rel="stylesheet" type="text/css" href="'+a.options.UEDITOR_HOME_URL+utils.unhtml(this.options.iframeCssUrl)+'"/>'+(d?'<link rel="stylesheet" type="text/css" href="'+d.href+'"/>':"")+(d?' <script type="text/javascript" charset="utf-8" src="'+e.src+'"></script>':"")+"<title></title></head><body >"+g+(d?'<script type="text/javascript">'+(baidu.editor.browser.ie?"window.onload = function(){SyntaxHighlighter.all()};":"SyntaxHighlighter.all();")+"setTimeout(function(){"+"for(var i=0,di;di=SyntaxHighlighter.highlightContainers[i++];){"+'var tds = di.getElementsByTagName("td");'+"for(var j=0,li,ri;li=tds[0].childNodes[j];j++){"+"ri = tds[1].firstChild.childNodes[j];"+'ri.style.height = li.style.height = ri.offsetHeight + "px";'+"}"+"}},100)</script>":"")+"</body></html>"),c.close()},notNeedUndo:1},UE.commands.spechars={queryCommandState:function(){return this.highlight?-1:0}},UE.commands.emotion={queryCommandState:function(){return this.highlight?-1:0}},UE.plugins.selectall=function(){var a=this;a.commands.selectall={execCommand:function(){var a=this.selection.getRange();a.selectNodeContents(this.body),domUtils.isEmptyBlock(this.body)&&a.collapse(!0),a.select(!0),this.selectAll=!0},notNeedUndo:1},a.addListener("ready",function(){domUtils.on(a.document,"click",function(b){a.selectAll=!1})})},function(){var a=domUtils.isBlockElm,b=["TD","LI","PRE"],c=function(c,d,e,f){var g=c.createBookmark(),h=function(a){return a.nodeType==1?a.tagName.toLowerCase()!="br"&&!domUtils.isBookmarkNode(a):!domUtils.isWhitespace(a)},i;c.enlarge(!0);var j=c.createBookmark(),k=domUtils.getNextDomNode(j.start,!1,h),l=c.cloneRange(),m;while(k&&!(domUtils.getPosition(k,j.end)&domUtils.POSITION_FOLLOWING))if(k.nodeType==3||!a(k)){l.setStartBefore(k);while(k&&k!==j.end&&!a(k))m=k,k=domUtils.getNextDomNode(k,!1,null,function(b){return!a(b)});l.setEndAfter(m),i=c.document.createElement(d),e&&(domUtils.setAttributes(i,e),f&&f=="customstyle"&&e.style&&(i.style.cssText=e.style)),i.appendChild(l.extractContents()),domUtils.isEmptyNode(i)&&domUtils.fillChar(c.document,i),l.insertNode(i);var n=i.parentNode;if(a(n)&&!domUtils.isBody(i.parentNode)&&utils.indexOf(b,n.tagName)==-1){if(!f||f!="customstyle")n.getAttribute("dir")&&i.setAttribute("dir",n.getAttribute("dir")),n.style.cssText&&(i.style.cssText=n.style.cssText+";"+i.style.cssText),n.style.textAlign&&!i.style.textAlign&&(i.style.textAlign=n.style.textAlign),n.style.textIndent&&!i.style.textIndent&&(i.style.textIndent=n.style.textIndent),n.style.padding&&!i.style.padding&&(i.style.padding=n.style.padding);e&&/h\d/i.test(n.tagName)&&!/h\d/i.test(i.tagName)?(domUtils.setAttributes(n,e),f&&f=="customstyle"&&e.style&&(n.style.cssText=e.style),domUtils.remove(i,!0),i=n):domUtils.remove(i.parentNode,!0)}utils.indexOf(b,n.tagName)!=-1?k=n:k=i,k=domUtils.getNextDomNode(k,!1,h)}else k=domUtils.getNextDomNode(k,!0,h);return c.moveToBookmark(j).moveToBookmark(g)};UE.commands.paragraph={execCommand:function(a,b,d,e){var f=new dom.Range(this.document);if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(var g=0,h;h=this.currentSelectedArr[g++];){if(h.style.display=="none")continue;if(domUtils.isEmptyNode(h)){var i=this.document.createTextNode("paragraph");h.innerHTML="",h.appendChild(i)}c(f.selectNodeContents(h),b,d,e);if(i){var j=i.parentNode;domUtils.remove(i),domUtils.isEmptyNode(j)&&domUtils.fillNode(this.document,j)}}var k=this.currentSelectedArr[0];domUtils.isEmptyBlock(k)?f.setStart(k,0).setCursor(!1,!0):f.selectNode(k).select()}else{f=this.selection.getRange();if(f.collapsed){var l=this.document.createTextNode("p");f.insertNode(l);if(browser.ie){var m=l.previousSibling;m&&domUtils.isWhitespace(m)&&domUtils.remove(m),m=l.nextSibling,m&&domUtils.isWhitespace(m)&&domUtils.remove(m)}}f=c(f,b,d,e),l&&(f.setStartBefore(l).collapse(!0),j=l.parentNode,domUtils.remove(l),domUtils.isBlockElm(j)&&domUtils.isEmptyNode(j)&&domUtils.fillNode(this.document,j));if(browser.gecko&&f.collapsed&&f.startContainer.nodeType==1){var n=f.startContainer.childNodes[f.startOffset];n&&n.nodeType==1&&n.tagName.toLowerCase()==b&&f.setStart(n,0).collapse(!0)}f.select()}return!0},queryCommandValue:function(){var a=utils.findNode(this.selection.getStartElementPath(),["p","h1","h2","h3","h4","h5","h6"]);return a?a.tagName.toLowerCase():""},queryCommandState:function(){return this.highlight?-1:0}}}(),function(){var a=domUtils.isBlockElm,b=function(a){return utils.findNode(a.selection.getStartElementPath(),null,function(a){return a.getAttribute("dir")})},c=function(c,d,e){var f,g=function(a){return a.nodeType==1?!domUtils.isBookmarkNode(a):!domUtils.isWhitespace(a)},h=b(d);if(h&&c.collapsed)return h.setAttribute("dir",e),c;f=c.createBookmark(),c.enlarge(!0);var i=c.createBookmark(),j=domUtils.getNextDomNode(i.start,!1,g),k=c.cloneRange(),l;while(j&&!(domUtils.getPosition(j,i.end)&domUtils.POSITION_FOLLOWING))if(j.nodeType==3||!a(j)){k.setStartBefore(j);while(j&&j!==i.end&&!a(j))l=j,j=domUtils.getNextDomNode(j,!1,null,function(b){return!a(b)});k.setEndAfter(l);var m=k.getCommonAncestor();if(!domUtils.isBody(m)&&a(m))m.setAttribute("dir",e),j=m;else{var n=c.document.createElement("p");n.setAttribute("dir",e);var o=k.extractContents();n.appendChild(o),k.insertNode(n),j=n}j=domUtils.getNextDomNode(j,!1,g)}else j=domUtils.getNextDomNode(j,!0,g);return c.moveToBookmark(i).moveToBookmark(f)};UE.commands.directionality={execCommand:function(a,b){var d=new dom.Range(this.document);if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(var e=0,f;f=this.currentSelectedArr[e++];)f.style.display!="none"&&c(d.selectNode(f),this,b);d.selectNode(this.currentSelectedArr[0]).select()}else{d=this.selection.getRange();if(d.collapsed){var g=this.document.createTextNode("d");d.insertNode(g)}c(d,this,b),g&&(d.setStartBefore(g).collapse(!0),domUtils.remove(g)),d.select()}return!0},queryCommandValue:function(){var a=b(this);return a?a.getAttribute("dir"):"ltr"},queryCommandState:function(){return this.highlight?-1:0}}}(),UE.commands.horizontal={execCommand:function(a){var b=this;if(b.queryCommandState(a)!==-1){b.execCommand("insertHtml","<hr>");var c=b.selection.getRange(),d=c.startContainer;if(d.nodeType==1&&!d.childNodes[c.startOffset]){var e;(e=d.childNodes[c.startOffset-1])&&e.nodeType==1&&e.tagName=="HR"&&(b.options.enterTag=="p"?(e=b.document.createElement("p"),c.insertNode(e),c.setStart(e,0).setCursor()):(e=b.document.createElement("br"),c.insertNode(e),c.setStartBefore(e).setCursor()))}return!0}},queryCommandState:function(){return this.highlight||utils.findNode(this.selection.getStartElementPath(),["table"])?-1:0}},UE.commands.time=UE.commands.date={execCommand:function(a){var b=new Date;this.execCommand("insertHtml",a=="time"?b.getHours()+":"+(b.getMinutes()<10?"0"+b.getMinutes():b.getMinutes())+":"+(b.getSeconds()<10?"0"+b.getSeconds():b.getSeconds()):b.getFullYear()+"-"+(b.getMonth()+1<10?"0"+(b.getMonth()+1):b.getMonth()+1)+"-"+(b.getDate()<10?"0"+b.getDate():b.getDate()))},queryCommandState:function(){return this.highlight?-1:0}},UE.commands.rowspacing={execCommand:function(a,b,c){return this.execCommand("paragraph","p",{style:"margin-"+c+":"+b+"px"}),!0},queryCommandValue:function(a,b){var c=utils.findNode(this.selection.getStartElementPath(),null,function(a){return domUtils.isBlockElm(a)}),d;return c?(d=domUtils.getComputedStyle(c,"margin-"+b).replace(/[^\d]/g,""),d?d:0):0},queryCommandState:function(){return this.highlight?-1:0}},UE.plugins.lineheight=function(){var a=this;a.commands.lineheight={execCommand:function(a,b){return this.execCommand("paragraph","p",{style:"line-height:"+(b=="1"?"normal":b+"em")}),!0},queryCommandValue:function(){var a=utils.findNode(this.selection.getStartElementPath(),null,function(a){return domUtils.isBlockElm(a)});if(a){var b=domUtils.getComputedStyle(a,"line-height");return b=="normal"?1:b.replace(/[^\d.]*/ig,"")}},queryCommandState:function(){return this.highlight?-1:0}}},UE.commands.cleardoc={execCommand:function(a){var b=this,c=b.options.enterTag,d=b.selection.getRange();c=="br"?(b.body.innerHTML="<br/>",d.setStart(b.body,0).setCursor()):(b.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>",d.setStart(b.body.firstChild,0).setCursor(!1,!0))}},UE.commands.anchor={execCommand:function(a,b){var c=this.selection.getRange(),d=c.getClosedNode();if(d&&d.getAttribute("anchorname"))b?d.setAttribute("anchorname",b):(c.setStartBefore(d).setCursor(),domUtils.remove(d));else if(b){var e=this.document.createElement("img");c.collapse(!0),domUtils.setAttributes(e,{anchorname:b,"class":"anchorclass"}),c.insertNode(e).setStartAfter(e).setCursor(!1,!0)}},queryCommandState:function(){return this.highlight?-1:0}},UE.commands["delete"]={execCommand:function(){var a=this.selection.getRange(),b=0,c=0,d=this;if(this.selectAll){d.body.innerHTML="<p>"+(browser.ie?"&nbsp;":"<br/>")+"</p>",a.setStart(d.body.firstChild,0).setCursor(!1,!0),d.selectAll=!1;return}if(d.currentSelectedArr&&d.currentSelectedArr.length>0){for(var e=0,f;f=d.currentSelectedArr[e++];)f.style.display!="none"&&(f.innerHTML=browser.ie?domUtils.fillChar:"<br/>");a.setStart(d.currentSelectedArr[0],0).setCursor();return}if(a.collapsed)return;a.txtToElmBoundary();while(!a.startOffset&&!domUtils.isBody(a.startContainer)&&!dtd.$tableContent[a.startContainer.tagName])b=1,a.setStartBefore(a.startContainer);while(!domUtils.isBody(a.endContainer)&&!dtd.$tableContent[a.endContainer.tagName]){var g,h=a.endContainer,i=a.endOffset;g=h.childNodes[i];if(!g||domUtils.isBr(g)&&h.lastChild===g){a.setEndAfter(h);continue}break}if(b){var j=d.document.createElement("span");j.innerHTML="start",j.id="_baidu_cut_start",a.insertNode(j).setStartBefore(j)}if(c){var k=d.document.createElement("span");k.innerHTML="end",k.id="_baidu_cut_end",a.cloneRange().collapse(!1).insertNode(k),a.setEndAfter(k)}a.deleteContents(),domUtils.isBody(a.startContainer)&&domUtils.isEmptyBlock(d.body)?(d.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>",a.setStart(d.body.firstChild,0).collapse(!0)):!browser.ie&&domUtils.isEmptyBlock(a.startContainer)&&(a.startContainer.innerHTML="<br/>"),a.select(!0)},queryCommandState:function(){return this.currentSelectedArr&&this.currentSelectedArr.length>0?0:this.highlight||this.selection.getRange().collapsed?-1:0}},UE.commands.wordcount={queryCommandValue:function(a,b){var c,d,e;if(b)return e=new RegExp("[\r	\n]","g"),d=this.getContentTxt().replace(e,""),d.length;var f=this.options.wordCount,g=this.options.maximumWords,h=this.options.messages.wordCountMsg,i=this.options.messages.wordOverFlowMsg;return f?(e=new RegExp("[\r	\n]","g"),d=this.getContentTxt().replace(e,""),c=d.length,g-c<0?"<span style='color:red;direction: none'>"+i+"</span> ":(h=h.replace("{#leave}",g-c>=0?g-c:0),h=h.replace("{#count}",c),h)):""}},UE.plugins.pagebreak=function(){function c(b){if(domUtils.isEmptyBlock(b)){var c=b.firstChild,d;while(c&&c.nodeType==1&&domUtils.isEmptyBlock(c))d=c,c=c.firstChild;!d&&(d=b),domUtils.fillNode(a.document,d)}}function d(a){return a&&a.nodeType==1&&a.tagName=="HR"&&a.className=="pagebreak"}var a=this,b=["td"];a.commands.pagebreak={execCommand:function(){var e=a.selection.getRange(),f=a.document.createElement("hr");domUtils.setAttributes(f,{"class":"pagebreak",noshade:"noshade",size:"5"}),domUtils.unselectable(f);var g=domUtils.findParentByTagName(e.startContainer,b,!0),h=[],i;if(g)switch(g.tagName){case"TD":i=g.parentNode;if(!i.previousSibling){var j=domUtils.findParentByTagName(i,"table");j.parentNode.insertBefore(f,j),h=domUtils.findParents(f,!0)}else i.parentNode.insertBefore(f,i),h=domUtils.findParents(f);i=h[1],f!==i&&domUtils.breakParent(f,i),domUtils.clearSelectedArr(a.currentSelectedArr)}else{if(!e.collapsed){e.deleteContents();var k=e.startContainer;while(domUtils.isBlockElm(k)&&domUtils.isEmptyNode(k))e.setStartBefore(k).collapse(!0),domUtils.remove(k),k=e.startContainer}e.insertNode(f);var i=f.parentNode,l;while(!domUtils.isBody(i))domUtils.breakParent(f,i),l=f.nextSibling,l&&domUtils.isEmptyBlock(l)&&domUtils.remove(l),i=f.parentNode;l=f.nextSibling;var m=f.previousSibling;d(m)?domUtils.remove(m):c(m);if(!l){var n=a.document.createElement("p");f.parentNode.appendChild(n),domUtils.fillNode(a.document,n),e.setStart(n,0).collapse(!0)}else d(l)?domUtils.remove(l):c(l),e.setEndAfter(f).collapse(!1);e.select(!0)}},queryCommandState:function(){return this.highlight?-1:0}}},UE.plugins.wordimage=function(){var a=this,b;a.commands.wordimage={execCommand:function(){b=domUtils.getElementsByTagName(a.document.body,"img");var c=[];for(var d=0,e;e=b[d++];){var f=e.getAttribute("word_img");f&&c.push(f)}b.length&&(this.word_img=c)},queryCommandState:function(){b=domUtils.getElementsByTagName(a.document.body,"img");for(var c=0,d;d=b[c++];)if(d.getAttribute("word_img"))return 1;return-1}}},UE.plugins.undo=function(){function f(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.undo=function(){if(this.hasUndo){var a=this.getScene(),b=this.list[this.index];b.content.replace(e,"")!=a.content.replace(e,"")&&this.save();if(!this.list[this.index-1]&&this.list.length==1){this.reset();return}while(this.list[this.index].content==this.list[this.index-1].content){this.index--;if(this.index==0)return this.restore(0)}this.restore(--this.index)}},this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content){this.index++;if(this.index==this.list.length-1)return this.restore(this.index)}this.restore(++this.index)}},this.restore=function(){var b=this.list[this.index];a.document.body.innerHTML=b.bookcontent.replace(d,"");if(browser.ie)for(var c=0,e,f=a.document.getElementsByTagName("p");e=f[c++];)e.innerHTML==""&&domUtils.fillNode(a.document,e);var g=new dom.Range(a.document);g.moveToBookmark({start:"_baidu_bookmark_start_",end:"_baidu_bookmark_end_",id:!0}),browser.ie&&browser.version==9&&g.collapsed&&domUtils.isBlockElm(g.startContainer)&&domUtils.isEmptyNode(g.startContainer)&&domUtils.fillNode(g.document,g.startContainer),g.select(!browser.gecko),setTimeout(function(){g.scrollToView(a.autoHeightEnabled,a.autoHeightEnabled?domUtils.getXY(a.iframe).y:0)},200),this.update();if(a.currentSelectedArr){a.currentSelectedArr=[];var h=a.document.getElementsByTagName("td");for(var c=0,i;i=h[c++];)i.className==a.options.selectedTdClass&&a.currentSelectedArr.push(i)}this.clearKey(),a.fireEvent("reset",!0),a.fireEvent("contentchange")},this.getScene=function(){var b=a.selection.getRange(),c=a.body.innerHTML.replace(d,"");b.shrinkBoundary(),browser.ie&&(c=c.replace(/>&nbsp;</g,"><").replace(/\s*</g,"").replace(/>\s*/g,">"));var e=b.createBookmark(!0,!0),f=a.body.innerHTML.replace(d,"");return b.moveToBookmark(e).select(!0),{bookcontent:f,content:c}},this.save=function(){var c=this.getScene(),d=this.list[this.index];if(d&&d.content==c.content&&d.bookcontent==c.bookcontent)return;this.list=this.list.slice(0,this.index+1),this.list.push(c),this.list.length>b&&this.list.shift(),this.index=this.list.length-1,this.clearKey(),this.update(),a.fireEvent("contentchange")},this.update=function(){this.hasRedo=this.list[this.index+1]?!0:!1,this.hasUndo=this.list[this.index-1]||this.list.length==1?!0:!1},this.reset=function(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.clearKey()},this.clearKey=function(){i=0,j=null}}function g(){this.undoManger.save()}var a=this,b=a.options.maxUndoCount,c=a.options.maxInputCount,d=new RegExp(domUtils.fillChar+"|</hr>","gi"),e=/\b(?:href|src|name)="[^"]*?"/gi;a.undoManger=new f,a.addListener("beforeexeccommand",g),a.addListener("afterexeccommand",g),a.addListener("reset",function(b,c){c||a.undoManger.reset()}),a.commands.redo=a.commands.undo={execCommand:function(b){a.undoManger[b]()},queryCommandState:function(b){return a.undoManger["has"+(b.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1},notNeedUndo:1};var h={16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},i=0,j;baidu.editor.browser.safari||a.addListener("keydown",function(b,d){var e=d.keyCode||d.which;if(!h[e]&&!d.ctrlKey&&!d.metaKey&&!d.shiftKey&&!d.altKey){if(a.undoManger.list.length==0||(e==8||e==46)&&j!=e){a.undoManger.save(),j=e;return}a.undoManger.list.length==2&&a.undoManger.index==0&&i==0&&(a.undoManger.list.splice(1,1),a.undoManger.update()),j=e,i++,i>c&&setTimeout(function(){a.undoManger.save()},0)}})},function(){function a(a){var b=this.document;if(b.getElementById("baidu_pastebin"))return;var c=this.selection.getRange(),d=c.createBookmark(),e=b.createElement("div");e.id="baidu_pastebin",browser.webkit&&e.appendChild(b.createTextNode(domUtils.fillChar+domUtils.fillChar)),b.body.appendChild(e),d.start.style.display="",e.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+domUtils.getXY(d.start).y+"px",c.selectNodeContents(e).select(!0),setTimeout(function(){if(browser.webkit)for(var f=0,g=b.querySelectorAll("#baidu_pastebin"),h;h=g[f++];){if(!domUtils.isEmptyNode(h)){e=h;break}domUtils.remove(h)}try{e.parentNode.removeChild(e)}catch(i){}c.moveToBookmark(d).select(!0),a(e)},0)}UE.plugins.paste=function(){function f(a){var f;if(a.firstChild){var g=domUtils.getElementsByTagName(a,"span");for(var h=0,i;i=g[h++];)(i.id=="_baidu_cut_start"||i.id=="_baidu_cut_end")&&domUtils.remove(i);if(browser.webkit){var j=a.querySelectorAll("div br");for(var h=0,k;k=j[h++];){var l=k.parentNode;l.tagName=="DIV"&&l.childNodes.length==1&&(l.innerHTML="<p><br/></p>",domUtils.remove(l))}var m=a.querySelectorAll("#baidu_pastebin");for(var h=0,n;n=m[h++];){var o=b.document.createElement("p");n.parentNode.insertBefore(o,n);while(n.firstChild)o.appendChild(n.firstChild);domUtils.remove(n)}var p=a.querySelectorAll("meta");for(var h=0,q;q=p[h++];)domUtils.remove(q);var j=a.querySelectorAll("br");for(h=0;q=j[h++];)/^apple-/.test(q)&&domUtils.remove(q)}if(browser.gecko){var r=a.querySelectorAll("[_moz_dirty]");for(h=0;q=r[h++];)q.removeAttribute("_moz_dirty")}if(!browser.ie){var s=a.querySelectorAll("span.apple-style-span");for(var h=0,q;q=s[h++];)domUtils.remove(q,!0)}f=a.innerHTML;var t=b.serialize;if(t)try{var u=t.transformInput(t.parseHTML(t.word(f)),c);u=t.filter(u,d?{whiteList:{p:{br:1,BR:1},br:{$:{}},div:{br:1,BR:1,$:{}},li:{$:{}},tr:{td:1,$:{}},td:{$:{}}},blackList:{style:1,script:1,object:1}}:null,d?null:e);if(browser.webkit){var v=u.children.length,w;while((w=u.children[v-1])&&w.tag=="br")u.children.splice(v-1,1),v=u.children.length}f=t.toHTML(u,d)}catch(x){}f={html:f},b.fireEvent("beforepaste",f),b.execCommand("insertHtml",f.html),b.fireEvent("afterpaste")}}var b=this,c={flag:""},d=b.options.pasteplain,e={flag:""};b.commands.pasteplain={queryCommandState:function(){return d},execCommand:function(){d=!d|0},notNeedUndo:1},b.addListener("ready",function(){domUtils.on(b.body,"cut",function(){var a=b.selection.getRange();!a.collapsed&&b.undoManger&&b.undoManger.save()}),domUtils.on(b.body,browser.ie?"keydown":"paste",function(d){if(browser.ie&&(!d.ctrlKey||d.keyCode!="86"))return;a.call(b,function(a){function d(){b.ui.hideToolbarMsg(),b.removeListener("selectionchange",d)}f(a),e.flag&&b.ui&&(b.ui.showToolbarMsg(b.options.messages.pasteMsg,c.flag),e.flag="",setTimeout(function(){b.addListener("selectionchange",d)},100)),c.flag&&!b.queryCommandState("pasteplain")&&b.ui&&(b.ui.showToolbarMsg(b.options.messages.pasteWordImgMsg,!1),c.flag="",setTimeout(function(){b.addListener("selectionchange",d)},100))})})})}}(),UE.plugins.list=function(){function c(a,b,c){var d=a.nextSibling;d&&d.nodeType==1&&d.tagName.toLowerCase()==b&&(domUtils.getStyle(d,"list-style-type")||(b=="ol"?"decimal":"disc"))==c&&(domUtils.moveChild(d,a),d.childNodes.length==0&&domUtils.remove(d));var e=a.previousSibling;e&&e.nodeType==1&&e.tagName.toLowerCase()==b&&(domUtils.getStyle(e,"list-style-type")||(b=="ol"?"decimal":"disc"))==c&&domUtils.moveChild(a,e),a.childNodes.length==0&&domUtils.remove(a)}var a=this,b={TD:1,PRE:1,BLOCKQUOTE:1};a.addListener("keydown",function(b,c){function d(){c.preventDefault?c.preventDefault():c.returnValue=!1,a.undoManger&&a.undoManger.save()}var e=c.keyCode||c.which;if(e==13){var f=a.selection.getRange(),g=domUtils.findParentByTagName(f.startContainer,["ol","ul"],!0,function(a){return a.tagName=="TABLE"}),h=domUtils.findParentByTagName(f.endContainer,["ol","ul"],!0,function(a){return a.tagName=="TABLE"});if(g&&h&&g===h){if(!f.collapsed){g=domUtils.findParentByTagName(f.startContainer,"li",!0),h=domUtils.findParentByTagName(f.endContainer,"li",!0);if(!g||!h||g!==h){var i=f.cloneRange(),j=i.collapse(!1).createBookmark();f.deleteContents(),i.moveToBookmark(j);var k=domUtils.findParentByTagName(i.startContainer,"li",!0),l=k.previousSibling,m=k.nextSibling;l&&(k=l,l.firstChild&&domUtils.isBlockElm(l.firstChild)&&(l=l.firstChild),domUtils.isEmptyNode(l)&&domUtils.remove(k)),m&&(k=m,m.firstChild&&domUtils.isBlockElm(m.firstChild)&&(m=m.firstChild),domUtils.isEmptyNode(m)&&domUtils.remove(k)),i.select(),d();return}f.deleteContents(),k=domUtils.findParentByTagName(f.startContainer,"li",!0);if(k&&domUtils.isEmptyBlock(k)){l=k.previousSibling,m=k.nextSibling,p=a.document.createElement("p"),domUtils.fillNode(a.document,p),n=k.parentNode,l&&m?(f.setStart(m,0).collapse(!0).select(!0),domUtils.remove(k)):(!l&&!m||!l?n.parentNode.insertBefore(p,n):k.parentNode.parentNode.insertBefore(p,n.nextSibling),domUtils.remove(k),n.firstChild||domUtils.remove(n),f.setStart(p,0).setCursor()),d();return}}k=domUtils.findParentByTagName(f.startContainer,"li",!0);if(k){if(domUtils.isEmptyBlock(k)){j=f.createBookmark
();var n=k.parentNode;k!==n.lastChild?domUtils.breakParent(k,n):(n.parentNode.insertBefore(k,n.nextSibling),domUtils.isEmptyNode(n)&&domUtils.remove(n));if(!dtd.$list[k.parentNode.tagName])if(!domUtils.isBlockElm(k.firstChild)){p=a.document.createElement("p"),k.parentNode.insertBefore(p,k);while(k.firstChild)p.appendChild(k.firstChild);domUtils.remove(k)}else domUtils.remove(k,!0);f.moveToBookmark(j).select()}else{var o=k.firstChild;if(!o||!domUtils.isBlockElm(o)){var p=a.document.createElement("p");!k.firstChild&&domUtils.fillNode(a.document,p);while(k.firstChild)p.appendChild(k.firstChild);k.appendChild(p),o=p}var q=a.document.createElement("span");f.insertNode(q),domUtils.breakParent(q,k);var r=q.nextSibling;o=r.firstChild,o||(p=a.document.createElement("p"),domUtils.fillNode(a.document,p),r.appendChild(p),o=p),domUtils.isEmptyNode(o)&&(o.innerHTML="",domUtils.fillNode(a.document,o)),f.setStart(o,0).collapse(!0).shrinkBoundary().select(),domUtils.remove(q),l=r.previousSibling,l&&domUtils.isEmptyBlock(l)&&(l.innerHTML="<p></p>",domUtils.fillNode(a.document,l.firstChild))}d()}}}if(e==8){f=a.selection.getRange();if(f.collapsed&&domUtils.isStartInblock(f)){i=f.cloneRange().trimBoundary(),k=domUtils.findParentByTagName(f.startContainer,"li",!0);if(k&&domUtils.isStartInblock(i)){if(k&&(l=k.previousSibling)){if(e==46&&k.childNodes.length)return;dtd.$list[l.tagName]&&(l=l.lastChild),a.undoManger&&a.undoManger.save(),o=k.firstChild;if(domUtils.isBlockElm(o))if(domUtils.isEmptyNode(o)){l.appendChild(o),f.setStart(o,0).setCursor(!1,!0);while(k.firstChild)l.appendChild(k.firstChild)}else{g=domUtils.findParentByTagName(f.startContainer,"p",!0);if(g&&g!==o)return;q=a.document.createElement("span"),f.insertNode(q),domUtils.moveChild(k,l),f.setStartBefore(q).collapse(!0).select(!0),domUtils.remove(q)}else if(domUtils.isEmptyNode(k)){var p=a.document.createElement("p");l.appendChild(p),f.setStart(p,0).setCursor()}else{f.setEnd(l,l.childNodes.length).collapse().select(!0);while(k.firstChild)l.appendChild(k.firstChild)}domUtils.remove(k),a.undoManger&&a.undoManger.save(),domUtils.preventDefault(c);return}if(k&&!k.previousSibling){o=k.firstChild;if(!o||k.lastChild===o&&domUtils.isEmptyNode(domUtils.isBlockElm(o)?o:k)){var p=a.document.createElement("p");k.parentNode.parentNode.insertBefore(p,k.parentNode),domUtils.fillNode(a.document,p),f.setStart(p,0).setCursor(),domUtils.remove(k.nextSibling?k:k.parentNode),a.undoManger&&a.undoManger.save(),domUtils.preventDefault(c);return}}}}}}),a.commands.insertorderedlist=a.commands.insertunorderedlist={execCommand:function(a,d){d||(d=a.toLowerCase()=="insertorderedlist"?"decimal":"disc");var e=this,f=this.selection.getRange(),g=function(a){return a.nodeType==1?a.tagName.toLowerCase()!="br":!domUtils.isWhitespace(a)},h=a.toLowerCase()=="insertorderedlist"?"ol":"ul",i=e.document.createDocumentFragment();f.adjustmentBoundary().shrinkBoundary();var j=f.createBookmark(!0),k=domUtils.findParentByTagName(e.document.getElementById(j.start),"li"),l=0,m=domUtils.findParentByTagName(e.document.getElementById(j.end),"li"),n=0,o,p,q,r;if(k||m){k&&(o=k.parentNode),j.end||(m=k),m&&(p=m.parentNode);if(o===p){while(k!==m){r=k,k=k.nextSibling;if(!domUtils.isBlockElm(r.firstChild)){var s=e.document.createElement("p");while(r.firstChild)s.appendChild(r.firstChild);r.appendChild(s)}i.appendChild(r)}r=e.document.createElement("span"),o.insertBefore(r,m);if(!domUtils.isBlockElm(m.firstChild)){s=e.document.createElement("p");while(m.firstChild)s.appendChild(m.firstChild);m.appendChild(s)}i.appendChild(m),domUtils.breakParent(r,o),domUtils.isEmptyNode(r.previousSibling)&&domUtils.remove(r.previousSibling),domUtils.isEmptyNode(r.nextSibling)&&domUtils.remove(r.nextSibling);var t=domUtils.getComputedStyle(o,"list-style-type")||(a.toLowerCase()=="insertorderedlist"?"decimal":"disc");if(o.tagName.toLowerCase()==h&&t==d){for(var u=0,v,w=e.document.createDocumentFragment();v=i.childNodes[u++];)while(v.firstChild)w.appendChild(v.firstChild);r.parentNode.insertBefore(w,r)}else q=e.document.createElement(h),domUtils.setStyle(q,"list-style-type",d),q.appendChild(i),r.parentNode.insertBefore(q,r);domUtils.remove(r),q&&c(q,h,d),f.moveToBookmark(j).select();return}if(k){while(k){r=k.nextSibling;var x=e.document.createDocumentFragment(),y=0;while(k.firstChild)domUtils.isBlockElm(k.firstChild)&&(y=1),x.appendChild(k.firstChild);if(!y){var z=e.document.createElement("p");z.appendChild(x),i.appendChild(z)}else i.appendChild(x);domUtils.remove(k),k=r}o.parentNode.insertBefore(i,o.nextSibling),domUtils.isEmptyNode(o)?(f.setStartBefore(o),domUtils.remove(o)):f.setStartAfter(o),l=1}if(m){k=p.firstChild;while(k!==m){r=k.nextSibling,x=e.document.createDocumentFragment(),y=0;while(k.firstChild)domUtils.isBlockElm(k.firstChild)&&(y=1),x.appendChild(k.firstChild);y?i.appendChild(x):(z=e.document.createElement("p"),z.appendChild(x),i.appendChild(z)),domUtils.remove(k),k=r}i.appendChild(m.firstChild),domUtils.remove(m),p.parentNode.insertBefore(i,p),f.setEndBefore(p),domUtils.isEmptyNode(p)&&domUtils.remove(p),n=1}}l||f.setStartBefore(e.document.getElementById(j.start)),j.end&&!n&&f.setEndAfter(e.document.getElementById(j.end)),f.enlarge(!0,function(a){return b[a.tagName]}),i=e.document.createDocumentFragment();var A=f.createBookmark(),B=domUtils.getNextDomNode(A.start,!1,g),C=f.cloneRange(),D,E=domUtils.isBlockElm;while(B&&B!==A.end&&domUtils.getPosition(B,A.end)&domUtils.POSITION_PRECEDING)if(B.nodeType==3||dtd.li[B.tagName]){if(B.nodeType==1&&dtd.$list[B.tagName]){while(B.firstChild)i.appendChild(B.firstChild);D=domUtils.getNextDomNode(B,!1,g),domUtils.remove(B),B=D;continue}D=B,C.setStartBefore(B);while(B&&B!==A.end&&(!E(B)||domUtils.isBookmarkNode(B)))D=B,B=domUtils.getNextDomNode(B,!1,null,function(a){return!b[a.tagName]});B&&E(B)&&(r=domUtils.getNextDomNode(D,!1,g),r&&domUtils.isBookmarkNode(r)&&(B=domUtils.getNextDomNode(r,!1,g),D=r)),C.setEndAfter(D),B=domUtils.getNextDomNode(D,!1,g);var F=f.document.createElement("li");F.appendChild(C.extractContents()),i.appendChild(F)}else B=domUtils.getNextDomNode(B,!0,g);f.moveToBookmark(A).collapse(!0),q=e.document.createElement(h),domUtils.setStyle(q,"list-style-type",d),q.appendChild(i),f.insertNode(q),c(q,h,d),f.moveToBookmark(j).select()},queryCommandState:function(a){return this.highlight?-1:utils.findNode(this.selection.getStartElementPath(),[a.toLowerCase()=="insertorderedlist"?"ol":"ul"])?1:0},queryCommandValue:function(a){var b=utils.findNode(this.selection.getStartElementPath(),[a.toLowerCase()=="insertorderedlist"?"ol":"ul"]);return b?domUtils.getComputedStyle(b,"list-style-type"):null}}},function(){function a(a){a=a||{},this.indentChar=a.indentChar||"    ",this.breakChar=a.breakChar||"\n",this.selfClosingEnd=a.selfClosingEnd||" />"}function d(a){var c=[];for(var d in a)c.push(d+'="'+b(a[d])+'"');return c.join(" ")}var b=function(){function b(b){return a[b]}var a={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return function(a){return a+="",a?a.replace(/[<>"']/g,b):""}}(),c=utils.extend({a:1,A:1},dtd.$inline,!0);a.prototype={format:function(a){var b=UE.serialize.parseHTML(a);return this.buff=[],this.indents="",this.indenting=1,this.visitNode(b),this.buff.join("")},visitNode:function(a){if(a.type=="fragment")this.visitChildren(a.children);else if(a.type=="element"){var b=dtd.$empty[a.tag];this.visitTag(a.tag,a.attributes,b),this.visitChildren(a.children),b||this.visitEndTag(a.tag)}else a.type=="comment"?this.visitComment(a.data):this.visitText(a.data,dtd.$notTransContent[a.parent.tag])},visitChildren:function(a){for(var b=0;b<a.length;b++)this.visitNode(a[b])},visitTag:function(a,b,e){this.indenting?this.indent():c[a]||(this.newline(),this.indent()),this.buff.push("<",a);var f=d(b);f&&this.buff.push(" ",f),e?(this.buff.push(this.selfClosingEnd),a=="br"&&this.newline()):(this.buff.push(">"),this.indents+=this.indentChar),c[a]||this.newline()},indent:function(){this.buff.push(this.indents),this.indenting=0},newline:function(){this.buff.push(this.breakChar),this.indenting=1},visitEndTag:function(a){this.indents=this.indents.slice(0,-this.indentChar.length),this.indenting?this.indent():c[a]||(this.newline(),this.indent()),this.buff.push("</",a,">")},visitText:function(a,b){this.indenting&&this.indent(),a=a.replace(/&nbsp;/g," "),this.buff.push(a)},visitComment:function(a){this.indenting&&this.indent(),this.buff.push("<!--",a,"-->")}};var e={textarea:function(a,b){var c=b.ownerDocument.createElement("textarea");return c.style.cssText="position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;",browser.ie&&browser.version<8&&(c.style.width=b.offsetWidth+"px",c.style.height=b.offsetHeight+"px",b.onresize=function(){c.style.width=b.offsetWidth+"px",c.style.height=b.offsetHeight+"px"}),b.appendChild(c),{setContent:function(a){c.value=a},getContent:function(){return c.value},select:function(){var a;browser.ie?(a=c.createTextRange(),a.collapse(!0),a.select()):(c.setSelectionRange(0,0),c.focus())},dispose:function(){b.removeChild(c),b.onresize=null,c=null,b=null}}},codemirror:function(a,b){var c={mode:"text/html",tabMode:"indent",lineNumbers:!0,lineWrapping:!0},d=window.CodeMirror(b,c),e=d.getWrapperElement();return e.style.cssText='position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;',d.getScrollerElement().style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;",d.refresh(),{setContent:function(a){d.setValue(a)},getContent:function(){return d.getValue()},select:function(){d.focus()},dispose:function(){b.removeChild(e),e=null,d=null}}}};UE.plugins.source=function(){function h(a){var d=c.sourceEditor=="codemirror"&&window.CodeMirror;return e[d?"codemirror":"textarea"](b,a)}var b=this,c=this.options,d=new a(c.source),f=!1,g,i;b.commands.source={execCommand:function(){f=!f;if(f){b.undoManger&&b.undoManger.save(),this.currentSelectedArr&&domUtils.clearSelectedArr(this.currentSelectedArr),browser.gecko&&(b.body.contentEditable=!1),i=b.iframe.style.cssText,b.iframe.style.cssText+="position:absolute;left:-32768px;top:-32768px;";var a=d.format(b.hasContents()?b.getContent():"");g=h(b.iframe.parentNode),g.setContent(a),setTimeout(function(){g.select()})}else{b.iframe.style.cssText=i;var c=g.getContent()||"<p>"+(browser.ie?"":"<br/>")+"</p>";c=c.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><"),b.setContent(c),g.dispose(),g=null,setTimeout(function(){var a=b.body.firstChild;a||(b.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>",a=b.body.firstChild),b.undoManger&&b.undoManger.save();while(a&&a.firstChild)a=a.firstChild;var c=b.selection.getRange();a.nodeType==3||dtd.$empty[a.tagName]?c.setStartBefore(a):c.setStart(a,0);if(browser.gecko){var d=document.createElement("input");d.style.cssText="position:absolute;left:0;top:-32768px",document.body.appendChild(d),b.body.contentEditable=!1,setTimeout(function(){domUtils.setViewportOffset(d,{left:-32768,top:0}),d.focus(),setTimeout(function(){b.body.contentEditable=!0,c.setCursor(!1,!0),domUtils.remove(d)})})}else c.setCursor(!1,!0)})}this.fireEvent("sourcemodechanged",f)},queryCommandState:function(){return f|0}};var j=b.queryCommandState;b.queryCommandState=function(a){return a=a.toLowerCase(),f?a=="source"?1:-1:j.apply(this,arguments)};var k=b.getContent;b.getContent=function(){if(f&&g){var a=g.getContent();if(this.serialize){var b=this.serialize.parseHTML(a);b=this.serialize.filter(b),a=this.serialize.toHTML(b)}return a}return k.apply(this,arguments)},b.addListener("ready",function(){c.sourceEditor=="codemirror"&&(utils.loadFile(document,{src:c.codeMirrorJsUrl,tag:"script",type:"text/javascript",defer:"defer"}),utils.loadFile(document,{tag:"link",rel:"stylesheet",type:"text/css",href:c.codeMirrorCssUrl}))})}}(),UE.plugins.shortcutkeys=function(){var a=this,b=utils.extend({"ctrl+66":"Bold","ctrl+90":"Undo","ctrl+89":"Redo","ctrl+73":"Italic","ctrl+85":"Underline","ctrl+shift+67":"removeformat","ctrl+shift+76":"justify:left","ctrl+shift+82":"justify:right","ctrl+65":"selectAll"},a.options.shortcutkeys);a.addListener("keydown",function(c,d){var e=d.keyCode||d.which,f;for(var g in b)if(/^(ctrl)(\+shift)?\+(\d+)$/.test(g.toLowerCase())||/^(\d+)$/.test(g))if((RegExp.$1=="ctrl"?d.ctrlKey||d.metaKey:0)&&(RegExp.$2!=""?d[RegExp.$2.slice(1)+"Key"]:1)&&e==RegExp.$3||e==RegExp.$1)f=b[g].split(":"),a.execCommand(f[0],f[1]),domUtils.preventDefault(d)})},UE.plugins.enterkey=function(){var a,b=this,c=b.options.enterTag;b.addListener("keyup",function(c,d){var e=d.keyCode||d.which;if(e==13){var f=b.selection.getRange(),g=f.startContainer,h;if(!browser.ie&&/h\d/i.test(a)){if(browser.gecko){var i=domUtils.findParentByTagName(g,["h1","h2","h3","h4","h5","h6","blockquote"],!0);i||(b.document.execCommand("formatBlock",!1,"<p>"),h=1)}else if(g.nodeType==1){var j=b.document.createTextNode(""),k;f.insertNode(j),k=domUtils.findParentByTagName(j,"div",!0);if(k){var l=b.document.createElement("p");while(k.firstChild)l.appendChild(k.firstChild);k.parentNode.insertBefore(l,k),domUtils.remove(k),f.setStartBefore(j).setCursor(),h=1}domUtils.remove(j)}b.undoManger&&h&&b.undoManger.save()}setTimeout(function(){b.selection.getRange().scrollToView(b.autoHeightEnabled,b.autoHeightEnabled?domUtils.getXY(b.iframe).y:0)},50)}}),b.addListener("keydown",function(d,e){var f=e.keyCode||e.which;if(f==13){b.undoManger&&b.undoManger.save(),a="";var g=b.selection.getRange();if(!g.collapsed){var h=g.startContainer,i=g.endContainer,j=domUtils.findParentByTagName(h,"td",!0),k=domUtils.findParentByTagName(i,"td",!0);if(j&&k&&j!==k||!j&&k||j&&!k){e.preventDefault?e.preventDefault():e.returnValue=!1;return}}b.currentSelectedArr&&domUtils.clearSelectedArr(b.currentSelectedArr);if(c=="p")browser.ie||(h=domUtils.findParentByTagName(g.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote"],!0),h?(a=h.tagName,h.tagName.toLowerCase()=="p"&&browser.gecko&&domUtils.removeDirtyAttr(h)):(b.document.execCommand("formatBlock",!1,"<p>"),browser.gecko&&(g=b.selection.getRange(),h=domUtils.findParentByTagName(g.startContainer,"p",!0),h&&domUtils.removeDirtyAttr(h))));else{e.preventDefault?e.preventDefault():e.returnValue=!1;if(!g.collapsed){g.deleteContents(),h=g.startContainer;if(h.nodeType==1&&(h=h.childNodes[g.startOffset])){while(h.nodeType==1){if(dtd.$empty[h.tagName])return g.setStartBefore(h).setCursor(),b.undoManger&&b.undoManger.save(),!1;if(!h.firstChild){var l=g.document.createElement("br");return h.appendChild(l),g.setStart(h,0).setCursor(),b.undoManger&&b.undoManger.save(),!1}h=h.firstChild}h===g.startContainer.childNodes[g.startOffset]?(l=g.document.createElement("br"),g.insertNode(l).setCursor()):g.setStart(h,0).setCursor()}else l=g.document.createElement("br"),g.insertNode(l).setStartAfter(l).setCursor()}else{l=g.document.createElement("br"),g.insertNode(l);var m=l.parentNode;m.lastChild===l?(l.parentNode.insertBefore(l.cloneNode(!0),l),g.setStartBefore(l)):g.setStartAfter(l),g.setCursor()}}}})},UE.plugins.keystrokes=function(){var a=this,b=0,c=domUtils.keys,d={B:"strong",I:"em",FONT:"span"},e=[0,10,12,16,18,24,32,48],f={OL:["decimal","lower-alpha","lower-roman","upper-alpha","upper-roman"],UL:["circle","disc","square"]};a.addListener("keydown",function(c,d){var e=d.keyCode||d.which;if(this.selectAll){this.selectAll=!1;if(e==8||e==46){a.undoManger&&a.undoManger.save(),a.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>",(new dom.Range(a.document)).setStart(a.body.firstChild,0).setCursor(!1,!0),a.undoManger&&a.undoManger.save(),browser.ie&&a._selectionChange(),domUtils.preventDefault(d);return}}if(e==8){var g=a.selection.getRange(),h,i,j;if(g.collapsed){i=g.startContainer,domUtils.isWhitespace(i)&&(i=i.parentNode);if(domUtils.isEmptyNode(i)&&i===a.body.firstChild){i.tagName!="P"&&(p=a.document.createElement("p"),a.body.insertBefore(p,i),domUtils.fillNode(a.document,p),g.setStart(p,0).setCursor(!1,!0),domUtils.remove(i)),domUtils.preventDefault(d);return}}g.collapsed&&g.startContainer.nodeType==3&&g.startContainer.nodeValue.replace(new RegExp(domUtils.fillChar,"g"),"").length==0&&g.setStartBefore(g.startContainer).collapse(!0);if(i=g.getClosedNode()){a.undoManger&&a.undoManger.save(),g.setStartBefore(i),domUtils.remove(i),g.setCursor(),a.undoManger&&a.undoManger.save(),domUtils.preventDefault(d);return}if(!browser.ie){i=domUtils.findParentByTagName(g.startContainer,"table",!0),j=domUtils.findParentByTagName(g.endContainer,"table",!0);if(i&&!j||!i&&j||i!==j){d.preventDefault();return}if(browser.webkit&&g.collapsed&&i){h=g.cloneRange().txtToElmBoundary(),i=h.startContainer;if(domUtils.isBlockElm(i)&&i.nodeType==1&&!dtd.$tableContent[i.tagName]&&!domUtils.getChildCount(i,function(a){return a.nodeType==1?a.tagName!=="BR":1})){h.setStartBefore(i).setCursor(),domUtils.remove(i,!0),d.preventDefault();return}}}a.undoManger&&(g.collapsed||(a.undoManger.save(),b=1))}if(e==9){g=a.selection.getRange(),a.undoManger&&a.undoManger.save();for(var k=0,l="";k<a.options.tabSize;k++)l+=a.options.tabNode;var m=a.document.createElement("span");m.innerHTML=l;if(g.collapsed){var n=domUtils.findParentByTagName(g.startContainer,"li",!0);if(n&&domUtils.isStartInblock(g)){s=g.createBookmark();var o=n.parentNode,q=a.document.createElement(o.tagName),r=utils.indexOf(f[q.tagName],domUtils.getComputedStyle(o,"list-style-type"));r=r+1==f[q.tagName].length?0:r+1,domUtils.setStyle(q,"list-style-type",f[q.tagName][r]),o.insertBefore(q,n),q.appendChild(n),g.moveToBookmark(s).select()}else g.insertNode(m.cloneNode(!0).firstChild).setCursor(!0)}else{i=domUtils.findParentByTagName(g.startContainer,"table",!0),j=domUtils.findParentByTagName(g.endContainer,"table",!0);if(i||j){d.preventDefault?d.preventDefault():d.returnValue=!1;return}i=domUtils.findParentByTagName(g.startContainer,["ol","ul"],!0),j=domUtils.findParentByTagName(g.endContainer,["ol","ul"],!0);if(i&&j&&i===j){var s=g.createBookmark();i=domUtils.findParentByTagName(g.startContainer,"li",!0),j=domUtils.findParentByTagName(g.endContainer,"li",!0);if(i===i.parentNode.firstChild){var t=a.document.createElement(i.parentNode.tagName);i.parentNode.parentNode.insertBefore(t,i.parentNode),t.appendChild(i.parentNode)}else{o=i.parentNode,q=a.document.createElement(o.tagName),r=utils.indexOf(f[q.tagName],domUtils.getComputedStyle(o,"list-style-type")),r=r+1==f[q.tagName].length?0:r+1,domUtils.setStyle(q,"list-style-type",f[q.tagName][r]),i.parentNode.insertBefore(q,i);var u;while(i!==j)u=i.nextSibling,q.appendChild(i),i=u;q.appendChild(j)}g.moveToBookmark(s).select()}else{if(i||j){d.preventDefault?d.preventDefault():d.returnValue=!1;return}i=domUtils.findParent(g.startContainer,w),j=domUtils.findParent(g.endContainer,w);if(i&&j&&i===j)g.deleteContents(),g.insertNode(m.cloneNode(!0).firstChild).setCursor(!0);else{var v=g.createBookmark(),w=function(a){return domUtils.isBlockElm(a)};g.enlarge(!0);var x=g.createBookmark(),y=domUtils.getNextDomNode(x.start,!1,w);while(y&&!(domUtils.getPosition(y,x.end)&domUtils.POSITION_FOLLOWING))y.insertBefore(m.cloneNode(!0).firstChild,y.firstChild),y=domUtils.getNextDomNode(y,!1,w);g.moveToBookmark(x).moveToBookmark(v).select()}}}a.undoManger&&a.undoManger.save(),d.preventDefault?d.preventDefault():d.returnValue=!1}if(browser.gecko&&e==46){g=a.selection.getRange();if(g.collapsed){i=g.startContainer;if(domUtils.isEmptyBlock(i)){var z=i.parentNode;while(domUtils.getChildCount(z)==1&&!domUtils.isBody(z))i=z,z=z.parentNode;i===z.lastChild&&d.preventDefault();return}}}}),a.addListener("keyup",function(f,g){var h=g.keyCode||g.which;if(!browser.gecko&&!c[h]&&!g.ctrlKey&&!g.metaKey&&!g.shiftKey&&!g.altKey){p=a.selection.getRange();if(p.collapsed){var i=p.startContainer,j=0;while(!domUtils.isBlockElm(i)){if(i.nodeType==1&&utils.indexOf(["FONT","B","I"],i.tagName)!=-1){var k=a.document.createElement(d[i.tagName]);i.tagName=="FONT"&&(k.style.cssText=(i.getAttribute("size")?"font-size:"+(e[i.getAttribute("size")]||12)+"px":"")+";"+(i.getAttribute("color")?"color:"+i.getAttribute("color"):"")+";"+(i.getAttribute("face")?"font-family:"+i.getAttribute("face"):"")+";"+i.style.cssText);while(i.firstChild)k.appendChild(i.firstChild);i.parentNode.insertBefore(k,i),domUtils.remove(i),j||p.setEnd(k,k.childNodes.length).collapse(!0),i=k,j=1}i=i.parentNode}j&&p.select()}}if(h==8){if(browser.gecko)for(var l=0,m,n=domUtils.getElementsByTagName(this.body,"li");m=n[l++];)if(domUtils.isEmptyNode(m)&&!m.previousSibling){var o=m.parentNode;domUtils.remove(m),domUtils.isEmptyNode(o)&&domUtils.remove(o)}var p,i,q,r=this.currentSelectedArr;if(r&&r.length>0){for(var l=0,s;s=r[l++];)s.innerHTML=browser.ie?browser.version<9?"&#65279":"":"<br/>";p=new dom.Range(this.document),p.setStart(r[0],0).setCursor(),b&&(a.undoManger.save(),b=0),browser.webkit&&g.preventDefault();return}p=a.selection.getRange(),i=p.startContainer,domUtils.isWhitespace(i)&&(i=i.parentNode);var t=0;while(i.nodeType==1&&domUtils.isEmptyNode(i)&&dtd.$removeEmpty[i.tagName])t=1,q=i.parentNode,domUtils.remove(i),i=q;if(t&&i.nodeType==1&&domUtils.isEmptyNode(i)){if(browser.ie){var u=p.document.createElement("span");i.appendChild(u),p.setStart(i,0).setCursor(),m=domUtils.findParentByTagName(i,"li",!0);if(m){var v=m.nextSibling;while(v){if(domUtils.isEmptyBlock(v)){m=v,v=v.nextSibling,domUtils.remove(m);continue}break}}}else i.innerHTML="<br/>",p.setStart(i,0).setCursor(!1,!0);setTimeout(function(){browser.ie&&domUtils.remove(u),b&&(a.undoManger.save(),b=0)},0)}else b&&(a.undoManger.save(),b=0)}})},UE.plugins.fiximgclick=function(){var a=this;browser.webkit&&a.addListener("click",function(b,c){if(c.target.tagName=="IMG"){var d=new dom.Range(a.document);d.selectNode(c.target).select()}})},UE.plugins.autolink=function(){var a=0;if(browser.ie)return;var b=this;b.addListener("reset",function(){a=0}),b.addListener("keydown",function(a,c){var d=c.keyCode||c.which;if(d==32||d==13){var e=b.selection.getNative(),f=e.getRangeAt(0).cloneRange(),g,h,i=f.startContainer;while(i.nodeType==1&&f.startOffset>0){i=f.startContainer.childNodes[f.startOffset-1];if(!i)break;f.setStart(i,i.nodeType==1?i.childNodes.length:i.nodeValue.length),f.collapse(!0),i=f.startContainer}do{if(f.startOffset==0){i=f.startContainer.previousSibling;while(i&&i.nodeType==1)i=i.lastChild;if(!i||domUtils.isFillChar(i))break;g=i.nodeValue.length}else i=f.startContainer,g=f.startOffset;f.setStart(i,g-1),h=f.toString().charCodeAt(0)}while(h!=160&&h!=32);if(f.toString().replace(new RegExp(domUtils.fillChar,"g"),"").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){while(f.toString().length){if(/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(f.toString()))break;try{f.setStart(f.startContainer,f.startOffset+1)}catch(j){f.setStart(f.startContainer.nextSibling,0)}}var k=b.document.createElement("a"),l=b.document.createTextNode(" "),m;b.undoManger&&b.undoManger.save(),k.appendChild(f.extractContents()),k.href=k.innerHTML=k.innerHTML.replace(/<[^>]+>/g,""),m=k.getAttribute("href").replace(new RegExp(domUtils.fillChar,"g"),""),m=/^(?:https?:\/\/)/ig.test(m)?m:"http://"+m,k.setAttribute("data_ue_src",m),k.href=m,f.insertNode(k),k.parentNode.insertBefore(l,k.nextSibling),f.setStart(l,0),f.collapse(!0),e.removeAllRanges(),e.addRange(f),b.undoManger&&b.undoManger.save()}}})},UE.plugins.autoheight=function(){function h(){clearTimeout(g),g=setTimeout(function(){a.queryCommandState("source")!=1&&(c||(c=a.document.createElement("span"),c.style.cssText="display:block;width:0;margin:0;padding:0;border:0;clear:both;",c.innerHTML="."),d=c.cloneNode(!0),a.body.appendChild(d),f=Math.max(domUtils.getXY(d).y+d.offsetHeight,a.options.minFrameHeight),f!=e&&(a.setHeight(f),e=f),domUtils.remove(d))},50)}var a=this;a.autoHeightEnabled=a.options.autoHeightEnabled;if(!a.autoHeightEnabled)return;var b,c,d,e=0,f,g;a.addListener("destroy",function(){a.removeListener("contentchange",h),a.removeListener("keyup",h),a.removeListener("mouseup",h)}),a.enableAutoHeight=function(){if(!a.autoHeightEnabled)return;var c=a.document;a.autoHeightEnabled=!0,b=c.body.style.overflowY,c.body.style.overflowY="hidden",a.addListener("contentchange",h),a.addListener("keyup",h),a.addListener("mouseup",h),setTimeout(function(){h()},browser.gecko?100:0),a.fireEvent("autoheightchanged",a.autoHeightEnabled)},a.disableAutoHeight=function(){a.body.style.overflowY=b||"",a.removeListener("contentchange",h),a.removeListener("keyup",h),a.removeListener("mouseup",h),a.autoHeightEnabled=!1,a.fireEvent("autoheightchanged",a.autoHeightEnabled)},a.addListener("ready",function(){a.enableAutoHeight();var b;domUtils.on(browser.ie?a.body:a.document,browser.webkit?"dragover":"drop",function(){clearTimeout(b),b=setTimeout(function(){h()},100)})})},UE.plugins.autofloat=function(){function d(b){if(!b.ui)throw alert("autofloat\u63d2\u4ef6\u529f\u80fd\u4f9d\u8d56\u4e8eUEditor UI\nautofloat\u5b9a\u4e49\u4f4d\u7f6e: _src/plugins/autofloat.js"),{name:"\u672a\u5305\u542bUI\u6587\u4ef6",message:"autofloat\u529f\u80fd\u4f9d\u8d56\u4e8eUEditor UI\u3002autofloat\u5b9a\u4e49\u4f4d\u7f6e: _src/plugins/autofloat.js"};return a=UE.ui.uiUtils,1}function e(){var a=document.body.style;a.backgroundImage='url("about:blank")',a.backgroundAttachment="fixed"}function n(){var a=domUtils.getXY(j),d=domUtils.getComputedStyle(j,"position"),e=domUtils.getComputedStyle(j,"left");j.style.width=j.offsetWidth+"px",j.style.zIndex=g.options.zIndex*1+1,j.parentNode.insertBefore(i,j),b||c?(j.style.position!="absolute"&&(j.style.position="absolute"),j.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-k+"px"):(browser.ie7Compat&&m&&(m=!1,j.style.left=l(j).left-document.documentElement.getBoundingClientRect().left+2+"px"),j.style.position!="fixed"&&(j.style.position="fixed",j.style.top="0",(d=="absolute"||d=="relative")&&parseFloat(e)&&(j.style.left=a.x+"px")))}function o(){m=!0,i.parentNode&&i.parentNode.removeChild(i),j.style.cssText=h}function p(){var a=l(g.container);a.top<0&&a.bottom-j.offsetHeight>0?n():o()}var a,b=browser.ie&&browser.version<=6,c=browser.quirks,f=this.options.autoFloatEnabled;if(!f)return;var g=this,h,i=document.createElement("div"),j,k,l,m=!0,q=utils.defer(function(){p()},browser.ie?200:100,!0);g.addListener("destroy",function(){domUtils.un(window,["scroll","resize"],p),g.removeListener("keydown",q)}),g.addListener("ready",function(){d(g)&&(l=a.getClientRect,j=g.ui.getDom("toolbarbox"),k=l(j).top,h=j.style.cssText,i.style.height=j.offsetHeight+"px",b&&e(),g.addListener("autoheightchanged",function(a,b){b?(domUtils.on(window,["scroll","resize"],p),g.addListener("keydown",q)):(domUtils.un(window,["scroll","resize"],p),g.removeListener("keydown",q))}),g.addListener("beforefullscreenchange",function(a,b){b&&o()}),g.addListener("fullscreenchanged",function(a,b){b||p()}),g.addListener("sourcemodechanged",function(a,b){setTimeout(function(){p()})}))})},UE.plugins.highlight=function(){function b(){var b=a.document.getElementById(SyntaxHighlighter.getHighlighterDivId());if(b){var c=b.getElementsByTagName("td");for(var d=0,e,f;e=c[0].childNodes[d];d++)f=c[1].firstChild.childNodes[d],f.style.height=e.style.height=f.offsetHeight+"px"}}function c(){for(var c=0,d,e=domUtils.getElementsByTagName(a.document,"pre");d=e[c++];)if(d.className.indexOf("brush")>-1){var f=document.createElement("pre"),g,h;f.className=d.className,f.style.display="none",f.appendChild(document.createTextNode(d[browser.ie?"innerText":"textContent"])),document.body.appendChild(f);try{g=SyntaxHighlighter.highlight(f,null,!0)}catch(i){domUtils.remove(f);return}h=a.document.createElement("div"),h.innerHTML=g,h.firstChild.setAttribute("highlighter",f.className),d.parentNode.insertBefore(h.firstChild,d),domUtils.remove(f),domUtils.remove(d),b()}}var a=this;a.commands.highlightcode={execCommand:function(c,d,e){if(d&&e){var f=document.createElement("pre");f.className="brush: "+e+";toolbar:false;",f.style.display="",f.appendChild(document.createTextNode(d)),document.body.appendChild(f),a.queryCommandState("highlightcode")&&a.execCommand("highlightcode"),a.execCommand("inserthtml",SyntaxHighlighter.highlight(f,null,!0));var g=a.document.getElementById(SyntaxHighlighter.getHighlighterDivId());g.setAttribute("highlighter",f.className),domUtils.remove(f),b()}else{var h=this.selection.getRange(),i=domUtils.findParentByTagName(h.startContainer,"table",!0),j=domUtils.findParentByTagName(h.endContainer,"table",!0),k;if(i&&j&&i===j&&i.parentNode.className.indexOf("syntaxhighlighter")>-1){k=i.parentNode;if(domUtils.isBody(k.parentNode)){var l=a.document.createElement("p");l.innerHTML=browser.ie?"":"<br/>",a.body.insertBefore(l,k),h.setStart(l,0)}else h.setStartBefore(k);h.setCursor(),domUtils.remove(k)}}},queryCommandState:function(){var a=this.selection.getRange(),b,c;return a.adjustmentBoundary(),b=domUtils.findParent(a.startContainer,function(a){return a.nodeType==1&&a.tagName=="DIV"&&domUtils.hasClass(a,"syntaxhighlighter")},!0),c=domUtils.findParent(a.endContainer,function(a){return a.nodeType==1&&a.tagName=="DIV"&&domUtils.hasClass(a,"syntaxhighlighter")},!0),b&&c&&b==c?1:0}},a.addListener("beforeselectionchange",function(){a.highlight=a.queryCommandState("highlightcode")}),a.addListener("afterselectionchange",function(){a.highlight=0}),a.addListener("ready",function(){if(typeof XRegExp=="undefined"){var b={id:"syntaxhighlighter_js",src:a.options.highlightJsUrl,tag:"script",type:"text/javascript",defer:"defer"};utils.loadFile(document,b,function(){c()})}if(!a.document.getElementById("syntaxhighlighter_css")){var b={id:"syntaxhighlighter_css",tag:"link",rel:"stylesheet",type:"text/css",href:a.options.highlightCssUrl};utils.loadFile(a.document,b)}}),a.addListener("beforegetcontent",function(b,c){for(var d=0,e,f=domUtils.getElementsByTagName(a.body,"div");e=f[d++];)if(e.className=="container"){var g=e.parentNode;while(g){if(g.tagName=="DIV"&&/highlighter/.test(g.id))break;g=g.parentNode}if(!g)return;var h=a.document.createElement("pre");for(var i=[],j=0,k;k=e.childNodes[j++];)i.push(k[browser.ie?"innerText":"textContent"]);h.appendChild(a.document.createTextNode(i.join("\n"))),h.className=g.getAttribute("highlighter"),g.parentNode.insertBefore(h,g),domUtils.remove(g)}}),a.addListener("aftergetcontent",function(a,b){c()}),a.addListener("aftersetcontent",function(){c()}),a.addListener("fullscreenchanged",function(){var b=domUtils.getElementsByTagName(a.document,"div");for(var c=0,d;d=b[c++];)if(/^highlighter/.test(d.id)){var e=d.getElementsByTagName("td");for(var f=0,g,h;g=e[0].childNodes[f];f++)h=e[1].firstChild.childNodes[f],h.style.height=g.style.height=h.offsetHeight+"px"}})},UE.plugins.serialize=function(){function c(a){return/pt/.test(a)?a.replace(/([\d.]+)pt/g,function(a){return Math.round(parseFloat(a)*96/72)+"px"}):a}function k(a){var b;if(a&&a.tag=="p")if(a.attributes["class"]=="MsoListParagraph"||/mso-list/.test(a.attributes.style))b=1;else{var c=a.children[0];c&&c.tag=="span"&&/Wingdings/i.test(c.attributes.style)&&(b=1)}return b}function r(a,b){if(a.type=="element"&&!a.children.length&&dtd.$removeEmpty[a.tag]&&a.tag!="a")return{type:"fragment",children:[]};var c=[0,10,12,16,18,24,32,48],e,f=utils.indexOf;switch(a.tag){case"img":if(a.attributes.src&&/^data:/.test(a.attributes.src))return{type:"fragment",children:[]};if(a.attributes.src&&/^(?:file)/.test(a.attributes.src)){if(!/(gif|bmp|png|jpg|jpeg)$/.test(a.attributes.src))return{type:"fragment",children:[]};a.attributes.word_img=a.attributes.src,a.attributes.src=d.options.UEDITOR_HOME_URL+"themes/default/images/spacer.gif";var g=parseInt(a.attributes.width)<128||parseInt(a.attributes.height)<43;a.attributes.style="background:url("+d.options.UEDITOR_HOME_URL+"themes/default/images/"+(g?"word.gif":"localimage.png")+") no-repeat center center;border:1px solid #ddd",b&&(b.flag=1)}browser.ie&&browser.version<7&&d.options.relativePath&&(a.attributes.orgSrc=a.attributes.src),a.attributes.data_ue_src=a.attributes.data_ue_src||a.attributes.src;break;case"li":var h=a.children[0];if(!h||h.type!="element"||h.tag!="p"&&dtd.p[h.tag]){var i={type:"element",tag:"p",attributes:{},parent:a};i.children=h?a.children:[browser.ie?{type:"text",data:domUtils.fillChar,parent:i}:{type:"element",tag:"br",attributes:{},closed:!0,children:[],parent:i}],a.children=[i]}break;case"table":case"td":s(a);break;case"a":a.attributes.anchorname&&(a.tag="img",a.attributes={"class":"anchorclass",anchorname:a.attributes.name},a.closed=1),a.attributes.href&&(a.attributes.data_ue_src=a.attributes.href);break;case"b":a.tag=a.name="strong";break;case"i":a.tag=a.name="em";break;case"u":a.tag=a.name="span",a.attributes.style=(a.attributes.style||"")+";text-decoration:underline;";break;case"s":case"del":a.tag=a.name="span"
,a.attributes.style=(a.attributes.style||"")+";text-decoration:line-through;",a.children.length==1&&(h=a.children[0],h.tag==a.tag&&(a.attributes.style+=";"+h.attributes.style,a.children=h.children));break;case"span":if(/mso-list/.test(a.attributes.style)){if(q!="end"){var j=a.children[0],r;while(j.type=="element")j=j.children[0];for(r in n)if(n[r].test(j.data)){o="ul",p=r;break}if(!o)for(r in m)if(m[r].test(j.data.replace(/\.$/,""))){o="ol",p=r;break}q?(j.data==q?(o!="ul"&&(p=""),o="ul"):(o!="ol"&&(p=""),o="ol"),q="end"):q=j.data;if(o){var t=a;while(t&&t.tag!="ul"&&t.tag!="ol")t=t.parent;t&&(t.tag=o,t.attributes.style="list-style-type:"+p)}}a={type:"fragment",children:[]};break}var u=a.attributes.style;u&&(u=u.match(/(?:\b(?:color|font-size|background(-color)?|font-family|text-decoration)\b\s*:\s*(&[^;]+;|[^;])+(?=;)?)/gi),u&&(a.attributes.style=u.join(";"),a.attributes.style||delete a.attributes.style));if(browser.gecko&&browser.version<=10902&&a.parent){var v=a.parent;v.tag=="span"&&v.attributes&&v.attributes.style&&(a.attributes.style=v.attributes.style+";"+a.attributes.style)}utils.isEmptyObject(a.attributes)&&(a.type="fragment");break;case"font":a.tag=a.name="span",e=a.attributes,a.attributes={style:(e.size?"font-size:"+(c[e.size]||12)+"px":"")+";"+(e.color?"color:"+e.color:"")+";"+(e.face?"font-family:"+e.face:"")+";"+(e.style||"")};while(a.parent.tag==a.tag&&a.parent.children.length==1)a.attributes.style&&(a.parent.attributes.style?a.parent.attributes.style+=";"+a.attributes.style:a.parent.attributes.style=a.attributes.style),a.parent.children=a.children,a=a.parent;break;case"p":a.attributes.align&&(a.attributes.style=(a.attributes.style||"")+";text-align:"+a.attributes.align+";",delete a.attributes.align);if(k(a)){if(!l){var w={type:"element",tag:"ul",attributes:{},children:[]},x=f(a.parent.children,a);a.parent.children[x]=w,w.parent=a.parent,w.children[0]=a,a.parent=w;for(;;){a=w.parent.children[x+1];if(!k(a))break;w.children[w.children.length]=a,a.parent=w,w.parent.children.splice(x+1,1)}return w}a.tag=a.name="li";if(browser.webkit){var y=a.children[0];while(y&&y.type=="element")y=y.children[0];y&&(y.parent.attributes.style=(y.parent.attributes.style||"")+";mso-list:10")}delete a.attributes["class"],delete a.attributes.style}}return a}function s(b){if(a&&b.attributes.style){var c=b.attributes.style;b.attributes.style=c.replace(/;\s*/g,";"),b.attributes.style=b.attributes.style.replace(/^\s*|\s*$/,"")}}function t(b){switch(b.tag){case"table":!b.attributes.style&&delete b.attributes.style,a&&b.attributes.style&&s(b);break;case"td":case"th":if(/display\s*:\s*none/i.test(b.attributes.style))return{type:"fragment",children:[]};if(a&&!b.children.length){var c={type:"text",data:domUtils.fillChar,parent:b};b.children[0]=c}a&&b.attributes.style&&s(b);break;case"img":b.attributes.anchorname?(b.tag="a",b.attributes={name:b.attributes.anchorname,anchorname:1},b.closed=null):b.attributes.data_ue_src&&(b.attributes.src=b.attributes.data_ue_src,delete b.attributes.data_ue_src);break;case"a":b.attributes.data_ue_src&&(b.attributes.href=b.attributes.data_ue_src,delete b.attributes.data_ue_src)}return b}function u(a,b,c){if(!a.children||!a.children.length)return a;var d=a.children;for(var e=0;e<d.length;e++){var f=b(d[e],c);if(f.type=="fragment"){var g=[e,1];g.push.apply(g,f.children),d.splice.apply(d,g),d.length||(a={type:"fragment",children:[]}),e--}else d[e]=f}return a}function v(a){this.rules=a}var a=browser.ie,b=browser.version,d=this,e=dtd.$empty,f=function(){function j(e,h){var i,j=0,k,l;c.exec("");while(i=c.exec(e)){var m=i.index;if(m>j){var n=e.slice(j,m);l?l.push(n):h.onText(n)}j=c.lastIndex;if(k=i[1]){k=k.toLowerCase(),l&&k==l._tag_name&&(h.onCDATA(l.join("")),l=null);if(!l){h.onTagClose(k);continue}}if(l){l.push(i[0]);continue}if(k=i[3]){if(/="/.test(k))continue;k=k.toLowerCase();var o=i[4],p,q={},r=o&&o.slice(-1)=="/";if(o){d.exec("");while(p=d.exec(o)){var s=p[1].toLowerCase(),t=p[2]||p[3]||p[4]||"";!t&&f[s]&&(t=s),s=="style"&&a&&b<=6&&(t=t.replace(/(?!;)\s*([\w-]+):/g,function(a,b){return b.toLowerCase()+":"})),t&&(q[s]=t.replace(/:\s*/g,":"))}}h.onTagOpen(k,q,r),!l&&g[k]&&(l=[],l._tag_name=k);continue}(k=i[2])&&h.onComment(k)}e.length>j&&h.onText(e.slice(j,e.length))}var c=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,d=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,f={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1},g={script:1,style:1},h={li:{$:"ul",ul:1,ol:1},dd:{$:"dl",dl:1},dt:{$:"dl",dl:1},option:{$:"select",select:1},td:{$:"tr",tr:1},th:{$:"tr",tr:1},tr:{$:"tbody",tbody:1,thead:1,tfoot:1,table:1},tbody:{$:"table",table:1,colgroup:1},thead:{$:"table",table:1},tfoot:{$:"table",table:1},col:{$:"colgroup",colgroup:1}},i={table:"td",tbody:"td",thead:"td",tfoot:"td",tr:"td",colgroup:"col",ul:"li",ol:"li",dl:"dd",select:"option"};return function(a,b){function f(a){a.parent=d,d.children.push(a)}function g(a,c){var e=a;if(h[e.tag]){while(h[d.tag]&&h[d.tag][e.tag])d=d.parent;d.tag==e.tag&&(d=d.parent);while(h[e.tag]){if(h[e.tag][d.tag])break;e=e.parent={type:"element",tag:h[e.tag].$,attributes:{},children:[e]}}}if(b)while(dtd[e.tag]&&!(d.tag=="span"?utils.extend(dtd.strong,{a:1,A:1}):dtd[d.tag]||dtd.div)[e.tag]){if(k(d))continue;if(!d.parent)break;d=d.parent}return e.parent=d,d.children.push(e),c&&(d=a),a.attributes.style&&(a.attributes.style=a.attributes.style.toLowerCase()),a}function k(a){var b;return!a.children.length&&(b=i[a.tag])?(g({type:"element",tag:b,attributes:{},children:[]},!0),!0):!1}var c={type:"fragment",parent:null,children:[]},d=c;j(a,{onText:function(a){while(!(dtd[d.tag]||dtd.div)["#"]){if(k(d))continue;d=d.parent}f({type:"text",data:a})},onComment:function(a){f({type:"comment",data:a})},onCDATA:function(a){while(!(dtd[d.tag]||dtd.div)["#"]){if(k(d))continue;d=d.parent}f({type:"cdata",data:a})},onTagOpen:function(a,b,c){c=c||e[a],g({type:"element",tag:a,attributes:b,closed:c,children:[]},!c)},onTagClose:function(a){var b=d;while(b&&a!=b.tag)b=b.parent;if(b){for(var c=d;c!==b.parent;c=c.parent)k(c);d=b.parent}else!dtd.$removeEmpty[a]&&!dtd.$removeEmptyBlock[a]&&a!="embed"&&(b={type:"element",tag:a,attributes:{},children:[]},g(b,!0),k(b),d=b.parent)}});while(d!==c)k(d),d=d.parent;return c}}(),g=function(){function b(b){return a[b]}var a={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return function(a){return a+="",a?a.replace(/[<>"']/g,b):""}}(),h=function(){function a(a,b){var c=a.children,d=[];for(var e=0,f;f=c[e];e++)d.push(h(f,b));return d.join("")}function b(a){var b=[];for(var d in a){var e=a[d];d=="style"&&(e=c(e),/rgba?\s*\([^)]*\)/.test(e)&&(e=e.replace(/rgba?\s*\(([^)]*)\)/g,function(a){return utils.fixColor("color",a)})),a[d]=utils.optCss(e.replace(/windowtext/g,"#000"))),b.push(d+'="'+g(a[d])+'"')}return b.join(" ")}function d(a,b){return b?a.data.replace(/&nbsp;/g," "):g(a.data).replace(/ /g,"&nbsp;")}function i(c,d){var g=c.tag;if(d&&g=="td")i||(i=""),i+=a(c,d)+"&nbsp;&nbsp;&nbsp;";else{var h=b(c.attributes),i="<"+(d&&f[g]?f[g]:g)+(h?" "+h:"")+(e[g]?" />":">");e[g]||(browser.ie&&g=="p"&&!c.children.length&&(i+="&nbsp;"),i+=a(c,d),i+="</"+(d&&f[g]?f[g]:g)+">")}return i}var f={div:"p",li:"p",tr:"p",br:"br",p:"p"};return function(b,c){return b.type=="fragment"?a(b,c):b.type=="element"?i(b,c):b.type=="text"||b.type=="cdata"?d(b,dtd.$notTransContent[b.parent.tag]):b.type=="comment"?"<!--"+b.data+"-->":""}}(),i=function(){function a(a){var b=new RegExp(/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<v:)/ig);return b.test(a)}function b(a){return a=a.replace(/([\d.]+)([\w]+)?/g,function(a,b,c){return(Math.round(parseFloat(b))||1)+(c||"px")}),a}function d(a){return a=a.replace(/<!--\s*EndFragment\s*-->[\s\S]*$/,"").replace(/^(\r\n|\n|\r)|(\r\n|\n|\r)$/ig,"").replace(/^\s*(&nbsp;)+/ig,"").replace(/(&nbsp;|<br[^>]*>)+\s*$/ig,"").replace(/<!--[\s\S]*?-->/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(a){var b=a.match(/width:([ \d.]*p[tx])/i)[1],d=a.match(/height:([ \d.]*p[tx])/i)[1],e=a.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+c(b)+'" height="'+c(d)+'" src="'+e+'" />'}).replace(/v:\w+=["']?[^'"]+["']?/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/(lang)\s*=\s*([\'\"]?)[\w-]+\2/ig,"").replace(/<font[^>]*>\s*<\/font>/gi,"").replace(/class\s*=\s*["']?(?:(?:MsoTableGrid)|(?:MsoNormal(Table)?))\s*["']?/gi,""),a=a.replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(a,c,d,e){var f=[],g=0,h=e.replace(/^\s+|\s+$/,"").replace(/&quot;/gi,"'").split(/;\s*/g);for(var g=0;g<h.length;g++){var i=h[g],j,k,l=i.split(":");if(l.length==2){j=l[0].toLowerCase(),k=l[1].toLowerCase();switch(j){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":/<table/.test(c)||(f[g]=j.replace(/^mso-|-alt$/g,"")+":"+b(k));continue;case"horiz-align":f[g]="text-align:"+k;continue;case"vert-align":f[g]="vertical-align:"+k;continue;case"font-color":case"mso-foreground":f[g]="color:"+k;continue;case"mso-background":case"mso-highlight":f[g]="background:"+k;continue;case"mso-default-height":f[g]="min-height:"+b(k);continue;case"mso-default-width":f[g]="min-width:"+b(k);continue;case"mso-padding-between-alt":f[g]="border-collapse:separate;border-spacing:"+b(k);continue;case"text-line-through":if(k=="single"||k=="double")f[g]="text-decoration:line-through";continue;case"mso-zero-height":k=="yes"&&(f[g]="display:none");continue;case"margin":if(!/[1-9]/.test(l[1]))continue}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(j)&&!/mso\-list/.test(j))continue;f[g]=j+":"+l[1]}}return g>0?c+' style="'+f.join(";")+'"':c}),a=a.replace(/([ ]+)<\/span>/ig,function(a,b){return(new Array(b.length+1)).join("&nbsp;")+"</span>"}),a}return function(b){return l=null,o="",p="",q="",a(b)&&(b=d(b)),b.replace(/>[ \t\r\n]*</g,"><")}}(),j={text:"#text",comment:"#comment",cdata:"#cdata-section",fragment:"#document-fragment"},l,m={decimal:/\d+/,"lower-roman":/^m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$/,"upper-roman":/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/,"lower-alpha":/^\(?[a-z]+\)?$/,"upper-alpha":/^\(?[A-Z]+\)?$/},n={disc:/^[l\u00B7\u2002]/,circle:/^[\u006F\u00D8]/,square:/^[\u006E\u25C6]/},o="",p="",q;v.prototype={rules:null,filter:function(a,b,c){function f(a,b){a.name=a.type=="element"?a.tag:j[a.type];if(b==null)return u(a,f,a);if(e&&e[a.name])return c&&(c.flag=1),{type:"fragment",children:[]};if(d&&a.type=="element")if(b.type=="fragment"?d[a.name]:d[a.name]&&d[b.name][a.name]){var g;if(g=d[a.name].$){var h=a.attributes,i={};for(var k in g)h[k]&&(i[k]=h[k]);a.attributes=i}}else c&&(c.flag=1),a.type="fragment",a.name=b.name;return(e||d)&&u(a,f,a),a}b=b||this.rules;var d=b&&b.whiteList,e=b&&b.blackList;return f(a,null)},transformInput:function(a,b){function c(a){a=r(a,b);if(a.tag=="ol"||a.tag=="ul")l=1;a=u(a,c,a);if(a.tag=="ol"||a.tag=="ul")l=0,o="",p="",q="";return a.type=="text"&&a.data.replace(/\s/g,"")==d.options.pageBreakTag&&(a.type="element",a.name=a.tag="hr",delete a.data,a.attributes={"class":"pagebreak",noshade:"noshade",size:"5",unselectable:"on",style:"moz-user-select:none;-khtml-user-select: none;"},a.children=[]),a.type=="text"&&!dtd.$notTransContent[a.parent.tag]&&(a.data=a.data.replace(/[\r\t\n]*/g,"")),a}return c(a)},transformOutput:function(a){function b(a){a.tag=="hr"&&a.attributes["class"]=="pagebreak"&&(delete a.tag,a.type="text",a.data=d.options.pageBreakTag,delete a.children),a=t(a);if(a.tag=="ol"||a.tag=="ul")l=1;a=u(a,b,a);if(a.tag=="ol"||a.tag=="ul")l=0;return a}return b(a)},toHTML:h,parseHTML:f,word:i},d.serialize=new v(d.options.serialize),UE.serialize=new v({})},UE.plugins.video=function(){function c(b,c,d,e,f,g){return f?'<embed type="application/x-shockwave-flash" class="edui-faked-video" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+b+'" width="'+c+'" height="'+d+'" align="'+e+'"'+(e!="none"?' style= "'+(e=="center"?"display:block;":" float: "+e)+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >':(g?"<p "+(e!="none"?e=="center"?' style="text-align:center;" ':' style="float:"'+e:"")+">":"")+'<img align="'+e+'" width="'+c+'" height="'+d+'" _url="'+b+'" class="edui-faked-video"'+' src="'+a.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" style="background:url('+a.options.UEDITOR_HOME_URL+'themes/default/images/videologo.gif) no-repeat center center; border:1px solid gray;" />'+(g?"</p>":"")}function d(b){var d,e=domUtils.getElementsByTagName(a.document,b?"img":"embed");for(var f=0,g;g=e[f++];){if(g.className!="edui-faked-video")continue;d=a.document.createElement("div");var h=g.style.cssFloat;d.innerHTML=c(b?g.getAttribute("_url"):g.getAttribute("src"),g.width,g.height,h||g.getAttribute("align"),b),g.parentNode.replaceChild(d.firstChild,g)}}var a=this,b;a.addListener("beforegetcontent",function(){d(!0)}),a.addListener("aftersetcontent",function(){d(!1)}),a.addListener("aftergetcontent",function(b){if(b=="aftergetcontent"&&a.queryCommandState("source"))return;d(!1)}),a.commands.insertvideo={execCommand:function(b,d){d=utils.isArray(d)?d:[d];var e=[];for(var f=0,g,h=d.length;f<h;f++)g=d[f],e.push(c(g.url,g.width||420,g.height||280,g.align||"none",!1,!0));a.execCommand("inserthtml",e.join(""))},queryCommandState:function(){var b=a.selection.getRange().getClosedNode(),c=b&&b.className=="edui-faked-video";return this.highlight?-1:c?1:0}}},UE.plugins.table=function(){function g(a){var b=a.parentNode.cells;for(var c=0,d;d=b[c];c++)if(d===a)return c}function h(b,c){var d=b.ownerDocument.createElement("p");domUtils.fillNode(a.document,d);var e=b.parentNode;e&&e.getAttribute("dropdrag")&&(b=e),b.parentNode.insertBefore(d,b),domUtils.remove(b),c.setStart(d,0).setCursor()}function i(a){return a.style.display=="none"}function j(a){var b=0;for(var c=0,d;d=a[c++];)i(d)||b++;return b}function k(){a.currentSelectedArr=[],d=null}function l(a,b){if(f(b))return;if(f(a)){a.innerHTML=b.innerHTML;return}var c=a.lastChild;(c.nodeType!=1||c.tagName!="BR")&&a.appendChild(a.ownerDocument.createElement("br"));while(c=b.firstChild)a.appendChild(c)}function m(a,b){var c=a.parentNode,d=b.parentNode,e=c.rowIndex,f=d.rowIndex,h=c.parentNode.parentNode.rows,j=h.length,k=h[0].cells.length,l=g(a),m=g(b);if(a==b)return{beginRowIndex:e,beginCellIndex:l,endRowIndex:e+a.rowSpan-1,endCellIndex:m+a.colSpan-1};var n=Math.min(e,f),o=Math.min(l,m),p=Math.max(e+a.rowSpan-1,f+b.rowSpan-1),q=Math.max(l+a.colSpan-1,m+b.colSpan-1);for(;;){var r=n,s=o,t=p,u=q;if(n>0)for(y=o;y<=q;){var v=h[n].cells[y];i(v)&&(n=v.getAttribute("rootRowIndex"),v=h[v.getAttribute("rootRowIndex")].cells[v.getAttribute("rootCellIndex")]),y=g(v)+(v.colSpan||1)}if(o>0)for(var w=n;w<=p;){var x=h[w].cells[o];i(x)&&(o=x.getAttribute("rootCellIndex"),x=h[x.getAttribute("rootRowIndex")].cells[x.getAttribute("rootCellIndex")]),w=x.parentNode.rowIndex+(x.rowSpan||1)}if(p<j)for(var y=o;y<=q;){var z=h[p].cells[y];i(z)&&(z=h[z.getAttribute("rootRowIndex")].cells[z.getAttribute("rootCellIndex")]),p=z.parentNode.rowIndex+z.rowSpan-1,y=g(z)+(z.colSpan||1)}if(q<k)for(w=n;w<=p;){var A=h[w].cells[q];i(A)&&(A=h[A.getAttribute("rootRowIndex")].cells[A.getAttribute("rootCellIndex")]),q=g(A)+A.colSpan-1,w=A.parentNode.rowIndex+(A.rowSpan||1)}if(s==o&&u==q&&t==p&&r==n)break}return{beginRowIndex:n,beginCellIndex:o,endRowIndex:p,endCellIndex:q}}function n(b,e){d=e.target||e.srcElement;if(a.queryCommandState("highlightcode")||domUtils.findParent(d,function(a){return a.tagName=="DIV"&&/highlighter/.test(a.id)}))return;if(e.button==2)return;a.document.body.style.webkitUserSelect="",c(a.currentSelectedArr),domUtils.clearSelectedArr(a.currentSelectedArr),d.tagName!=="TD"&&(d=domUtils.findParentByTagName(d,"td")||d),d.tagName=="TD"?a.addListener("mouseover",function(b,c){var d=c.target||c.srcElement;o.call(a,d),c.preventDefault?c.preventDefault():c.returnValue=!1}):k()}function o(b){if(d&&b.tagName=="TD"){a.document.body.style.webkitUserSelect="none";var c=b.parentNode.parentNode.parentNode;a.selection.getNative()[browser.ie?"empty":"removeAllRanges"]();var e=m(d,b);p(c,e)}}function p(b,d){var e=b.rows;c(a.currentSelectedArr);for(var f=d.beginRowIndex;f<=d.endRowIndex;f++)for(var g=d.beginCellIndex;g<=d.endCellIndex;g++){var h=e[f].cells[g];h.className=a.options.selectedTdClass,a.currentSelectedArr.push(h)}}function q(a){var b=a.getElementsByTagName("td"),c,d,e=a.rows;for(var f=0,h;h=b[f++];){if(!i(h)){c=h.parentNode.rowIndex,d=g(h);for(var j=0;j<h.rowSpan;j++){var k=j==0?1:0;for(;k<h.colSpan;k++){var l=e[c+j].children[d+k];l.setAttribute("rootRowIndex",c),l.setAttribute("rootCellIndex",d)}}}i(h)||domUtils.removeAttributes(h,["rootRowIndex","rootCellIndex"]),h.colSpan&&h.colSpan==1&&h.removeAttribute("colSpan"),h.rowSpan&&h.rowSpan==1&&h.removeAttribute("rowSpan");var m;!i(h)&&(m=h.style.width)&&/%/.test(m)&&(h.style.width=Math.floor(100/h.parentNode.cells.length)+"%")}}var a=this,b=domUtils.keys,c=domUtils.clearSelectedArr,d,e,f=domUtils.isEmptyNode;a.currentSelectedArr=[],a.addListener("mousedown",n),a.addListener("keydown",function(d,e){var f=e.keyCode||e.which;!b[f]&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&!e.altKey&&c(a.currentSelectedArr)}),a.addListener("mouseup",function(){d=null,a.removeListener("mouseover",n);var b=a.currentSelectedArr[0];if(b){a.document.body.style.webkitUserSelect="";var c=new dom.Range(a.document);f(b)?c.setStart(a.currentSelectedArr[0],0).setCursor():c.selectNodeContents(a.currentSelectedArr[0]).select()}else{var c=a.selection.getRange().shrinkBoundary();if(!c.collapsed){var e=domUtils.findParentByTagName(c.startContainer,"td",!0),g=domUtils.findParentByTagName(c.endContainer,"td",!0);(e&&!g||!e&&g||e&&g&&e!==g)&&c.collapse(!0).select(!0)}}}),a.commands.inserttable={queryCommandState:function(){if(this.highlight)return-1;var b=this.selection.getRange();return domUtils.findParentByTagName(b.startContainer,"table",!0)||domUtils.findParentByTagName(b.endContainer,"table",!0)||a.currentSelectedArr.length>0?-1:0},execCommand:function(b,c){c=c||{numRows:5,numCols:5};var d=['<table _innerCreateTable = "true" '];(c.cellSpacing&&c.cellSpacing!="0"||c.cellPadding&&c.cellPadding!="0")&&d.push(' style="border-collapse:separate;" '),c.cellSpacing&&c.cellSpacing!="0"&&d.push(' cellSpacing="'+c.cellSpacing+'" '),c.cellPadding&&c.cellPadding!="0"&&d.push(' cellPadding="'+c.cellPadding+'" '),d.push(' width="'+(c.width||100)+(typeof c.widthUnit=="undefined"?"%":c.widthUnit)+'" '),c.height&&d.push(' height="'+c.height+(typeof c.heightUnit=="undefined"?"%":c.heightUnit)+'" '),c.align&&d.push(' align="'+c.align+'" '),d.push(' border="'+(c.border||1)+'" borderColor="'+(c.borderColor||"#000000")+'"'),c.borderType=="1"&&d.push(' borderType="1" '),c.bgColor&&d.push(' bgColor="'+c.bgColor+'"'),d.push(" ><tbody>"),c.width=Math.floor((c.width||"100")/c.numCols);for(var e=0;e<c.numRows;e++){d.push("<tr>");for(var f=0;f<c.numCols;f++)d.push('<td  style="width:'+c.width+(typeof c.widthUnit=="undefined"?"%":c.widthUnit)+";"+(c.borderType=="1"?"border:"+c.border+"px solid "+(c.borderColor||"#000000"):"")+'">'+(browser.ie?domUtils.fillChar:"<br/>")+"</td>");d.push("</tr>")}a.execCommand("insertHtml",d.join("")+"</tbody></table>"),k();if(c.align){var g=a.selection.getRange(),h=g.createBookmark(),i=g.startContainer;while(i&&!domUtils.isBody(i)){if(domUtils.isBlockElm(i)){i.style.clear="both",g.moveToBookmark(h).select();break}i=i.parentNode}}}},a.commands.edittable={queryCommandState:function(){var b=this.selection.getRange();return this.highlight?-1:domUtils.findParentByTagName(b.startContainer,"table",!0)||a.currentSelectedArr.length>0?0:-1},execCommand:function(b,c){var d=a.selection.getStart(),e=domUtils.findParentByTagName(d,"table",!0);if(e){e.style.cssText=e.style.cssText.replace(/border[^;]+/gi,""),e.style.borderCollapse=c.cellSpacing&&c.cellSpacing!="0"||c.cellPadding&&c.cellPadding!="0"?"separate":"collapse",c.cellSpacing&&c.cellSpacing!="0"?e.setAttribute("cellSpacing",c.cellSpacing):e.removeAttribute("cellSpacing"),c.cellPadding&&c.cellPadding!="0"?e.setAttribute("cellPadding",c.cellPadding):e.removeAttribute("cellPadding"),c.height&&e.setAttribute("height",c.height+c.heightUnit),c.align&&e.setAttribute("align",c.align),c.width&&e.setAttribute("width",c.width+c.widthUnit),c.bgColor&&e.setAttribute("bgColor",c.bgColor),c.borderColor&&e.setAttribute("borderColor",c.borderColor),c.border&&e.setAttribute("border",c.border);if(c.borderType=="1"){for(var f=0,g,h=e.getElementsByTagName("td");g=h[f++];)g.style.border=c.border+"px solid "+(c.borderColor||"#000000");e.setAttribute("borderType","1")}else{for(var f=0,g,h=e.getElementsByTagName("td");g=h[f++];)browser.ie?g.style.cssText=g.style.cssText.replace(/border[^;]+/gi,""):(domUtils.removeStyle(g,"border"),domUtils.removeStyle(g,"border-image"));e.removeAttribute("borderType")}}}},a.commands.edittd={queryCommandState:function(){if(this.highlight)return-1;var b=this.selection.getRange();return domUtils.findParentByTagName(b.startContainer,"table",!0)&&domUtils.findParentByTagName(b.endContainer,"table",!0)||a.currentSelectedArr.length>0?0:-1},execCommand:function(b,c){var d=this.selection.getRange(),e=a.currentSelectedArr.length?a.currentSelectedArr:[domUtils.findParentByTagName(d.startContainer,["td","th"],!0)];for(var f=0,g;g=e[f++];)domUtils.setAttributes(g,{bgColor:c.bgColor,align:c.align,vAlign:c.vAlign})}},a.commands.deletetable={queryCommandState:function(){if(this.highlight)return-1;var b=this.selection.getRange();return domUtils.findParentByTagName(b.startContainer,"table",!0)&&domUtils.findParentByTagName(b.endContainer,"table",!0)||a.currentSelectedArr.length>0?0:-1},execCommand:function(){var b=this.selection.getRange(),c=domUtils.findParentByTagName(a.currentSelectedArr.length>0?a.currentSelectedArr[0]:b.startContainer,"table",!0);h(c,b),k()}},a.commands.addcaption={queryCommandState:function(){if(this.highlight)return-1;var b=this.selection.getRange();return domUtils.findParentByTagName(b.startContainer,"table",!0)&&domUtils.findParentByTagName(b.endContainer,"table",!0)||a.currentSelectedArr.length>0?0:-1},execCommand:function(b,c){var d=this.selection.getRange(),e=domUtils.findParentByTagName(a.currentSelectedArr.length>0?a.currentSelectedArr[0]:d.startContainer,"table",!0);if(c=="on"){var f=e.createCaption();f.innerHTML="\u8bf7\u5728\u6b64\u8f93\u5165\u8868\u683c\u6807\u9898"}else e.removeChild(e.caption)}},a.commands.mergeright={queryCommandState:function(){if(this.highlight)return-1;var a=this.selection.getRange(),b=a.startContainer,c=domUtils.findParentByTagName(b,["td","th"],!0);if(!c||this.currentSelectedArr.length>1)return-1;var d=c.parentNode,e=g(c)+c.colSpan;if(e>=d.cells.length)return-1;var f=d.cells[e];return i(f)?-1:c.rowSpan==f.rowSpan?0:-1},execCommand:function(){var b=this.selection.getRange(),c=b.startContainer,d=domUtils.findParentByTagName(c,["td","th"],!0)||a.currentSelectedArr[0],e=d.parentNode,f=e.parentNode.parentNode.rows,h=e.rowIndex,i=g(d)+d.colSpan,j=f[h].cells[i];for(var k=h;k<h+j.rowSpan;k++)for(var m=i;m<i+j.colSpan;m++){var n=f[k].cells[m];n.setAttribute("rootRowIndex",e.rowIndex),n.setAttribute("rootCellIndex",g(d))}d.colSpan+=j.colSpan||1,l(d,j),j.style.display="none",domUtils.isEmptyBlock(d)?b.setStart(d,0).setCursor():b.selectNodeContents(d).setCursor(!0,!0),browser.ie&&domUtils.removeAttributes(d,["width","height"])}},a.commands.mergedown={queryCommandState:function(){if(this.highlight)return-1;var b=this.selection.getRange(),c=b.startContainer,d=domUtils.findParentByTagName(c,"td",!0);if(!d||j(a.currentSelectedArr)>1)return-1;var e=d.parentNode,f=e.parentNode.parentNode,h=f.rows,k=e.rowIndex+d.rowSpan;if(k>=h.length)return-1;var l=h[k].cells[g(d)];return i(l)?-1:d.colSpan==l.colSpan?0:-1},execCommand:function(){var b=this.selection.getRange(),c=b.startContainer,d=domUtils.findParentByTagName(c,["td","th"],!0)||a.currentSelectedArr[0],e=d.parentNode,f=e.parentNode.parentNode.rows,h=e.rowIndex+d.rowSpan,i=g(d),j=f[h].cells[i];for(var k=h;k<h+j.rowSpan;k++)for(var m=i;m<i+j.colSpan;m++){var n=f[k].cells[m];n.setAttribute("rootRowIndex",e.rowIndex),n.setAttribute("rootCellIndex",g(d))}d.rowSpan+=j.rowSpan||1,l(d,j),j.style.display="none",domUtils.isEmptyBlock(d)?b.setStart(d,0).setCursor():b.selectNodeContents(d).setCursor(!0,!0),browser.ie&&domUtils.removeAttributes(d,["width","height"])}},a.commands.deleterow={queryCommandState:function(){if(this.highlight)return-1;var b=this.selection.getRange(),c=b.startContainer,d=domUtils.findParentByTagName(c,["td","th"],!0);if(!d&&a.currentSelectedArr.length==0)return-1},execCommand:function(){var b=this.selection.getRange(),c=b.startContainer,d=domUtils.findParentByTagName(c,["td","th"],!0),e,f,j,k,l,m;if(d&&a.currentSelectedArr.length==0){var n=(d.rowSpan||1)-1;a.currentSelectedArr.push(d),e=d.parentNode,f=e.parentNode.parentNode,k=f.rows,l=e.rowIndex+1,m=g(d);while(n)a.currentSelectedArr.push(k[l].cells[m]),n--,l++}while(d=a.currentSelectedArr.pop()){if(!domUtils.findParentByTagName(d,"table"))continue;e=d.parentNode,f=e.parentNode.parentNode,j=e.cells,k=f.rows,l=e.rowIndex,m=g(d);for(var o=0;o<j.length;){var p=j[o];if(i(p)){var r=k[p.getAttribute("rootRowIndex")].cells[p.getAttribute("rootCellIndex")];r.rowSpan--,o+=r.colSpan}else if(p.rowSpan==1)o+=p.colSpan;else{var s=k[l+1].cells[o];s.style.display="",s.rowSpan=p.rowSpan-1,s.colSpan=p.colSpan,o+=p.colSpan}}domUtils.remove(e);var t,u,v;if(l==k.length){if(l==0){h(f,b);return}var w=l-1;t=k[w].cells[m],u=i(t)?k[t.getAttribute("rootRowIndex")].cells[t.getAttribute("rootCellIndex")]:t}else v=k[l].cells[m],u=i(v)?k[v.getAttribute("rootRowIndex")].cells[v.getAttribute("rootCellIndex")]:v}b.setStart(u,0).setCursor(),q(f)}},a.commands.deletecol={queryCommandState:function(){if(this.highlight)return-1;var b=this.selection.getRange(),c=b.startContainer,d=domUtils.findParentByTagName(c,["td","th"],!0);if(!d&&a.currentSelectedArr.length==0)return-1},execCommand:function(){var b=this.selection.getRange(),c=b.startContainer,d=domUtils.findParentByTagName(c,["td","th"],!0);if(d&&a.currentSelectedArr.length==0){var e=(d.colSpan||1)-1;a.currentSelectedArr.push(d);while(e){do d=d.nextSibling;while(d.nodeType==3);a.currentSelectedArr.push(d),e--}}while(d=a.currentSelectedArr.pop()){if(!domUtils.findParentByTagName(d,"table"))continue;var f=d.parentNode,j=f.parentNode.parentNode,k=g(d),l=j.rows,m=f.cells,n=f.rowIndex,o;for(var p=0;p<l.length;){var r=l[p].cells[k];if(i(r)){var s=l[r.getAttribute("rootRowIndex")].cells[r.getAttribute("rootCellIndex")];o=s.rowSpan;for(var t=0;t<s.rowSpan;t++){var u=l[p+t].cells[k];domUtils.remove(u)}s.colSpan--,p+=o}else if(r.colSpan==1){o=r.rowSpan;for(var t=p,v=p+r.rowSpan;t<v;t++)domUtils.remove(l[t].cells[k]);p+=o}else{var w=l[p].cells[k+1];w.style.display="",w.rowSpan=r.rowSpan,w.colSpan=r.colSpan-1,p+=r.rowSpan,domUtils.remove(r)}}var x,y,z;if(k==m.length){if(k==0){h(j,b);return}var A=k-1;x=l[n].cells[A],y=i(x)?l[x.getAttribute("rootRowIndex")].cells[x.getAttribute("rootCellIndex")]:x}else z=l[n].cells[k],y=i(z)?l[z.getAttribute("rootRowIndex")].cells[z.getAttribute("rootCellIndex")]:z}b.setStart(y,0).setCursor(),q(j)}},a.commands.splittocells={queryCommandState:function(){if(this.highlight)return-1;var b=this.selection.getRange(),c=b.startContainer,d=domUtils.findParentByTagName(c,["td","th"],!0);return d&&(d.rowSpan>1||d.colSpan>1)&&(!a.currentSelectedArr.length||j(a.currentSelectedArr)==1)?0:-1},execCommand:function(){var a=this.selection.getRange(),b=a.startContainer,c=domUtils.findParentByTagName(b,["td","th"],!0),d=c.parentNode,e=d.parentNode.parentNode,f=d.rowIndex,h=g(c),j=c.rowSpan,k=c.colSpan;for(var l=0;l<j;l++)for(var m=0;m<k;m++){var n=e.rows[f+l].cells[h+m];n.rowSpan=1,n.colSpan=1,i(n)&&(n.style.display="",n.innerHTML=browser.ie?"":"<br/>")}}},a.commands.splittorows={queryCommandState:function(){if(this.highlight)return-1;var b=this.selection.getRange(),c=b.startContainer,d=domUtils.findParentByTagName(c,"td",!0)||a.currentSelectedArr[0];return d&&d.rowSpan>1&&(!a.currentSelectedArr.length||j(a.currentSelectedArr)==1)?0:-1},execCommand:function(){var b=this.selection.getRange(),d=b.startContainer,e=domUtils.findParentByTagName(d,"td",!0)||a.currentSelectedArr[0],f=e.parentNode,h=f.parentNode.parentNode.rows,j=f.rowIndex,k=g(e),l=e.rowSpan,m=e.colSpan;for(var n=0;n<l;n++){var o=h[j+n],p=o.cells[k];p.rowSpan=1,p.colSpan=m,i(p)&&(p.style.display="",p.innerHTML=browser.ie?"":"<br/>");for(var q=k+1;q<k+m;q++)p=o.cells[q],p.setAttribute("rootRowIndex",j+n)}c(a.currentSelectedArr),this.selection.getRange().setStart(e,0).setCursor()}},a.commands.insertparagraphbeforetable={queryCommandState:function(){if(this.highlight)return-1;var b=this.selection.getRange(),c=b.startContainer,d=domUtils.findParentByTagName(c,"td",!0)||a.currentSelectedArr[0];return d&&domUtils.findParentByTagName(d,"table")?0:-1},execCommand:function(){var b=this.selection.getRange(),d=b.startContainer,e=domUtils.findParentByTagName(d,"table",!0);d=a.document.createElement(a.options.enterTag),e.parentNode.insertBefore(d,e),c(a.currentSelectedArr),d.tagName=="P"?(d.innerHTML=browser.ie?"":"<br/>",b.setStart(d,0)):b.setStartBefore(d),b.setCursor()}},a.commands.splittocols={queryCommandState:function(){if(this.highlight)return-1;var b=this.selection.getRange(),c=b.startContainer,d=domUtils.findParentByTagName(c,["td","th"],!0)||a.currentSelectedArr[0];return d&&d.colSpan>1&&(!a.currentSelectedArr.length||j(a.currentSelectedArr)==1)?0:-1},execCommand:function(){var b=this.selection.getRange(),d=b.startContainer,e=domUtils.findParentByTagName(d,["td","th"],!0)||a.currentSelectedArr[0],f=e.parentNode,h=f.parentNode.parentNode.rows,j=f.rowIndex,k=g(e),l=e.rowSpan,m=e.colSpan;for(var n=0;n<m;n++){var o=h[j].cells[k+n];o.rowSpan=l,o.colSpan=1,i(o)&&(o.style.display="",o.innerHTML=browser.ie?"":"<br/>");for(var p=j+1;p<j+l;p++){var q=h[p].cells[k+n];q.setAttribute("rootCellIndex",k+n)}}c(a.currentSelectedArr),this.selection.getRange().setStart(e,0).setCursor()}},a.commands.insertrow={queryCommandState:function(){if(this.highlight)return-1;var b=this.selection.getRange();return domUtils.findParentByTagName(b.startContainer,"table",!0)||domUtils.findParentByTagName(b.endContainer,"table",!0)||a.currentSelectedArr.length!=0?0:-1},execCommand:function(){var b=this.selection.getRange(),d=b.startContainer,e=domUtils.findParentByTagName(d,"tr",!0)||a.currentSelectedArr[0].parentNode,f=e.parentNode.parentNode,g=f.rows,h=e.rowIndex,j=g[h].cells,k=f.insertRow(h),l;for(var m=0;m<j.length;){var n=j[m];if(i(n)){var o=g[n.getAttribute("rootRowIndex")].cells[n.getAttribute("rootCellIndex")];o.rowSpan++;for(var p=0;p<o.colSpan;p++)l=n.cloneNode(!1),domUtils.removeAttributes(l,["bgColor","valign","align"]),l.rowSpan=l.colSpan=1,l.innerHTML=browser.ie?"":"<br/>",l.className="",k.children[m+p]?k.insertBefore(l,k.children[m+p]):k.appendChild(l),l.style.display="none";m+=o.colSpan}else{for(var r=0;r<n.colSpan;r++)l=n.cloneNode(!1),domUtils.removeAttributes(l,["bgColor","valign","align"]),l.rowSpan=l.colSpan=1,l.innerHTML=browser.ie?"":"<br/>",l.className="",k.children[m+r]?k.insertBefore(l,k.children[m+r]):k.appendChild(l);m+=n.colSpan}}q(f),b.setStart(k.cells[0],0).setCursor(),c(a.currentSelectedArr)}},a.commands.insertcol={queryCommandState:function(){if(this.highlight)return-1;var b=this.selection.getRange();return domUtils.findParentByTagName(b.startContainer,"table",!0)||domUtils.findParentByTagName(b.endContainer,"table",!0)||a.currentSelectedArr.length!=0?0:-1},execCommand:function(){var b=this.selection.getRange(),d=b.startContainer,e=domUtils.findParentByTagName(d,["td","th"],!0)||a.currentSelectedArr[0],f=domUtils.findParentByTagName(e,"table"),h=f.rows,j=g(e),k;for(var l=0;l<h.length;){var m=h[l].cells[j],n;if(i(m)){var o=h[m.getAttribute("rootRowIndex")].cells[m.getAttribute("rootCellIndex")];o.colSpan++;for(var p=0;p<o.rowSpan;p++)k=e.cloneNode(!1),domUtils.removeAttributes(k,["bgColor","valign","align"]),k.rowSpan=k.colSpan=1,k.innerHTML=browser.ie?"":"<br/>",k.className=""
,n=h[l+p],n.children[j]?n.insertBefore(k,n.children[j]):n.appendChild(k),k.style.display="none";l+=o.rowSpan}else{for(var r=0;r<m.rowSpan;r++)k=e.cloneNode(!1),domUtils.removeAttributes(k,["bgColor","valign","align"]),k.rowSpan=k.colSpan=1,k.innerHTML=browser.ie?"":"<br/>",k.className="",n=h[l+r],n.children[j]?n.insertBefore(k,n.children[j]):n.appendChild(k),k.innerHTML=browser.ie?"":"<br/>";l+=m.rowSpan}}q(f),b.setStart(h[0].cells[j],0).setCursor(),c(a.currentSelectedArr)}},a.commands.mergecells={queryCommandState:function(){if(this.highlight)return-1;var a=0;for(var b=0,c;c=this.currentSelectedArr[b++];)i(c)||a++;return a>1?0:-1},execCommand:function(){var b=a.currentSelectedArr[0],d=a.currentSelectedArr[a.currentSelectedArr.length-1],e=domUtils.findParentByTagName(b,"table"),f=e.rows,h={beginRowIndex:b.parentNode.rowIndex,beginCellIndex:g(b),endRowIndex:d.parentNode.rowIndex,endCellIndex:g(d)},i=h.beginRowIndex,j=h.beginCellIndex,k=h.endRowIndex-h.beginRowIndex+1,m=h.endCellIndex-h.beginCellIndex+1,n=f[i].cells[j];for(var o=0,p;(p=f[i+o++])&&o<=k;)for(var q=0,r;(r=p.cells[j+q++])&&q<=m;)o==1&&q==1?(r.style.display="",r.rowSpan=k,r.colSpan=m):(r.style.display="none",r.rowSpan=1,r.colSpan=1,r.setAttribute("rootRowIndex",i),r.setAttribute("rootCellIndex",j),l(n,r));this.selection.getRange().setStart(n,0).setCursor(),browser.ie&&domUtils.removeAttributes(n,["width","height"]),c(a.currentSelectedArr)}},a.adjustTable=function(b){var c=b.getElementsByTagName("table");for(var d=0,e;e=c[d++];){if(e.getAttribute("align")){var f=e.nextSibling;while(f){if(domUtils.isBlockElm(f))break;f=f.nextSibling}f&&(f.style.clear="both")}e.removeAttribute("_innerCreateTable");var h=domUtils.getElementsByTagName(e,"td"),i,j;for(var k=0,l;l=h[k++];){domUtils.isEmptyNode(l)&&(l.innerHTML=browser.ie?domUtils.fillChar:"<br/>");var m=g(l),n=l.parentNode.rowIndex,o=domUtils.findParentByTagName(l,"table").rows;for(var p=0;p<l.rowSpan;p++){var q=p==0?1:0;for(;q<l.colSpan;q++)i?i=i.cloneNode(!0):(i=l.cloneNode(!1),i.rowSpan=i.colSpan=1,i.style.display="none",i.innerHTML=browser.ie?"":"<br/>"),i.setAttribute("rootRowIndex",l.parentNode.rowIndex),i.setAttribute("rootCellIndex",m),p==0?l.nextSibling?l.parentNode.insertBefore(i,l.nextSibling):l.parentNode.appendChild(i):(j=o[n+p].children[m],j?j.parentNode.insertBefore(i,j):o[n+p].appendChild(i))}}}a.fireEvent("afteradjusttable",b)}},UE.plugins.contextmenu=function(){var a=this,b,c=a.options.contextMenu;if(!c||c.length==0)return;var d=UE.ui.uiUtils;a.addListener("contextmenu",function(e,f){var g=d.getViewportOffsetByEvent(f);a.fireEvent("beforeselectionchange"),b&&b.destroy();for(var h=0,i,j=[];i=c[h];h++){var k;(function(b){if(b=="-")(k=j[j.length-1])&&k!=="-"&&j.push("-");else if(b.group){for(var c=0,d,e=[];d=b.subMenu[c];c++)(function(b){b=="-"?(k=e[e.length-1])&&k!=="-"&&e.push("-"):a.queryCommandState(b.cmdName)!=-1&&e.push({label:b.label,className:"edui-for-"+b.cmdName+(b.value||""),onclick:b.exec?function(){b.exec.call(a)}:function(){a.execCommand(b.cmdName,b.value)}})})(d);e.length&&j.push({label:b.group,className:"edui-for-"+b.icon,subMenu:{items:e,editor:a}})}else if(a.queryCommandState(b.cmdName)!=-1){if(b.cmdName=="highlightcode"&&a.queryCommandState(b.cmdName)==0)return;j.push({label:b.label,className:"edui-for-"+(b.icon?b.icon:b.cmdName+(b.value||"")),onclick:b.exec?function(){b.exec.call(a)}:function(){a.execCommand(b.cmdName,b.value)}})}})(i)}j[j.length-1]=="-"&&j.pop(),b=new UE.ui.Menu({items:j,editor:a}),b.render(),b.showAt(g),domUtils.preventDefault(f);if(browser.ie){var l;try{l=a.selection.getNative().createRange()}catch(m){return}if(l.item){var n=new dom.Range(a.document);n.selectNode(l.item(0)).select(!0,!0)}}})},UE.plugins.basestyle=function(){var a={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},b=function(a,b){var c=a.selection.getStartElementPath();return utils.findNode(c,b)},c=this;for(var d in a)(function(a,d){c.commands[a]={execCommand:function(a){var e=new dom.Range(c.document),f="";if(c.currentSelectedArr&&c.currentSelectedArr.length>0){for(var g=0,h;h=c.currentSelectedArr[g++];)h.style.display!="none"&&(e.selectNodeContents(h).select(),!f&&(f=b(this,d)),(a=="superscript"||a=="subscript")&&(!f||f.tagName.toLowerCase()!=a)&&e.removeInlineStyle(["sub","sup"]),f?e.removeInlineStyle(d):e.applyInlineStyle(d[0]));e.selectNodeContents(c.currentSelectedArr[0]).select()}else{e=c.selection.getRange(),f=b(this,d);if(e.collapsed){if(f){var i=c.document.createTextNode("");e.insertNode(i).removeInlineStyle(d),e.setStartBefore(i),domUtils.remove(i)}else{var j=e.document.createElement(d[0]);if(a=="superscript"||a=="subscript")i=c.document.createTextNode(""),e.insertNode(i).removeInlineStyle(["sub","sup"]).setStartBefore(i).collapse(!0);e.insertNode(j).setStart(j,0)}e.collapse(!0)}else(a=="superscript"||a=="subscript")&&(!f||f.tagName.toLowerCase()!=a)&&e.removeInlineStyle(["sub","sup"]),f?e.removeInlineStyle(d):e.applyInlineStyle(d[0]);e.select()}return!0},queryCommandState:function(){return this.highlight?-1:b(this,d)?1:0}}})(d,a[d])},UE.plugins.elementpath=function(){var a,b,c=this;c.commands.elementpath={execCommand:function(d,e){var f=b[e],g=c.selection.getRange();c.currentSelectedArr&&domUtils.clearSelectedArr(c.currentSelectedArr),a=e*1;if(dtd.$tableContent[f.tagName]){switch(f.tagName){case"TD":c.currentSelectedArr=[f],f.className=c.options.selectedTdClass;break;case"TR":var h=f.cells;for(var i=0,j;j=h[i++];)c.currentSelectedArr.push(j),j.className=c.options.selectedTdClass;break;case"TABLE":case"TBODY":var k=f.rows;for(var i=0,l;l=k[i++];){h=l.cells;for(var m=0,n;n=h[m++];)c.currentSelectedArr.push(n),n.className=c.options.selectedTdClass}}f=c.currentSelectedArr[0],domUtils.isEmptyNode(f)?g.setStart(f,0).setCursor():g.selectNodeContents(f).select()}else g.selectNode(f).select()},queryCommandValue:function(){var c=[].concat(this.selection.getStartElementPath()).reverse(),d=[];b=c;for(var e=0,f;f=c[e];e++){if(f.nodeType==3)continue;var g=f.tagName.toLowerCase();g=="img"&&f.getAttribute("anchorname")&&(g="anchor"),d[e]=g;if(a==e){a=-1;break}}return d}}},UE.plugins.formatmatch=function(){function e(f,g){function i(c){return m&&(!a.currentSelectedArr||!a.currentSelectedArr.length)&&c.selectNode(m),c.applyInlineStyle(b[b.length-1].tagName,null,b)}if(browser.webkit)var h=g.target.tagName=="IMG"?g.target:null;a.undoManger&&a.undoManger.save();var j=a.selection.getRange(),k=h||j.getClosedNode();if(c&&k&&k.tagName=="IMG")k.style.cssText+=";float:"+(c.style.cssFloat||c.style.styleFloat||"none")+";display:"+(c.style.display||"inline"),c=null;else if(!c){var l=j.collapsed;if(l){var m=a.document.createTextNode("match");j.insertNode(m).select()}a.__hasEnterExecCommand=!0;var n=a.options.removeFormatAttributes;a.options.removeFormatAttributes="",a.execCommand("removeformat"),a.options.removeFormatAttributes=n,a.__hasEnterExecCommand=!1,j=a.selection.getRange();if(b.length==0)a.currentSelectedArr&&a.currentSelectedArr.length>0&&j.selectNodeContents(a.currentSelectedArr[0]).select();else if(a.currentSelectedArr&&a.currentSelectedArr.length>0){for(var o=0,p;p=a.currentSelectedArr[o++];)j.selectNodeContents(p),i(j);j.selectNodeContents(a.currentSelectedArr[0]).select()}else i(j);if(!a.currentSelectedArr||!a.currentSelectedArr.length)m&&j.setStartBefore(m).collapse(!0),j.select();m&&domUtils.remove(m)}a.undoManger&&a.undoManger.save(),a.removeListener("mouseup",e),d=0}var a=this,b=[],c,d=0;a.addListener("reset",function(){b=[],d=0}),a.commands.formatmatch={execCommand:function(f){if(d){d=0,b=[],a.removeListener("mouseup",e);return}var g=a.selection.getRange();c=g.getClosedNode();if(!c||c.tagName!="IMG"){g.collapse(!0).shrinkBoundary();var h=g.startContainer;b=domUtils.findParents(h,!0,function(a){return!domUtils.isBlockElm(a)&&a.nodeType==1});for(var i=0,j;j=b[i];i++)if(j.tagName=="A"){b.splice(i,1);break}}a.addListener("mouseup",e),d=1},queryCommandState:function(){return this.highlight?-1:d},notNeedUndo:1}},UE.plugins.searchreplace=function(){var a,b,c=this;c.addListener("reset",function(){a=null,b=null}),c.commands.searchreplace={execCommand:function(c,d){var e=this,f=e.selection,g,h,i=0,d=utils.extend(d,{all:!1,casesensitive:!1,dir:1},!0);if(browser.ie)for(;;){var j;h=e.document.selection.createRange(),j=h.duplicate(),j.moveToElementText(e.document.body),d.all?(b=0,d.dir=1,a&&j.setEndPoint(d.dir==-1?"EndToStart":"StartToEnd",a)):(j.setEndPoint(d.dir==-1?"EndToStart":"StartToEnd",h),d.hasOwnProperty("replaceStr")&&j.setEndPoint(d.dir==-1?"StartToEnd":"EndToStart",h)),h=j.duplicate();if(!j.findText(d.searchStr,d.dir,d.casesensitive?4:0))return a=null,j=e.document.selection.createRange(),j.scrollIntoView(),i;j.select(),d.hasOwnProperty("replaceStr")&&(g=f.getRange(),g.deleteContents().insertNode(g.document.createTextNode(d.replaceStr)).select(),a=f.getNative().createRange()),i++;if(!d.all)break}else{var k=e.window,l=f.getNative(),j;for(;;){d.all?(a?(a.collapse(!1),h=a):(h=e.document.createRange(),h.setStart(e.document.body,0)),l.removeAllRanges(),l.addRange(h),b=0,d.dir=1):(h=k.getSelection().getRangeAt(0),d.hasOwnProperty("replaceStr")&&h.collapse(d.dir==1?!0:!1)),b?l.removeAllRanges():(h.collapse(d.dir<0?!0:!1),l.removeAllRanges(),l.addRange(h));if(!k.find(d.searchStr,d.casesensitive,d.dir<0?!0:!1))return a=null,l.removeAllRanges(),i;b=0,g=k.getSelection().getRangeAt(0);if(!g.collapsed&&d.hasOwnProperty("replaceStr")){g.deleteContents();var m=k.document.createTextNode(d.replaceStr);g.insertNode(m),g.selectNode(m),l.addRange(g),a=g.cloneRange()}i++;if(!d.all)break}}return!0}}},UE.plugins.customstyle=function(){var a=this;a.commands.customstyle={execCommand:function(a,b){var c=this,d=b.tag,e=domUtils.findParent(c.selection.getStart(),function(a){return a.getAttribute("label")},!0),f,g,h={};for(var i in b)h[i]=b[i];delete h.tag;if(e&&e.getAttribute("label")==b.label){f=this.selection.getRange(),g=f.createBookmark();if(f.collapsed)if(dtd.$block[e.tagName]){var j=c.document.createElement("p");domUtils.moveChild(e,j),e.parentNode.insertBefore(j,e),domUtils.remove(e)}else domUtils.remove(e,!0);else{var k=domUtils.getCommonAncestor(g.start,g.end),l=domUtils.getElementsByTagName(k,d);(new RegExp(d,"i")).test(k.tagName)&&l.push(k);for(var m=0,n;n=l[m++];)if(n.getAttribute("label")==b.label){var o=domUtils.getPosition(n,g.start),p=domUtils.getPosition(n,g.end);if((o&domUtils.POSITION_FOLLOWING||o&domUtils.POSITION_CONTAINS)&&(p&domUtils.POSITION_PRECEDING||p&domUtils.POSITION_CONTAINS)&&dtd.$block[d]){var j=c.document.createElement("p");domUtils.moveChild(n,j),n.parentNode.insertBefore(j,n)}domUtils.remove(n,!0)}e=domUtils.findParent(k,function(a){return a.getAttribute("label")==b.label},!0),e&&domUtils.remove(e,!0)}f.moveToBookmark(g).select()}else if(dtd.$block[d]){this.execCommand("paragraph",d,h,"customstyle"),f=c.selection.getRange();if(!f.collapsed){f.collapse(),e=domUtils.findParent(c.selection.getStart(),function(a){return a.getAttribute("label")==b.label},!0);var q=c.document.createElement("p");domUtils.insertAfter(e,q),domUtils.fillNode(c.document,q),f.setStart(q,0).setCursor()}}else{f=c.selection.getRange();if(f.collapsed){e=c.document.createElement(d),domUtils.setAttributes(e,h),f.insertNode(e).setStart(e,0).setCursor();return}g=f.createBookmark(),f.applyInlineStyle(d,h).moveToBookmark(g).select()}},queryCommandValue:function(){var a=utils.findNode(this.selection.getStartElementPath(),null,function(a){return a.getAttribute("label")});return a?a.getAttribute("label"):""},queryCommandState:function(){return this.highlight?-1:0}},a.addListener("keyup",function(b,c){var d=c.keyCode||c.which;if(d==32||d==13){var e=a.selection.getRange();if(e.collapsed){var f=domUtils.findParent(a.selection.getStart(),function(a){return a.getAttribute("label")},!0);if(f&&dtd.$block[f.tagName]&&domUtils.isEmptyNode(f)){var g=a.document.createElement("p");domUtils.insertAfter(f,g),domUtils.fillNode(a.document,g),domUtils.remove(f),e.setStart(g,0).setCursor()}}}})},UE.plugins.catchremoteimage=function(){function catchremoteimage(a,b){var c=a.join(separater);ajax.request(catcherUrl,{content:c,timeout:6e4,onsuccess:b.success,onerror:b.error})}if(!this.options.catchRemoteImageEnable)return;var ajax=UE.ajax,me=this,localDomain=me.options.localDomain,catcherUrl=me.options.catcherUrl,separater="ue_separate_ue";me.addListener("afterpaste",function(){me.fireEvent("catchRemoteImage")}),me.addListener("catchRemoteImage",function(){var remoteImages=[],imgs=domUtils.getElementsByTagName(me.document,"img");for(var i=0,ci;ci=imgs[i++];){if(ci.getAttribute("word_img"))continue;var src=ci.getAttribute("data_ue_src")||ci.src||"";/^(https?|ftp):/i.test(src)&&src.indexOf(localDomain)==-1&&remoteImages.push(src)}remoteImages.length&&catchremoteimage(remoteImages,{success:function(xhr){try{var info=eval("("+xhr.responseText+")")}catch(e){return}var srcUrls=info.srcUrl.split(separater),urls=info.url.split(separater);for(var i=0,ci;ci=imgs[i++];){var src=ci.getAttribute("data_ue_src")||ci.src||"";for(var j=0,cj;cj=srcUrls[j++];){var url=urls[j-1];if(src==cj&&url!="error"){var newSrc=me.options.UEDITOR_HOME_URL+"server/"+url;domUtils.setAttributes(ci,{src:newSrc,data_ue_src:newSrc});break}}}},error:function(){me.fireEvent("catchremoteerror")}})})},UE.commands.snapscreen={execCommand:function(){var me=this,editorOptions=me.options;if(!browser.ie){alert(editorOptions.messages.snapScreenNotIETip);return}var onSuccess=function(rs){try{rs=eval("("+rs+")")}catch(e){alert("\u622a\u5c4f\u4e0a\u4f20\u6709\u8bef\n\n\u8bf7\u68c0\u67e5editor_config.js\u4e2d\u5173\u4e8e\u622a\u5c4f\u7684\u914d\u7f6e\u9879\n\nsnapscreenHost \u53d8\u91cf\u503c \u5e94\u8be5\u4e3a\u5c4f\u5e55\u622a\u56fe\u7684server\u7aef\u6587\u4ef6\u6240\u5728\u7684\u7f51\u7ad9\u5730\u5740\u6216\u8005ip");return}if(rs.state!="SUCCESS"){alert(rs.state);return}me.execCommand("insertimage",{src:(editorOptions.snapscreenImgIsUseImagePath?editorOptions.imagePath:"")+rs.url,floatStyle:editorOptions.snapscreenImgAlign,data_ue_src:(editorOptions.snapscreenImgIsUseImagePath?editorOptions.imagePath:"")+rs.url})},onStartUpload=function(){},onError=function(){alert(editorOptions.messages.snapScreenMsg)};try{var nativeObj=new ActiveXObject("Snapsie.CoSnapsie");nativeObj.saveSnapshot(editorOptions.snapscreenHost,editorOptions.snapscreenServerFile,editorOptions.snapscreenServerPort,onStartUpload,onSuccess,onError)}catch(e){me.snapscreenInstall.open()}},queryCommandState:function(){return this.highlight?-1:0}},UE.commands.attachment={queryCommandState:function(){return this.highlight?-1:0}};var baidu=baidu||{};baidu.editor=baidu.editor||{},baidu.editor.ui={},function(){function h(){var a=document.getElementById("edui_fixedlayer");g.setViewportOffset(a,{left:0,top:0})}function i(a){b.on(window,"scroll",h),b.on(window,"resize",baidu.editor.utils.defer(h,0,!0))}var a=baidu.editor.browser,b=baidu.editor.dom.domUtils,c="$EDITORUI",d=window[c]={},e="ID"+c,f=0,g=baidu.editor.ui.uiUtils={uid:function(a){return a?a[e]||(a[e]=++f):++f},hook:function(a,b){var c;return a&&a._callbacks?c=a:(c=function(){var b;a&&(b=a.apply(this,arguments));var d=c._callbacks,e=d.length;while(e--){var f=d[e].apply(this,arguments);b===undefined&&(b=f)}return b},c._callbacks=[]),c._callbacks.push(b),c},createElementByHtml:function(a){var b=document.createElement("div");return b.innerHTML=a,b=b.firstChild,b.parentNode.removeChild(b),b},getViewportElement:function(){return a.ie&&a.quirks?document.body:document.documentElement},getClientRect:function(a){var c=a.getBoundingClientRect(),d={left:Math.round(c.left),top:Math.round(c.top),height:Math.round(c.bottom-c.top),width:Math.round(c.right-c.left)},e;while((e=a.ownerDocument)!==document&&(a=b.getWindow(e).frameElement))c=a.getBoundingClientRect(),d.left+=c.left,d.top+=c.top;return d.bottom=d.top+d.height,d.right=d.left+d.width,d},getViewportRect:function(){var a=g.getViewportElement(),b=(window.innerWidth||a.clientWidth)|0,c=(window.innerHeight||a.clientHeight)|0;return{left:0,top:0,height:c,width:b,bottom:c,right:b}},setViewportOffset:function(a,c){var d,e=g.getFixedLayer();a.parentNode===e?(a.style.left=c.left+"px",a.style.top=c.top+"px"):b.setViewportOffset(a,c)},getEventOffset:function(a){var b=a.target||a.srcElement,c=g.getClientRect(b),d=g.getViewportOffsetByEvent(a);return{left:d.left-c.left,top:d.top-c.top}},getViewportOffsetByEvent:function(a){var c=a.target||a.srcElement,d=b.getWindow(c).frameElement,e={left:a.clientX,top:a.clientY};if(d&&c.ownerDocument!==document){var f=g.getClientRect(d);e.left+=f.left,e.top+=f.top}return e},setGlobal:function(a,b){return d[a]=b,c+'["'+a+'"]'},unsetGlobal:function(a){delete d[a]},copyAttributes:function(b,c){var d=c.attributes,e=d.length;while(e--){var f=d[e];f.nodeName!="style"&&f.nodeName!="class"&&(!a.ie||f.specified)&&b.setAttribute(f.nodeName,f.nodeValue)}c.className&&(b.className+=" "+c.className),c.style.cssText&&(b.style.cssText+=";"+c.style.cssText)},removeStyle:function(a,b){if(a.style.removeProperty)a.style.removeProperty(b);else{if(!a.style.removeAttribute)throw"";a.style.removeAttribute(b)}},contains:function(a,b){return a&&b&&(a===b?!1:a.contains?a.contains(b):a.compareDocumentPosition(b)&16)},startDrag:function(a,b,c){function f(a){var c=a.clientX-d,f=a.clientY-e;b.ondragmove(c,f),a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}var c=c||document,d=a.clientX,e=a.clientY;if(c.addEventListener){function g(a){c.removeEventListener("mousemove",f,!0),c.removeEventListener("mouseup",f,!0),b.ondragstop()}c.addEventListener("mousemove",f,!0),c.addEventListener("mouseup",g,!0),a.preventDefault()}else{var h=a.srcElement;h.setCapture();function i(){h.releaseCapture(),h.detachEvent("onmousemove",f),h.detachEvent("onmouseup",i),h.detachEvent("onlosecaptrue",i),b.ondragstop()}h.attachEvent("onmousemove",f),h.attachEvent("onmouseup",i),h.attachEvent("onlosecaptrue",i),a.returnValue=!1}b.ondragstart()},getFixedLayer:function(){var b=document.getElementById("edui_fixedlayer");return b==null&&(b=document.createElement("div"),b.id="edui_fixedlayer",document.body.appendChild(b),a.ie&&a.version<=8?(b.style.position="absolute",i(),setTimeout(h)):b.style.position="fixed",b.style.left="0",b.style.top="0",b.style.width="0",b.style.height="0"),b},makeUnselectable:function(b){if(a.opera||a.ie&&a.version<9){b.unselectable="on";if(b.hasChildNodes())for(var c=0;c<b.childNodes.length;c++)b.childNodes[c].nodeType==1&&g.makeUnselectable(b.childNodes[c])}else b.style.MozUserSelect!==undefined?b.style.MozUserSelect="none":b.style.WebkitUserSelect!==undefined?b.style.WebkitUserSelect="none":b.style.KhtmlUserSelect!==undefined&&(b.style.KhtmlUserSelect="none")}}}(),function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,c=baidu.editor.EventBase,d=baidu.editor.ui.UIBase=function(){};d.prototype={className:"",uiName:"",initOptions:function(a){var c=this;for(var d in a)c[d]=a[d];this.id=this.id||"edui"+b.uid()},initUIBase:function(){this._globalKey=a.unhtml(b.setGlobal(this.id,this))},render:function(a){var c=this.renderHtml(),d=b.createElementByHtml(c),e=this.getDom();e!=null?(e.parentNode.replaceChild(d,e),b.copyAttributes(d,e)):(typeof a=="string"&&(a=document.getElementById(a)),a=a||b.getFixedLayer(),a.appendChild(d)),this.postRender()},getDom:function(a){return a?document.getElementById(this.id+"_"+a):document.getElementById(this.id)},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(a){var b="edui-"+this.uiName;return a.replace(/##/g,this.id).replace(/%%-/g,this.uiName?b+"-":"").replace(/%%/g,(this.uiName?b:"")+" "+this.className).replace(/\$\$/g,this._globalKey)},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var a=this.getDom();a&&baidu.editor.dom.domUtils.remove(a),b.unsetGlobal(this.id)}},a.inherits(d,c)}(),function(){var a=baidu.editor.utils,b=baidu.editor.ui.UIBase,c=baidu.editor.ui.Separator=function(a){this.initOptions(a),this.initSeparator()};c.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}},a.inherits(c,b)}(),function(){var a=baidu.editor.utils,b=baidu.editor.dom.domUtils,c=baidu.editor.ui.UIBase,d=baidu.editor.ui.uiUtils,e=baidu.editor.ui.Mask=function(a){this.initOptions(a),this.initUIBase()};e.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var a=this;b.on(window,"resize",function(){setTimeout(function(){a.isHidden()||a._fill()})})},show:function(a){this._fill(),this.getDom().style.display="",this.getDom().style.zIndex=a},hide:function(){this.getDom().style.display="none",this.getDom().style.zIndex=""},isHidden:function(){return this.getDom().style.display=="none"},_onMouseDown:function(){return!1},_fill:function(){var a=this.getDom(),b=d.getViewportRect();a.style.width=b.width+"px",a.style.height=b.height+"px"}},a.inherits(e,c)}(),function(){function g(a){var b=[];for(var c=0;c<f.length;c++){var d=f[c];d.isHidden()||d.queryAutoHide(a)!==!1&&d.hide()}}var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,c=baidu.editor.dom.domUtils,d=baidu.editor.ui.UIBase,e=baidu.editor.ui.Popup=function(a){this.initOptions(a),this.initPopup()},f=[];e.postHide=g;var h=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];e.prototype={SHADOW_RADIUS:5,content:null,_hidden:!1,autoRender:!0,canSideLeft:!0,canSideUp:!0,initPopup:function(){this.initUIBase(),f.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: white;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div>"+" </div>"+"</div>"},getContentHtmlTpl:function(){return typeof this.content=="string"?this.content:this.content.renderHtml()},_UIBase_postRender:d.prototype.postRender,postRender:function(){this.content instanceof d&&this.content.postRender(),this.fireEvent("postRenderAfter"),this.hide(!0),this._UIBase_postRender()},_doAutoRender:function(){!this.getDom()&&this.autoRender&&this.render()},mesureSize:function(){var a=this.getDom("content");return b.getClientRect(a)},fitSize:function(){var a=this.getDom("body");a.style.width="",a.style.height="";var b=this.mesureSize();return a.style.width=b.width+"px",a.style.height=b.height+"px",b},showAnchor:function(a,c){this.showAnchorRect(b.getClientRect(a),c)},showAnchorRect:function(a,d,e){this._doAutoRender();var f=b.getViewportRect();this._show();var g=this.fitSize(),i,j,k,l;d?(i=this.canSideLeft&&a.right+g.width>f.right&&a.left>g.width,j=this.canSideUp&&a.top+g.height>f.bottom&&a.bottom>g.height,k=i?a.left-g.width:a.right,l=j?a.bottom-g.height:a.top):(i=this.canSideLeft&&a.right+g.width>f.right&&a.left>g.width,j=this.canSideUp&&a.top+g.height>f.bottom&&a.bottom>g.height,k=i?a.right-g.width:a.left,l=j?a.top-g.height:a.bottom);var m=this.getDom();b.setViewportOffset(m,{left:k,top:l}),c.removeClasses(m,h),m.className+=" "+h[(j?1:0)*2+(i?1:0)],this.editor&&(m.style.zIndex=this.editor.container.style.zIndex*1+10,baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=m.style.zIndex-1)},showAt:function(a){var b=a.left,c=a.top,d={left:b,top:c,right:b,bottom:c,height:0,width:0};this.showAnchorRect(d,!1,!0)},_show:function(){if(this._hidden){var a=this.getDom();a.style.display="",this._hidden=!1,this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender(),this._show()},hide:function(a){!this._hidden&&this.getDom()&&(this.getDom().style.display="none",this._hidden=!0,a||this.fireEvent("hide"))},queryAutoHide:function(a){return!a||!b.contains(this.getDom(),a)}},a.inherits(e,d),c.on(document,"mousedown",function(a){var b=a.target||a.srcElement;g(b)}),c.on(window,"scroll",function(){g()})}(),function(){function e(a){var b='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+a+"</div>"+"</div>"+'<table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0">'+'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#366092;padding-top: 2px"><td colspan="10">\u4e3b\u9898\u989c\u8272</td> </tr>'+'<tr class="edui-colorpicker-tablefirstrow" >';for(var c=0;c<d.length;c++)c&&c%10===0&&(b+="</tr>"+(c==60?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#366092;"><td colspan="10">\u6807\u51c6\u989c\u8272</td></tr>':"")+"<tr"+(c==60?' class="edui-colorpicker-tablefirstrow"':"")+">"),b+=c<70?'<td style="padding: 0 2px;"><a hidefocus title="'+d[c]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell"'+' data-color="#'+d[c]+'"'+' style="background-color:#'+d[c]+";border:solid #ccc;"+(c<10||c>=60?"border-width:1px;":c>=10&&c<20?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"'+"></a></td>":"";return b+="</tr></table></div>",b}var a=baidu.editor.utils,b=baidu.editor.ui.UIBase,c=baidu.editor.ui.ColorPicker=function(a){this.initOptions(a),this.noColorText=this.noColorText||"\u4e0d\u8bbe\u7f6e\u989c\u8272",this.initUIBase()};c.prototype={getHtmlTpl:function(){return e(this.noColorText)},_onTableClick:function(a){var b=a.target||a.srcElement,c=b.getAttribute("data-color");c&&this.fireEvent("pickcolor",c)},_onTableOver:function(a){var b=a.target||a.srcElement,c=b.getAttribute("data-color");c&&(this.getDom("preview").style.backgroundColor=c)},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}},a.inherits(c,b);var d="ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,".split(",")}(),function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,c=baidu.editor.ui.UIBase,d=baidu.editor.ui.TablePicker=function(a){this.initOptions(a),this.initTablePicker()};d.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"></span><span class="edui-clickable" onclick="$$._onMore();">\u66f4\u591a</span></div><div class="edui-pickarea" onmousemove="$$._onMouseMove(event, this);" onmouseover="$$._onMouseOver(event, this);" onmouseout="$$._onMouseOut(event, this);" onclick="$$._onClick(event, this);"><div id="##_overlay" class="edui-overlay"></div></div></div></div>'},_UIBase_render:c.prototype.render,render:function(a){this._UIBase_render(a),this.getDom("label").innerHTML="0\u5217 x 0\u884c"},_track:function(a,b){var c=this.getDom("overlay").style,d=this.lengthOfCellSide;c.width=a*d+"px",c.height=b*d+"px";var e=this.getDom("label");e.innerHTML=a+"\u5217 x "+b+"\u884c",this.numCols=a,this.numRows=b},_onMouseOver:function(a,c){var d=a.relatedTarget||a.fromElement;!b.contains(c,d)&&c!==d&&(this.getDom("label").innerHTML="0\u5217 x 0\u884c",this.getDom("overlay").style.visibility="")},_onMouseOut:function(a,c){var d=a.relatedTarget||a.toElement;!b.contains(c,d)&&c!==d&&(this.getDom("label").innerHTML="0\u5217 x 0\u884c",this.getDom("overlay").style.visibility="hidden")},_onMouseMove:function(a,c){var d=this.getDom("overlay").style,e=b.getEventOffset(a),f=this.lengthOfCellSide,g=Math.ceil(e.left/f),h=Math.ceil(e.top/f);this._track(g,h)},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows)},_onMore:function(){this.fireEvent("more")}},a.inherits(d,c)}(),function(){var a=baidu.editor.browser,b=baidu.editor.dom.domUtils,c=baidu.editor.ui.uiUtils,d='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(a.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"');baidu.editor.ui.Stateful={alwalysHoverable:!1,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl,this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){var a=this._Stateful_dGetHtmlTpl();return a.replace(/stateful/g,function(){return d})},Stateful_onMouseEnter:function(a,b){if(!this.isDisabled()||this.alwalysHoverable)this.addState("hover"),this.fireEvent("over")},Stateful_onMouseLeave:function(a,b){if(!this.isDisabled()||this.alwalysHoverable)this.removeState("hover"),this.removeState("active"),this.fireEvent("out")},Stateful_onMouseOver:function(a,b){var d=a.relatedTarget;!c.contains(b,d)&&b!==d&&this.Stateful_onMouseEnter(a,b)},Stateful_onMouseOut:function(a,b){var d=a.relatedTarget;!c.contains(b,d)&&b!==d&&this.Stateful_onMouseLeave(a,b)},Stateful_onMouseDown:function(a,b){this.isDisabled()||this.addState("active")},Stateful_onMouseUp:function(a,b){this.isDisabled()||this.removeState("active")},Stateful_postRender:function(){this.disabled&&!this.hasState("disabled")&&this.addState("disabled")},hasState:function(a){return b.hasClass(this.getStateDom(),"edui-state-"+a)},addState:function(a){this.hasState(a)||(this.getStateDom().className+=" edui-state-"+a)},removeState:function(a){this.hasState(a)&&b.removeClasses(this.getStateDom(),["edui-state-"+a])},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(a){!this.isDisabled()&&a?this.addState("checked"):this.removeState("checked")},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(a){a?(this.removeState("hover"),this.removeState("checked"),this.removeState("active"),this.addState("disabled")):this.removeState("disabled")}}}(),function(){var a=baidu.editor.utils,b=baidu.editor.ui.UIBase,c=baidu.editor.ui.Stateful,d=baidu.editor.ui.Button=function(a){this.initOptions(a),this.initButton()};d.prototype={uiName:"button",label:"",title:"",showIcon:!0,showText:!0,initButton:function(){this.initUIBase(),this.Stateful_init()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return false;" onclick="return $$._onClick();">'+(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div>"+"</div>"+"</div></div>"},postRender:function(){this.Stateful_postRender()},_onClick:function(){this.isDisabled()||this.fireEvent("click")}},a.inherits(d,b),a.extend(d.prototype,c)}(),function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,c=baidu.editor.dom.domUtils,d=baidu.editor.ui.UIBase,e=baidu.editor.ui.Stateful,f=baidu.editor.ui.SplitButton=function(a){this.initOptions(a),this.initSplitButton()};f.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){this.initUIBase(),this.Stateful_init();var a=this;if(this.popup!=null){var b=this.popup;this.popup=null,this.setPopup(b)}},_UIBase_postRender:d.prototype.postRender,postRender:function(){this.Stateful_postRender(),this._UIBase_postRender()},setPopup:function(c){if(this.popup===c)return;this.popup!=null&&this.popup.dispose(),c.addListener("show",a.bind(this._onPopupShow,this)),c.addListener("hide",a.bind(this._onPopupHide,this)),c.addListener("postrender",a.bind(function(){c.getDom("body").appendChild(b.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(b.getClientRect(this.getDom()).width-2)+'px"></div>')),c.getDom().className+=" "+this.className},this)),this.popup=c},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState
("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body">'+'<div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);">'+'<div class="edui-box edui-icon"></div>'+"</div>"+'<div class="edui-box edui-splitborder"></div>'+'<div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div>'+"</div></div></div>"},showPopup:function(){var a=b.getClientRect(this.getDom());a.top-=this.popup.SHADOW_RADIUS,a.height+=this.popup.SHADOW_RADIUS,this.popup.showAnchorRect(a)},_onArrowClick:function(a,b){this.isDisabled()||this.showPopup()},_onButtonClick:function(){this.isDisabled()||this.fireEvent("buttonclick")}},a.inherits(f,d),a.extend(f.prototype,e,!0)}(),function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,c=baidu.editor.ui.ColorPicker,d=baidu.editor.ui.Popup,e=baidu.editor.ui.SplitButton,f=baidu.editor.ui.ColorButton=function(a){this.initOptions(a),this.initColorButton()};f.prototype={initColorButton:function(){var a=this;this.popup=new d({content:new c({noColorText:"\u6e05\u9664\u989c\u8272",onpickcolor:function(b,c){a._onPickColor(c)},onpicknocolor:function(b,c){a._onPickNoColor(c)}}),editor:a.editor}),this.initSplitButton()},_SplitButton_postRender:e.prototype.postRender,postRender:function(){this._SplitButton_postRender(),this.getDom("button_body").appendChild(b.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>')),this.getDom().className+=" edui-colorbutton"},setColor:function(a){this.getDom("colorlump").style.backgroundColor=a,this.color=a},_onPickColor:function(a){this.fireEvent("pickcolor",a)!==!1&&(this.setColor(a),this.popup.hide())},_onPickNoColor:function(a){this.fireEvent("picknocolor")!==!1&&this.popup.hide()}},a.inherits(f,e)}(),function(){var a=baidu.editor.utils,b=baidu.editor.ui.Popup,c=baidu.editor.ui.TablePicker,d=baidu.editor.ui.SplitButton,e=baidu.editor.ui.TableButton=function(a){this.initOptions(a),this.initTableButton()};e.prototype={initTableButton:function(){var a=this;this.popup=new b({content:new c({onpicktable:function(b,c,d){a._onPickTable(c,d)},onmore:function(){a.popup.hide(),a.fireEvent("more")}}),editor:a.editor}),this.initSplitButton()},_onPickTable:function(a,b){this.fireEvent("picktable",a,b)!==!1&&this.popup.hide()}},a.inherits(e,d)}(),function(){var a=baidu.editor.utils,b=baidu.editor.ui.UIBase,c=baidu.editor.ui.AutoTypeSetPicker=function(a){this.initOptions(a),this.initAutoTypeSetPicker()};c.prototype={initAutoTypeSetPicker:function(){this.initUIBase()},getHtmlTpl:function(){var a=this.editor.options,b=a.autotypeset;for(var c=0,d=[],e,f=a.listMap.lineheight;e=f[c++];)d.push('<option value="'+e+'" '+(b["lineHeight"]==e?"checked":"")+">"+e+"</option>");return'<div id="##" class="edui-autotypesetpicker %%"><div class="edui-autotypesetpicker-body"><table ><tr><td colspan="2"><input type="checkbox" name="mergeEmptyline" '+(b.mergeEmptyline?"checked":"")+'>\u5408\u5e76\u7a7a\u884c</td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(b.removeEmptyline?"checked":"")+">\u5220\u9664\u7a7a\u884c</td></tr>"+'<tr><td colspan="2"><input type="checkbox" name="removeClass" '+(b.removeClass?"checked":"")+'>\u6e05\u9664\u6837\u5f0f</td><td colspan="2"><input type="checkbox" name="indent" '+(b.indent?"checked":"")+">\u9996\u884c\u7f29\u8fdb2\u5b57</td></tr>"+'<tr><td colspan="2"><input type="checkbox" name="textAlign" '+(b.textAlign?"checked":"")+'>\u5bf9\u9f50\u65b9\u5f0f\uff1a</td><td colspan="2" id="textAlignValue"><input type="radio" name="textAlignValue" value="left" '+(b.textAlign&&b["textAlign"]=="left"?"checked":"")+'>\u5de6\u5bf9\u9f50<input type="radio" name="textAlignValue" value="center" '+(b.textAlign&&b["textAlign"]=="center"?"checked":"")+'>\u5c45\u4e2d\u5bf9\u9f50<input type="radio" name="textAlignValue" value="right" '+(b.textAlign&&b["textAlign"]=="right"?"checked":"")+">\u53f3\u5bf9\u9f50 </tr>"+'<tr><td colspan="2"><input type="checkbox" name="imageBlockLine" '+(b.imageBlockLine?"checked":"")+">\u56fe\u7247\u6d6e\u52a8</td>"+'<td colspan="2" id="imageBlockLineValue">'+'<input type="radio" name="imageBlockLineValue" value="none" '+(b.imageBlockLine&&b["imageBlockLine"]=="none"?"checked":"")+">\u9ed8\u8ba4"+'<input type="radio" name="imageBlockLineValue" value="left" '+(b.imageBlockLine&&b["imageBlockLine"]=="left"?"checked":"")+">\u5de6\u6d6e\u52a8"+'<input type="radio" name="imageBlockLineValue" value="center" '+(b.imageBlockLine&&b["imageBlockLine"]=="center"?"checked":"")+">\u72ec\u5360\u884c\u5c45\u4e2d"+'<input type="radio" name="imageBlockLineValue" value="right" '+(b.imageBlockLine&&b["imageBlockLine"]=="right"?"checked":"")+">\u53f3\u6d6e\u52a8</tr>"+'<tr><td colspan="2"><input type="checkbox" name="clearFontSize" '+(b.clearFontSize?"checked":"")+'>\u6e05\u9664\u5b57\u53f7</td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(b.clearFontFamily?"checked":"")+">\u6e05\u9664\u5b57\u4f53</td></tr>"+'<tr><td colspan="4"><input type="checkbox" name="removeEmptyNode" '+(b.removeEmptyNode?"checked":"")+">\u53bb\u6389\u5197\u4f59\u7684html\u4ee3\u7801</td></tr>"+'<tr><td colspan="4"><input type="checkbox" name="pasteFilter" '+(b.pasteFilter?"checked":"")+">\u7c98\u8d34\u8fc7\u6ee4 (\u5bf9\u6bcf\u6b21\u7c98\u8d34\u7684\u5185\u5bb9\u5e94\u7528\u4ee5\u4e0a\u8fc7\u6ee4\u89c4\u5219)</td></tr>"+'<tr><td colspan="4" align="right"><button >\u6267\u884c</button></td></tr>'+"</table>"+"</div>"+"</div>"},_UIBase_render:b.prototype.render},a.inherits(c,b)}(),function(){function f(a){var b=a.editor.options.autotypeset,c=a.getDom(),d=domUtils.getElementsByTagName(c,"input");for(var e=d.length-1,f;f=d[e--];)if(f.getAttribute("type")=="checkbox"){var g=f.getAttribute("name");b[g]&&delete b[g];if(f.checked){var h=document.getElementById(g+"Value");if(h)if(/input/ig.test(h.tagName))b[g]=h.value;else{var i=h.getElementsByTagName("input");for(var j=i.length-1,k;k=i[j--];)if(k.checked){b[g]=k.value;break}}else b[g]=!0}}var l=domUtils.getElementsByTagName(c,"select");for(var e=0,m;m=l[e++];){var n=m.getAttribute("name");b[n]=b[n]?m.value:""}a.editor.options.autotypeset=b}var a=baidu.editor.utils,b=baidu.editor.ui.Popup,c=baidu.editor.ui.AutoTypeSetPicker,d=baidu.editor.ui.SplitButton,e=baidu.editor.ui.AutoTypeSetButton=function(a){this.initOptions(a),this.initAutoTypeSetButton()};e.prototype={initAutoTypeSetButton:function(){var a=this;this.popup=new b({content:new c({editor:a.editor}),editor:a.editor,hide:function(){!this._hidden&&this.getDom()&&(f(this),this.getDom().style.display="none",this._hidden=!0,this.fireEvent("hide"))}});var d=0;this.popup.addListener("postRenderAfter",function(){var b=this;if(d)return;var c=this.getDom(),e=c.getElementsByTagName("button")[0];e.onclick=function(){f(b),a.editor.execCommand("autotypeset")},d=1}),this.initSplitButton()}},a.inherits(e,d)}(),function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,c=baidu.editor.ui.UIBase,d=baidu.editor.ui.Toolbar=function(a){this.initOptions(a),this.initToolbar()};d.prototype={items:null,initToolbar:function(){this.items=this.items||[],this.initUIBase()},add:function(a){this.items.push(a)},getHtmlTpl:function(){var a=[];for(var b=0;b<this.items.length;b++)a[b]=this.items[b].renderHtml();return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+a.join("")+"</div>"},postRender:function(){var a=this.getDom();for(var c=0;c<this.items.length;c++)this.items[c].postRender();b.makeUnselectable(a)},_onMouseDown:function(){return!1}},a.inherits(d,c)}(),function(){var a=baidu.editor.utils,b=baidu.editor.dom.domUtils,c=baidu.editor.ui.uiUtils,d=baidu.editor.ui.UIBase,e=baidu.editor.ui.Popup,f=baidu.editor.ui.Stateful,g=baidu.editor.ui.Menu=function(a){this.initOptions(a),this.initMenu()},h={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return!0}};g.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[],this.initPopup(),this.initItems()},initItems:function(){for(var a=0;a<this.items.length;a++){var b=this.items[a];b=="-"?this.items[a]=this.getSeparator():b instanceof i||(this.items[a]=this.createItem(b))}},getSeparator:function(){return h},createItem:function(a){return new i(a)},_Popup_getContentHtmlTpl:e.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){if(this.items.length==0)return this._Popup_getContentHtmlTpl();var a=[];for(var b=0;b<this.items.length;b++){var c=this.items[b];a[b]=c.renderHtml()}return'<div class="%%-body">'+a.join("")+"</div>"},_Popup_postRender:e.prototype.postRender,postRender:function(){var a=this;for(var d=0;d<this.items.length;d++){var e=this.items[d];e.ownerMenu=this,e.postRender()}b.on(this.getDom(),"mouseover",function(b){b=b||event;var d=b.relatedTarget||b.fromElement,e=a.getDom();!c.contains(e,d)&&e!==d&&a.fireEvent("over")}),this._Popup_postRender()},queryAutoHide:function(a){if(a){if(c.contains(this.getDom(),a))return!1;for(var b=0;b<this.items.length;b++){var d=this.items[b];if(d.queryAutoHide(a)===!1)return!1}}},clearItems:function(){for(var a=0;a<this.items.length;a++){var b=this.items[a];clearTimeout(b._showingTimer),clearTimeout(b._closingTimer),b.subMenu&&b.subMenu.destroy()}this.items=[]},destroy:function(){this.getDom()&&b.remove(this.getDom()),this.clearItems()},dispose:function(){this.destroy()}},a.inherits(g,e);var i=baidu.editor.ui.MenuItem=function(a){this.initOptions(a),this.initUIBase(),this.Stateful_init(),this.subMenu&&!(this.subMenu instanceof g)&&(this.subMenu=new g(this.subMenu))};i.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:!0,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div>"+"</div>"},postRender:function(){var a=this;this.addListener("over",function(){a.ownerMenu.fireEvent("submenuover",a),a.subMenu&&a.delayShowSubMenu()}),this.subMenu&&(this.getDom().className+=" edui-hassubmenu",this.subMenu.render(),this.addListener("out",function(){a.delayHideSubMenu()}),this.subMenu.addListener("over",function(){clearTimeout(a._closingTimer),a._closingTimer=null,a.addState("opened")}),this.ownerMenu.addListener("hide",function(){a.hideSubMenu()}),this.ownerMenu.addListener("submenuover",function(b,c){c!==a&&a.delayHideSubMenu()}),this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide,this.subMenu.queryAutoHide=function(b){return b&&c.contains(a.getDom(),b)?!1:this._bakQueryAutoHide(b)}),this.getDom().style.tabIndex="-1",c.makeUnselectable(this.getDom()),this.Stateful_postRender()},delayShowSubMenu:function(){var a=this;a.isDisabled()||(a.addState("opened"),clearTimeout(a._showingTimer),clearTimeout(a._closingTimer),a._closingTimer=null,a._showingTimer=setTimeout(function(){a.showSubMenu()},250))},delayHideSubMenu:function(){var a=this;a.isDisabled()||(a.removeState("opened"),clearTimeout(a._showingTimer),a._closingTimer||(a._closingTimer=setTimeout(function(){a.hasState("opened")||a.hideSubMenu(),a._closingTimer=null},400)))},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(a){if(this.subMenu&&this.hasState("opened"))return this.subMenu.queryAutoHide(a)},_onClick:function(a,b){if(this.hasState("disabled"))return;this.fireEvent("click",a,b)!==!1&&(this.subMenu?this.showSubMenu():e.postHide())},showSubMenu:function(){var a=c.getClientRect(this.getDom());a.right-=5,a.left+=2,a.width-=7,a.top-=4,a.bottom+=4,a.height+=8,this.subMenu.showAnchorRect(a,!0,!0)},hideSubMenu:function(){this.subMenu.hide()}},a.inherits(i,d),a.extend(i.prototype,f,!0)}(),function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,c=baidu.editor.ui.Menu,d=baidu.editor.ui.SplitButton,e=baidu.editor.ui.Combox=function(a){this.initOptions(a),this.initCombox()};e.prototype={uiName:"combox",initCombox:function(){var a=this;this.items=this.items||[];for(var b=0;b<this.items.length;b++){var d=this.items[b];d.uiName="listitem",d.index=b,d.onclick=function(){a.selectByIndex(this.index)}}this.popup=new c({items:this.items,uiName:"list",editor:this.editor}),this.initSplitButton()},_SplitButton_postRender:d.prototype.postRender,postRender:function(){this._SplitButton_postRender(),this.setLabel(this.label||""),this.setValue(this.initValue||"")},showPopup:function(){var a=b.getClientRect(this.getDom());a.top+=1,a.bottom-=1,a.height-=2,this.popup.showAnchorRect(a)},getValue:function(){return this.value},setValue:function(a){var b=this.indexByValue(a);b!=-1?(this.selectedIndex=b,this.setLabel(this.items[b].label),this.value=this.items[b].value):(this.selectedIndex=-1,this.setLabel(this.getLabelForUnknowValue(a)),this.value=a)},setLabel:function(a){this.getDom("button_body").innerHTML=a,this.label=a},getLabelForUnknowValue:function(a){return a},indexByValue:function(a){for(var b=0;b<this.items.length;b++)if(a==this.items[b].value)return b;return-1},getItem:function(a){return this.items[a]},selectByIndex:function(a){a<this.items.length&&this.fireEvent("select",a)!==!1&&(this.selectedIndex=a,this.value=this.items[a].value,this.setLabel(this.items[a].label))}},a.inherits(e,d)}(),function(){var a=baidu.editor.utils,b=baidu.editor.dom.domUtils,c=baidu.editor.ui.uiUtils,d=baidu.editor.ui.Mask,e=baidu.editor.ui.UIBase,f=baidu.editor.ui.Button,g=baidu.editor.ui.Dialog=function(a){this.initOptions(a),this.initDialog()},h,i;g.prototype={draggable:!1,uiName:"dialog",initDialog:function(){var a=this;this.initUIBase(),this.modalMask=h||(h=new d({className:"edui-dialog-modalmask"})),this.dragMask=i||(i=new d({className:"edui-dialog-dragmask"})),this.closeButton=new f({className:"edui-dialog-closebutton",title:"\u5173\u95ed\u5bf9\u8bdd\u6846",onclick:function(){a.close(!1)}});if(this.buttons)for(var b=0;b<this.buttons.length;b++)this.buttons[b]instanceof f||(this.buttons[b]=new f(this.buttons[b]))},fitSize:function(){var a=this.getDom("body"),b=this.mesureSize();return a.style.width=b.width+"px",a.style.height=b.height+"px",b},safeSetOffset:function(a){var b=this,d=b.getDom(),e=c.getViewportRect(),f=c.getClientRect(d),g=a.left;g+f.width>e.right&&(g=e.right-f.width);var h=a.top;h+f.height>e.bottom&&(h=e.bottom-f.height),d.style.left=Math.max(g,0)+"px",d.style.top=Math.max(h,0)+"px"},showAtCenter:function(){this.getDom().style.display="";var a=c.getViewportRect(),d=this.fitSize(),e=this.getDom("titlebar").offsetHeight|0,f=a.width/2-d.width/2,g=a.height/2-(d.height-e)/2-e,h=this.getDom();this.safeSetOffset({left:Math.max(f|0,0),top:Math.max(g|0,0)}),b.hasClass(h,"edui-state-centered")||(h.className+=" edui-state-centered"),this._show()},getContentHtml:function(){var a="";return typeof this.content=="string"?a=this.content:this.iframeUrl&&(a='<iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>'),a},getHtmlTpl:function(){var a="";if(this.buttons){var b=[];for(var c=0;c<this.buttons.length;c++)b[c]=this.buttons[c].renderHtml();a='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+b.join("")+"</div>"+"</div>"}return'<div id="##" class="%%"><div class="%%-wrap"><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span>"+"</div>"+this.closeButton.renderHtml()+"</div>"+'<div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+a+"</div></div></div>"},postRender:function(){this.modalMask.getDom()||(this.modalMask.render(),this.modalMask.hide()),this.dragMask.getDom()||(this.dragMask.render(),this.dragMask.hide());var a=this;this.addListener("show",function(){a.modalMask.show(this.getDom().style.zIndex-2)}),this.addListener("hide",function(){a.modalMask.hide()});if(this.buttons)for(var d=0;d<this.buttons.length;d++)this.buttons[d].postRender();b.on(window,"resize",function(){setTimeout(function(){a.isHidden()||a.safeSetOffset(c.getClientRect(a.getDom()))})}),this._hide()},mesureSize:function(){var a=this.getDom("body"),b=c.getClientRect(this.getDom("content")).width,d=a.style;return d.width=b,c.getClientRect(a)},_onTitlebarMouseDown:function(a,d){if(this.draggable){var e,f=c.getViewportRect(),g=this;c.startDrag(a,{ondragstart:function(){e=c.getClientRect(g.getDom()),g.dragMask.show(g.getDom().style.zIndex-1)},ondragmove:function(a,b){var c=e.left+a,d=e.top+b;g.safeSetOffset({left:c,top:d})},ondragstop:function(){b.removeClasses(g.getDom(),["edui-state-centered"]),g.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml()},_show:function(){this._hidden&&(this.getDom().style.display="",this.editor.container.style.zIndex&&(this.getDom().style.zIndex=this.editor.container.style.zIndex*1+10),this._hidden=!1,this.fireEvent("show"),baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4)},isHidden:function(){return this._hidden},_hide:function(){this._hidden||(this.getDom().style.display="none",this.getDom().style.zIndex="",this._hidden=!0,this.fireEvent("hide"))},open:function(){this.autoReset&&this.reset(),this.showAtCenter();if(this.iframeUrl)try{this.getDom("iframe").focus()}catch(a){}},_onCloseButtonClick:function(a,b){this.close(!1)},close:function(a){this.fireEvent("close",a)!==!1&&this._hide()}},a.inherits(g,e)}(),function(){var a=baidu.editor.utils,b=baidu.editor.ui.Menu,c=baidu.editor.ui.SplitButton,d=baidu.editor.ui.MenuButton=function(a){this.initOptions(a),this.initMenuButton()};d.prototype={initMenuButton:function(){var a=this;this.uiName="menubutton",this.popup=new b({items:a.items,className:a.className,editor:a.editor}),this.popup.addListener("show",function(){var b=this;for(var c=0;c<b.items.length;c++)b.items[c].removeState("checked"),b.items[c].value==a._value&&(b.items[c].addState("checked"),this.value=a._value)}),this.initSplitButton()},setValue:function(a){this._value=a}},a.inherits(d,c)}(),function(){var a=baidu.editor.browser.ie,b=baidu.editor.utils,c=baidu.editor.ui,d=c.Dialog;c.Dialog=function(a){var b=new d(a);return b.addListener("hide",function(){if(b.editor){var a=b.editor;try{a.focus()}catch(c){}}}),b};var e,f,g=["Undo","Redo","FormatMatch","Bold","Italic","Underline","StrikeThrough","Subscript","Superscript","Source","Indent","Outdent","BlockQuote","PastePlain","PageBreak","SelectAll","Print","Preview","Horizontal","RemoveFormat","Time","Date","Unlink","InsertParagraphBeforeTable","InsertRow","InsertCol","MergeRight","MergeDown","DeleteRow","DeleteCol","SplittoRows","SplittoCols","SplittoCells","MergeCells","DeleteTable"];e=g.length;while(e--)f=g[e],c[f]=function(a){return function(b,d){d=d||b.options.labelMap[a.toLowerCase()]||"";var e=new c.Button({className:"edui-for-"+a.toLowerCase(),title:d,onclick:function(){b.execCommand(a)},showText:!1});return b.addListener("selectionchange",function(c,d,f){var g=b.queryCommandState(a.toLowerCase());g==-1?(e.setDisabled(!0),e.setChecked(!1)):f||(e.setDisabled(!1),e.setChecked(g))}),e}}(f);c.SnapScreen=function(b,d){var e="SnapScreen";d=d||b.options.labelMap[e.toLowerCase()]||"";var f=new c.Button({className:"edui-for-"+e.toLowerCase(),title:d,onclick:function(){b.execCommand(e)}});if(a){var g=b.options.iframeUrlMap.snapscreen;g=b.ui.mapUrl(g),d=d||b.options.labelMap.snapscreen||"";var h=new c.Dialog({iframeUrl:g,autoReset:!0,draggable:!0,editor:b,className:"edui-for-snapscreen",title:d,buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){h.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){h.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});h.render(),b.snapscreenInstall=h}return b.addListener("selectionchange",function(){var a=b.queryCommandState("snapscreen");f.setDisabled(a==-1)}),f},c.ClearDoc=function(a,b){var d="ClearDoc";b=b||a.options.labelMap[d.toLowerCase()]||"";var e=new c.Button({className:"edui-for-"+d.toLowerCase(),title:b,onclick:function(){confirm("\u786e\u5b9a\u6e05\u7a7a\u6587\u6863\u5417\uff1f")&&a.execCommand("cleardoc")}});return a.addListener("selectionchange",function(){var b=a.queryCommandState("cleardoc");e.setDisabled(b==-1)}),e},c.Justify=function(a,b,d){b=(b||"left").toLowerCase(),d=d||a.options.labelMap["justify"+b.toLowerCase()]||"";var e=new c.Button({className:"edui-for-justify"+b.toLowerCase(),title:d,onclick:function(){a.execCommand("Justify",b)}});return a.addListener("selectionchange",function(c,d,f){var g=a.queryCommandState("Justify");e.setDisabled(g==-1);var h=a.queryCommandValue("Justify");e.setChecked(h==b&&!f)}),e},c.JustifyLeft=function(a,b){return c.Justify(a,"left",b)},c.JustifyCenter=function(a,b){return c.Justify(a,"center",b)},c.JustifyRight=function(a,b){return c.Justify(a,"right",b)},c.JustifyJustify=function(a,b){return c.Justify(a,"justify",b)},c.ImageFloat=function(a,b,d){b=(b||"none").toLowerCase(),d=d||a.options.labelMap["image"+b.toLowerCase()]||"";var e=new c.Button({className:"edui-for-image"+b.toLowerCase(),title:d,onclick:function(){a.execCommand("imagefloat",b)}});return a.addListener("selectionchange",function(c){var d=a.queryCommandState("imagefloat");e.setDisabled(d==-1);var d=a.queryCommandValue("imagefloat");e.setChecked(d==b)}),e},c.ImageNone=function(a,b){return c.ImageFloat(a,b)},c.ImageLeft=function(a,b){return c.ImageFloat(a,"left",b)},c.ImageRight=function(a,b){return c.ImageFloat(a,"right",b)},c.ImageCenter=function(a,b){return c.ImageFloat(a,"center",b)},c.Directionality=function(a,b,d){b=(b||"left").toLowerCase(),d=d||a.options.labelMap["directionality"+b.toLowerCase()]||"";var e=new c.Button({className:"edui-for-directionality"+b.toLowerCase(),title:d,onclick:function(){a.execCommand("directionality",b)},type:b});return a.addListener("selectionchange",function(b,c,d){var f=a.queryCommandState("directionality");e.setDisabled(f==-1);var g=a.queryCommandValue("directionality");e.setChecked(g==e.type&&!d)}),e},c.DirectionalityLtr=function(a,b){return new c.Directionality(a,"ltr",b)},c.DirectionalityRtl=function(a,b){return new c.Directionality(a,"rtl",b)};var h=["BackColor","ForeColor"];e=h.length;while(e--)f=h[e],c[f]=function(a){return function(b,d){d=d||b.options.labelMap[a.toLowerCase()]||"";var e=new c.ColorButton({className:"edui-for-"+a.toLowerCase(),color:"default",title:d,editor:b,onpickcolor:function(c,d){b.execCommand(a,d)},onpicknocolor:function(){b.execCommand(a,"default"),this.setColor("transparent"),this.color="default"},onbuttonclick:function(){b.execCommand(a,this.color)}});return b.addListener("selectionchange",function(){var c=b.queryCommandState(a);c==-1?e.setDisabled(!0):e.setDisabled(!1)}),e}}(f);var i=["SearchReplace","Help","Spechars"];e=i.length;while(e--)f=i[e],c[f]=function(a){return a=a.toLowerCase(),function(b,d,e){d=d||b.options.iframeUrlMap[a.toLowerCase()]||"about:blank",d=b.ui.mapUrl(d),e=e||b.options.labelMap[a.toLowerCase()]||"";var f=new c.Dialog({iframeUrl:d,autoReset:!0,draggable:!0,editor:b,className:"edui-for-"+a,title:e,onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});f.render();var g=new c.Button({className:"edui-for-"+a,title:e,onclick:function(){f.open()}});return b.addListener("selectionchange",function(){var c=b.queryCommandState(a);c==-1?g.setDisabled(!0):g.setDisabled(!1)}),g}}(f);var j=["Attachment","Anchor","Link","InsertImage","Map","GMap","InsertVideo","TableSuper","HighlightCode","InsertFrame","EditTd"];e=j.length;while(e--)f=j[e],c[f]=function(a){return a=a.toLowerCase(),function(b,d,e){d=d||b.options.iframeUrlMap[a.toLowerCase()]||"about:blank",d=b.ui.mapUrl(d),e=e||b.options.labelMap[a.toLowerCase()]||"";var f=new c.Dialog({iframeUrl:d,autoReset:!0,draggable:!0,editor:b,className:"edui-for-"+a,title:e,buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){f.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){f.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});f.render();var g=new c.Button({className:"edui-for-"+a,title:e,onclick:function(){f.open()}});return b.addListener("selectionchange",function(){var c=b.queryCommandState(a);c==-1?g.setDisabled(!0):(g.setChecked(c),g.setDisabled(!1))}),g}}(f);c.WordImage=function(a){var b=new c.Button({className:"edui-for-wordimage",title:"\u56fe\u7247\u8f6c\u5b58",onclick:function(){a.execCommand("wordimage","word_img"),a.ui._dialogs.wordImageDialog.open()}});return a.addListener("selectionchange",function(){var c=a.queryCommandState("wordimage","word_img");c==-1?b.setDisabled(!0):(b.setDisabled(!1),b.setChecked(c))}),b},c.FontFamily=function(a,d,e){d=d||a.options.listMap.fontfamily||[],e=e||a.options.labelMap.fontfamily||"";var f=[];for(var g=0;g<d.length;g++){var h=d[g],i=a.options.fontMap[h],j='"'+h+'"',k=new RegExp(h,"i");i&&(j='"'+i.join('","')+'"',k=new RegExp("(?:\\|)"+i.join("|")+"(?:\\|)","i")),f.push({label:h,value:j,regex:k,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+b.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})}var l=new c.Combox({editor:a,items:f,onselect:function(b,c){a.execCommand("FontFamily",this.items[c].value)},onbuttonclick:function(){this.showPopup()},title:e,initValue:a.options.ComboxInitial.FONT_FAMILY,className:"edui-for-fontfamily",indexByValue:function(a){if(a){a="|"+a.replace(/,/g,"|").replace(/"/g,"")+"|",a.replace(/\s*|\s*/g,"|");for(var b=0;b<this.items.length;b++){var c=this.items[b];if(c.regex.test(a))return b}}return-1}});return a.addListener("selectionchange",function(b,c,d){if(!d){var e=a.queryCommandState("FontFamily");if(e==-1)l.setDisabled(!0);else{l.setDisabled(!1);var f=a.queryCommandValue("FontFamily");f&&(f=f.replace(/['"]/g,"").split(",")[0]),l.setValue(f)}}}),l},c.FontSize=function(a,b,d){b=b||a.options.listMap.fontsize||[],d=d||a.options.labelMap.fontsize||"";var e=[];for(var f=0;f<b.length;f++){var g=b[f]+"px";e.push({label:g,value:g,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}var h=new c.Combox({editor:a,items:e,title:d,initValue:a.options.ComboxInitial.FONT_SIZE,onselect:function(b,c){a.execCommand("FontSize",this.items[c].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});return a.addListener("selectionchange",function(b,c,d){if(!d){var e=a.queryCommandState("FontSize");e==-1?h.setDisabled(!0):(h.setDisabled(!1),h.setValue(a.queryCommandValue("FontSize")))}}),h},c.Paragraph=function(a,b,d){b=b||a.options.listMap.paragraph||[],d=d||a.options.labelMap.paragraph||"";var e=[];for(var f=0;f<b.length;f++){var g=b[f].split(":"),h=g[0],i=g[1];e.push({label:i,value:h,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}})}var j=new c.Combox({editor:a,items:e,title:d,initValue:a.options.ComboxInitial.PARAGRAPH,className:"edui-for-paragraph",onselect:function(b,c){a.execCommand("Paragraph",this.items[c].value)},onbuttonclick:function(){this.showPopup()}});return a.addListener("selectionchange",function(b,c,d){if(!d){var e=a.queryCommandState("Paragraph");if(e==-1)j.setDisabled(!0);else{j.setDisabled(!1);var f=a.queryCommandValue("Paragraph"),g=j.indexByValue(f);g!=-1?j.setValue(f):j.setValue(j.initValue)}}}),j},c.CustomStyle=function(a,b,d){b=b||a.options.listMap.customstyle||[],d=d||a.options.labelMap.customstyle||"";for(var e=0,f=[],g;g=b[e++];)(function(a){f.push({label:a.label,value:a,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+a.tag+" "+(a.className?' class="'+a.className+'"':"")+(a.style?' style="'+a.style+'"':"")+">"+a.label+"</"+a.tag+">"+"</div>"}})})(g);var h=new c.Combox({editor:a,items:f,title:d,initValue:a.options.ComboxInitial.CUSTOMSTYLE,className:"edui-for-customstyle",onselect:function(b,c){a.execCommand("customstyle",this.items[c].value)},onbuttonclick:function(){this.showPopup()},indexByValue:function(a){for(var b=0,c;c=this.items[b++];)if(c.label==a)return b-1;return-1}});return a.addListener("selectionchange",function(b,c,d){if(!d){var e=a.queryCommandState("customstyle");if(e==-1)h.setDisabled(!0);else{h.setDisabled(!1);var f=a.queryCommandValue("customstyle"),g=h.indexByValue(f);g!=-1?h.setValue(f):h.setValue(h.initValue)}}}),h},c.InsertTable=function(a,b,d){b=b||a.options.iframeUrlMap.inserttable||"about:blank",b=a.ui.mapUrl(b),d=d||a.options.labelMap.inserttable||"";var e=new c.Dialog({iframeUrl:b,autoReset:!0,draggable:!0,editor:a,className:"edui-for-inserttable",title:d,buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){e.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){e.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});e.render(),a.tableDialog=e;var f=new c.TableButton({editor:a,title:d,className:"edui-for-inserttable",onpicktable:function(b,c,d){a.execCommand("InsertTable",{numRows:d,numCols:c})},onmore:function(){e.open()},onbuttonclick:function(){e.open()}});return a.addListener("selectionchange",function(){var b=a.queryCommandState("inserttable");b==-1?f.setDisabled(!0):f.setDisabled(!1)}),f},c.AutoTypeSet=function(a,b,d){d=d||a.options.labelMap.autotypeset||"";var e=new c.AutoTypeSetButton({editor:a,title:d,className:"edui-for-autotypeset",onbuttonclick:function(){a.execCommand("autotypeset")}});return a.addListener("selectionchange",function(){e.setDisabled(a.queryCommandState("autotypeset")==-1)}),e},c.LineHeight=function(a,b){for(var d=0,e,f=[];e=a.options.listMap.lineheight[d++];)f.push({label:e=="1"?"\u9ed8\u8ba4":e,value:e,onclick:function(){a.execCommand("lineheight",this.value)}});var g=new c.MenuButton({editor:a,className:"edui-for-lineheight",title:b||a.options.labelMap.lineheight||"",items:f,onbuttonclick:function(){var b=a.queryCommandValue("LineHeight")||this.value;a.execCommand("LineHeight",b)}});return a.addListener("selectionchange",function(){var b=a.queryCommandState("LineHeight");if(b==-1)g.setDisabled(!0);else{g.setDisabled(!1);var c=a.queryCommandValue("LineHeight");c&&g.setValue((c+"").replace(/cm/,"")),g.setChecked(b)}}),g},c.RowSpacingTop=function(a,b){for(var d=0,e,f=[];e=a.options.listMap.rowspacing[d++];)f.push({label:e,value:e,onclick:function(){a.execCommand("rowspacing",this.value,"top")}});var g=new c.MenuButton({editor:a,className:"edui-for-rowspacingtop",title:b||a.options.labelMap.rowspacingtop||"\u6bb5\u524d\u95f4\u8ddd",items:f,onbuttonclick:function(){var b=a.queryCommandValue("rowspacing","top")||this.value;a.execCommand("rowspacing",b,"top")}});return a.addListener("selectionchange",function(){var b=a.queryCommandState("rowspacing","top");if(b==-1)g.setDisabled(!0);else{g.setDisabled(!1);var c=a.queryCommandValue("rowspacing","top");c&&g.setValue((c+"").replace(/%/,"")),g.setChecked(b)}}),g},c.RowSpacingBottom=function(a,b){for(var d=0,e,f=[];e=a.options.listMap.rowspacing[d++];)f.push({label:e,value:e,onclick:function(){a.execCommand("rowspacing",this.value,"bottom")}});var g=new c.MenuButton({editor:a,className:"edui-for-rowspacingbottom",title:b||a.options.labelMap.rowspacingbottom||"\u6bb5\u540e\u95f4\u8ddd",items:f,onbuttonclick:function(){var b=a.queryCommandValue("rowspacing","bottom")||this.value;a.execCommand("rowspacing",b,"bottom")}});return a.addListener("selectionchange",function(){var b=a.queryCommandState("rowspacing","bottom");if(b==-1)g.setDisabled(!0);else{g.setDisabled(!1);var c=a.queryCommandValue("rowspacing","bottom");c&&g.setValue((c+"").replace(/%/,"")),g.setChecked(b)}}),g},c.InsertOrderedList=function(a,b){b=b||a.options.labelMap.insertorderedlist||"";var d=function(){a.execCommand("InsertOrderedList",this.value)},e=new c.MenuButton({editor:a,className:"edui-for-insertorderedlist",title:b,items:[{label:"1,2,3...",value:"decimal",onclick:d},{label:"a,b,c ...",value:"lower-alpha",onclick:d},{label:"i,ii,iii...",value:"lower-roman",onclick:d},{label:"A,B,C",value:"upper-alpha",onclick:d},{label:"I,II,III...",value:"upper-roman",onclick:d}],onbuttonclick:function(){var b=a.queryCommandValue("InsertOrderedList")||this.value;a.execCommand("InsertOrderedList",b)}});return a.addListener("selectionchange"
,function(){var b=a.queryCommandState("InsertOrderedList");if(b==-1)e.setDisabled(!0);else{e.setDisabled(!1);var c=a.queryCommandValue("InsertOrderedList");e.setValue(c),e.setChecked(b)}}),e},c.InsertUnorderedList=function(a,b){b=b||a.options.labelMap.insertunorderedlist||"";var d=function(){a.execCommand("InsertUnorderedList",this.value)},e=new c.MenuButton({editor:a,className:"edui-for-insertunorderedlist",title:b,items:[{label:"\u25cb \u5c0f\u5706\u5708",value:"circle",onclick:d},{label:"\u25cf \u5c0f\u5706\u70b9",value:"disc",onclick:d},{label:"\u25a0 \u5c0f\u65b9\u5757",value:"square",onclick:d}],onbuttonclick:function(){var b=a.queryCommandValue("InsertUnorderedList")||this.value;a.execCommand("InsertUnorderedList",b)}});return a.addListener("selectionchange",function(){var b=a.queryCommandState("InsertUnorderedList");if(b==-1)e.setDisabled(!0);else{e.setDisabled(!1);var c=a.queryCommandValue("InsertUnorderedList");e.setValue(c),e.setChecked(b)}}),e},c.FullScreen=function(a,b){b=b||a.options.labelMap.fullscreen||"";var d=new c.Button({className:"edui-for-fullscreen",title:b,onclick:function(){a.ui&&a.ui.setFullScreen(!a.ui.isFullScreen()),this.setChecked(a.ui.isFullScreen())}});return a.addListener("selectionchange",function(){var b=a.queryCommandState("fullscreen");d.setDisabled(b==-1),d.setChecked(a.ui.isFullScreen())}),d},c.Emotion=function(a,b,d){d=d||a.options.labelMap.emotion||"",b=b||a.options.iframeUrlMap.emotion||"about:blank",b=a.ui.mapUrl(b);var e=new c.MultiMenuPop({title:d,editor:a,className:"edui-for-emotion",iframeUrl:b});return a.addListener("selectionchange",function(){var b=a.queryCommandState("emotion");b==-1?e.setDisabled(!0):e.setDisabled(!1)}),e}}(),function(){function d(a){this.initOptions(a),this.initEditorUI()}var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,c=baidu.editor.ui.UIBase;d.prototype={uiName:"editor",initEditorUI:function(){this.editor.ui=this,this._dialogs={},this.initUIBase(),this._initToolbars();var a=this.editor,b=a.options.iframeUrlMap;a.addListener("ready",function(){baidu.editor.dom.domUtils.on(a.window,"scroll",function(){baidu.editor.ui.Popup.postHide()}),a.options.elementPathEnabled&&(a.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">path:</div>'),a.options.wordCount&&(a.ui.getDom("wordcount").innerHTML="\u5b57\u6570\u7edf\u8ba1");if(!a.selection.isFocus())return;a.fireEvent("selectionchange",!1,!0)}),a.addListener("mousedown",function(a,b){var c=b.target||b.srcElement;baidu.editor.ui.Popup.postHide(c)}),a.addListener("contextmenu",function(a,b){baidu.editor.ui.Popup.postHide()});var c=this;a.addListener("selectionchange",function(){if(!a.selection.isFocus())return;c._updateElementPath(),c._wordCount()}),a.addListener("sourcemodechanged",function(b,d){a.options.elementPathEnabled&&(d?c.disableElementPath():c.enableElementPath()),a.options.wordCount&&(d?c.disableWordCount():c.enableWordCount())});var d=new baidu.editor.ui.Dialog({iframeUrl:b?a.ui.mapUrl(b.link):"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-link",title:"\u8d85\u94fe\u63a5",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){d.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){d.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});d.render();var e=new baidu.editor.ui.Dialog({iframeUrl:b?a.ui.mapUrl(b.insertimage):"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-insertimage",title:"\u56fe\u7247",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){e.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){e.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});e.render();var f=new baidu.editor.ui.Dialog({iframeUrl:b?a.ui.mapUrl(b.anchor):"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-anchor",title:"\u951a\u70b9",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){f.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){f.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});f.render();var g=new baidu.editor.ui.Dialog({iframeUrl:b?a.ui.mapUrl(b.insertvideo):"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-insertvideo",title:"\u89c6\u9891",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){g.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){g.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});g.render();var h=new baidu.editor.ui.Dialog({iframeUrl:b?a.ui.mapUrl(b.wordimage):"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-wordimage",title:"\u56fe\u7247\u8f6c\u5b58",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){h.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){h.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});h.render(),c._dialogs.wordImageDialog=h;var i=new baidu.editor.ui.Dialog({iframeUrl:b?c.mapUrl(b.edittd):"about:blank",autoReset:!0,draggable:!0,editor:a,className:"edui-for-edittd",title:"\u5355\u5143\u683c",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){i.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){i.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});i.render(),c._dialogs.tdDialog=i;var j=new baidu.editor.ui.Dialog({iframeUrl:b?a.ui.mapUrl(b.map):"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-map",title:"\u5730\u56fe",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){j.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){j.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});j.render();var k=new baidu.editor.ui.Dialog({iframeUrl:b?a.ui.mapUrl(b.gmap):"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-gmap",title:"Google\u5730\u56fe",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){k.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){k.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});k.render();var l=new baidu.editor.ui.Popup({editor:a,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide(),d.open()},_onImgEditButtonClick:function(){this.hide();var b=a.selection.getRange().getClosedNode(),c=baidu.editor.dom.domUtils.findParentByTagName(b,"img",!0);c&&c.className.indexOf("edui-faked-video")!=-1?g.open():c&&c.src.indexOf("http://api.map.baidu.com")!=-1?j.open():c&&c.src.indexOf("http://maps.google.com/maps/api/staticmap")!=-1?k.open():c&&c.getAttribute("anchorname")?f.open():c&&c.getAttribute("word_img")?(a.word_img=[c.getAttribute("word_img")],a.ui._dialogs.wordImageDialog.open()):e.open()},_getImg:function(){var b=a.selection.getRange().getClosedNode();return!b||b.nodeName!="img"&&b.nodeName!="IMG"?null:b},_onImgSetFloat:function(b){if(this._getImg()){a.execCommand("imagefloat",b);var c=this._getImg();c&&this.showAnchor(c)}},_setIframeAlign:function(a){var b=l.anchorEl,c=b.cloneNode(!0);switch(a){case-2:c.setAttribute("align","");break;case-1:c.setAttribute("align","left");break;case 1:c.setAttribute("align","right");break;case 2:c.setAttribute("align","middle")}b.parentNode.insertBefore(c,b),baidu.editor.dom.domUtils.remove(b),l.anchorEl=c,l.showAnchor(l.anchorEl)},_updateIframe:function(){a._iframe=l.anchorEl,m.open(),l.hide()},_onRemoveButtonClick:function(){var b=a.selection.getRange().getClosedNode(),c=baidu.editor.dom.domUtils.findParentByTagName(b,"img",!0);c&&c.getAttribute("anchorname")?a.execCommand("anchor"):a.execCommand("unlink"),this.hide()},queryAutoHide:function(b){if(b&&b.ownerDocument==a.document)if(b.tagName.toLowerCase()=="img"||baidu.editor.dom.domUtils.findParentByTagName(b,"a",!0))return b!==l.anchorEl;return baidu.editor.ui.Popup.prototype.queryAutoHide.call(this,b)}});l.render();var m=new baidu.editor.ui.Dialog({iframeUrl:b?a.ui.mapUrl(b.insertframe):"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-insertframe",title:"\u63d2\u5165iframe",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){m.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){m.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});m.render(),a.addListener("mouseover",function(b,c){c=c||window.event;var d=c.target||c.srcElement;if(/iframe/ig.test(d.tagName)&&a.options.imagePopup){var e=l.formatHtml('<nobr>\u5c5e\u6027: <span onclick=$$._setIframeAlign(-2) class="edui-clickable">\u9ed8\u8ba4</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">\u5de6\u5bf9\u9f50</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">\u53f3\u5bf9\u9f50</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(2) class="edui-clickable">\u5c45\u4e2d</span> <span onclick="$$._updateIframe( this);" class="edui-clickable">\u4fee\u6539</span></nobr>');e?(l.getDom("content").innerHTML=e,l.anchorEl=d,l.showAnchor(l.anchorEl)):l.hide()}}),a.addListener("selectionchange",function(b,c){if(!c)return;var d="",e=a.selection.getRange().getClosedNode();e!=null&&e.tagName.toLowerCase()=="img"&&(e.getAttribute("anchorname")?d+=l.formatHtml('<nobr>\u5c5e\u6027: <span onclick=$$._onImgEditButtonClick(event) class="edui-clickable">\u4fee\u6539</span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick(event) class="edui-clickable">\u5220\u9664</span></nobr>'):a.options.imagePopup&&(d+=l.formatHtml('<nobr>\u5c5e\u6027: <span onclick=$$._onImgSetFloat("none") class="edui-clickable">\u9ed8\u8ba4</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">\u5c45\u5de6</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">\u5c45\u53f3</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">\u5c45\u4e2d</span> <span onclick="$$._onImgEditButtonClick(event, this);" class="edui-clickable">\u4fee\u6539</span></nobr>')));var f;a.selection.getRange().collapsed?f=a.queryCommandValue("link"):f=a.selection.getStart(),f=baidu.editor.dom.domUtils.findParentByTagName(f,"a",!0);var g;if(f!=null&&(g=f.getAttribute("data_ue_src")||f.getAttribute("href",2))!=null){var h=g;g.length>30&&(h=g.substring(0,20)+"..."),d&&(d+='<div style="height:5px;"></div>'),d+=l.formatHtml('<nobr>\u94fe\u63a5: <a target="_blank" href="'+g+'" title="'+g+'" >'+h+"</a>"+' <span class="edui-clickable" onclick="$$._onEditButtonClick(event, this);">\u4fee\u6539</span>'+' <span class="edui-clickable" onclick="$$._onRemoveButtonClick(event, this);"> \u6e05\u9664</span></nobr>'),l.showAnchor(f)}d?(l.getDom("content").innerHTML=d,l.anchorEl=e||f,l.showAnchor(l.anchorEl)):l.hide()})},_initToolbars:function(){var a=this.editor,b=this.toolbars||[],c=[];for(var d=0;d<b.length;d++){var e=b[d],f=new baidu.editor.ui.Toolbar;for(var g=0;g<e.length;g++){var h=e[g],i=null;if(typeof h=="string"){h=="|"&&(h="Separator"),baidu.editor.ui[h]&&(i=new baidu.editor.ui[h](a));if(h=="FullScreen"){c&&c[0]?c[0].items.splice(0,0,i):f.items.splice(0,0,i);continue}}else i=h;i&&f.add(i)}c[d]=f}this.toolbars=c},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox"><div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+"</div></div>"+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;">'+'<div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">\u70b9\u6b64\u4e0a\u4f20</div>'+'<div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div>'+'<div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div>'+'<div style="height:0;overflow:hidden;clear:both;"></div>'+"</div>"+"</div>"+'<div id="##_iframeholder" class="%%-iframeholder"></div>'+'<div id="##_bottombar" class="%%-bottomContainer"><table><tr>'+'<td id="##_elementpath" class="%%-bottombar"></td>'+'<td id="##_wordcount" class="%%-wordcount"></td>'+"</tr></table></div>"+"</div>"},showWordImageDialog:function(){this.editor.execCommand("wordimage","word_img"),this._dialogs.wordImageDialog.open()},renderToolbarBoxHtml:function(){var a=[];for(var b=0;b<this.toolbars.length;b++)a.push(this.toolbars[b].renderHtml());return a.join("")},setFullScreen:function(a){if(this._fullscreen!=a){this._fullscreen=a,this.editor.fireEvent("beforefullscreenchange",a);var b=this.editor;if(baidu.editor.browser.gecko)var c=b.selection.getRange().createBookmark();a?(this._bakHtmlOverflow=document.documentElement.style.overflow,this._bakBodyOverflow=document.body.style.overflow,this._bakAutoHeight=this.editor.autoHeightEnabled,this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop),this._bakAutoHeight&&(b.autoHeightEnabled=!1,this.editor.disableAutoHeight()),document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden",this._bakCssText=this.getDom().style.cssText,this._bakCssText1=this.getDom("iframeholder").style.cssText,this._updateFullScreen()):(this.getDom().style.cssText=this._bakCssText,this.getDom("iframeholder").style.cssText=this._bakCssText1,this._bakAutoHeight&&(b.autoHeightEnabled=!0,this.editor.enableAutoHeight()),document.documentElement.style.overflow=this._bakHtmlOverflow,document.body.style.overflow=this._bakBodyOverflow,window.scrollTo(0,this._bakScrollTop));if(baidu.editor.browser.gecko){var d=document.createElement("input");document.body.appendChild(d),b.body.contentEditable=!1,setTimeout(function(){d.focus(),setTimeout(function(){b.body.contentEditable=!0,b.selection.getRange().moveToBookmark(c).select(!0),baidu.editor.dom.domUtils.remove(d),a&&window.scroll(0,0)})})}this.editor.fireEvent("fullscreenchanged",a),this.triggerLayout()}},_wordCount:function(){var a=this.getDom("wordcount");if(!this.editor.options.wordCount){a.style.display="none";return}a.innerHTML=this.editor.queryCommandValue("wordcount")},disableWordCount:function(){var a=this.getDom("wordcount");a.innerHTML="",a.style.display="none",this.wordcount=!1},enableWordCount:function(){var a=this.getDom("wordcount");a.style.display="",this.wordcount=!0,this._wordCount()},_updateFullScreen:function(){if(this._fullscreen){var a=b.getViewportRect();this.getDom().style.cssText="border:0;position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px;z-index:"+(this.getDom().style.zIndex*1+100),b.setViewportOffset(this.getDom(),{left:0,top:0}),this.editor.setHeight(a.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight)}},_updateElementPath:function(){var a=this.getDom("elementpath"),b;if(this.elementPathEnabled&&(b=this.editor.queryCommandValue("elementpath"))){var c=[];for(var d=0,e;e=b[d];d++)c[d]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+d+'&quot;);">'+e+"</span>");a.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">path: '+c.join(" &gt; ")+"</div>"}else a.style.display="none"},disableElementPath:function(){var a=this.getDom("elementpath");a.innerHTML="",a.style.display="none",this.elementPathEnabled=!1},enableElementPath:function(){var a=this.getDom("elementpath");a.style.display="",this.elementPathEnabled=!0,this._updateElementPath()},isFullScreen:function(){return this._fullscreen},postRender:function(){c.prototype.postRender.call(this);for(var a=0;a<this.toolbars.length;a++)this.toolbars[a].postRender();var b=this,d,e=baidu.editor.dom.domUtils,f=function(){clearTimeout(d),d=setTimeout(function(){b._updateFullScreen()})};e.on(window,"resize",f),b.addListener("destroy",function(){e.un(window,"resize",f),clearTimeout(d)})},showToolbarMsg:function(a,b){this.getDom("toolbarmsg_label").innerHTML=a,this.getDom("toolbarmsg").style.display="";if(!b){var c=this.getDom("upload_dialog");c.style.display="none"}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(a){return a.replace("~/",this.editor.options.UEDITOR_HOME_URL||"")},triggerLayout:function(){var a=this.getDom();a.style.zoom=="1"?a.style.zoom="100%":a.style.zoom="1"}},a.inherits(d,baidu.editor.ui.UIBase),baidu.editor.ui.Editor=function(a){var b=new baidu.editor.Editor(a);b.options.editor=b,new d(b.options);var c=b.render;return b.render=function(a){if(a){a.constructor===String&&(a=document.getElementById(a)),a&&a.getAttribute("name")&&(b.options.textarea=a.getAttribute("name"));if(a&&/script|textarea/ig.test(a.tagName)){var d=document.createElement("div");a.parentNode.insertBefore(d,a),b.options.initialContent=a.value||a.innerHTML,a.id&&(d.id=a.id),a.className&&(d.className=a.className),a.style.cssText&&(d.style.cssText=a.style.cssText),a.parentNode.removeChild(a),a=d,a.innerHTML=""}}b.ui.render(a);var e=b.ui.getDom("iframeholder");b.container=b.ui.getDom(),b.container.style.zIndex=b.options.zIndex,c.call(b,e)},b}}(),function(){var a=baidu.editor.utils,b=baidu.editor.ui.Popup,c=baidu.editor.ui.SplitButton,d=baidu.editor.ui.MultiMenuPop=function(a){this.initOptions(a),this.initMultiMenu()};d.prototype={initMultiMenu:function(){var a=this;this.popup=new b({content:"",editor:a.editor,iframe_rendered:!1,onshow:function(){this.iframe_rendered||(this.iframe_rendered=!0,this.getDom("content").innerHTML='<iframe id="'+a.id+'_iframe" src="'+a.iframeUrl+'" frameborder="0"></iframe>',a.editor.container.style.zIndex&&(this.getDom().style.zIndex=a.editor.container.style.zIndex*1+1))}}),this.onbuttonclick=function(){this.showPopup()},this.initSplitButton()}},a.inherits(d,c)}()}(),function(){var a=baidu.editor.dom.domUtils,b=baidu.editor.dom.dtd,c=baidu.editor.utils,d=baidu.editor.ui,e,f,g="off";baidu.editor.commands.insertcode={execCommand:function(a,b){var c=this;e=c.options.iframeUrlMap[a.toLowerCase()]||"about:blank",e=c.ui.mapUrl(e+(b?"&cb="+b:"")),f=c.options.labelMap[a.toLowerCase()]||"";var h=new d.Dialog({iframeUrl:e,autoReset:!0,draggable:!0,editor:c,className:"edui-for-"+a,title:f,buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){h.close(!0),g="off"}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){h.close(!1),g="off"}}],onok:function(){},oncancel:function(){g="off"},onclose:function(a,b){return b?this.onok():this.oncancel()}});h.render(),h.open(),g="on"},queryCommandState:function(){return g=="on"?1:0}}}(),KISSY.add("lib/ueditor",function(a,b,c,d,e,f){function n(b){this.opt={target:"",toolbar:"",content:"",initOk:function(){},uploadObj:null,autoFocus:!1,toolbars:null,autoHeight:!0,enableInsertCode:!1},a.mix(this.opt,b);if(d.mobile){var c,e;(c=a.indexOf("image",this.opt.toolbars))&&this.opt.toolbars.splice(c,1),this.opt.autoHeight=!1,this.opt.autoFocus=!1}this.init()}var g=b.get,h=c.on,i,j,k,l='body{font-size:14px;color:#444;font-family:"Microsoft Yahei","\u5fae\u8f6f\u96c5\u9ed1",Tahoma,Arial,Helvetica,STHeiti;word-wrap:break-word;}blockquote{border-left:4px solid gainsboro;padding-left:15px;margin:0 15px;}.pagebreak{background:none !important;background-color:transparent !important;color:transparent !important;border:none !important;border-bottom:1px dotted #999999 !important;border-top:1px dotted #999999 !important;clear:both !important;cursor:default !important;height: 5px !important;padding: 0 !important;width: 100% !important;margin-bottom:10px;overflow: hidden;}body .syntaxhighlighter .gutter .line{border-right:3px solid #e1e1e1 !important;}a,a:link,a:visited{color:#307DCA;}',m="";return a.augment(n,a.EventTarget),a.augment(n,{uiButtons:{},initToolbarStatus:{},init:function(){var c=this,d=c.opt,e=d.target=g(d.target),f=d.toolbar=g(d.toolbar),h;d.height=(d.height?d.height:parseInt(d.target.offsetHeight,10)||300)-30;if(d.toolbars){var i,j,k;if(i=a.indexOf("image",d.toolbars))d.toolbars[i]=new baidu.editor.ui.Button({className:"edui-for-image"});if(j=a.indexOf("Intro",d.toolbars))d.toolbars[j]=new baidu.editor.ui.Button({className:"edui-for-help",title:UEDITOR_CONFIG.labelMap.intro,label:'<a href="http://www.diandian.com/help/content?id=15" target="_blank"></a>'});if(k=a.indexOf("Code",d.toolbars))c.codeButton=d.toolbars[k]=new baidu.editor.ui.Button({className:"edui-for-code",title:UEDITOR_CONFIG.labelMap.code});d.toolbars=[d.toolbars]}this._initEditor(),h=document.createElement("div"),b.insertBefore(h,e),h.id=e.id+"_editor",b.hide(e),d.target=g("#"+h.id),this.editor.render(h),this._dispatchImage(),this._dispatchPageBreak(),this._dispatchFullScreen(),this._dispatchExtImage(),this._dispatchCode(),this._initAdapter(),this._initEvent(),d.initOk.call(this)},_initEvent:function(){function d(){clearTimeout(c),c=setTimeout(function(){for(var b in a.initToolbarStatus)a.initToolbarStatus[b]()},10)}var a=this;j=b.text(a.editor.body),this.opt.enableInsertCode&&a.editor.addListener("keydown",function(b,c){var d=c.keyCode||c.which,e;(c.ctrlKey||c.metaKey)&&c.altKey&&d=="67"&&a._codeHandler()}),a.editor.addListener("selectionchange",function(c){d();var f=b.text(a.editor.body);k?(j=f,k=!1):f!=j&&(j=f,e.Dispatcher.fire("editor-user-active"))});var c;d()},_serializeConfig:function(){var a={style:1,align:1,dir:1},b={p:1,span:1,strong:1,b:1,em:1,i:1,u:1,img:1,ul:1,ol:1,blockquote:1,$:a},c={span:1,strong:1,b:1,em:1,i:1,u:1,img:1,$:{}},d=baidu.editor.utils.extend;return{blackList:{style:1,script:1,link:1,object:1,applet:1,input:1,meta:1,base:1,button:1,select:1,textarea:1,iframe:1,"#comment":1}}}(),_initEditor:function(){var b=this,c=b.opt,d=c.toolbars||baidu.editor.config.defaultToolbars,e;"submit"===ENV.contribute&&(e=a.indexOf("FullScreen",d[0]))>=0&&d[0].splice(e,1),c.autoHeight&&(m+="body{overflow:hidden;}"),this.editor=new baidu.editor.ui.Editor({initialContent:c.content,initialStyle:l+m,enterTag:"p",toolbars:d,minFrameHeight:c.height,autoHeightEnabled:c.autoHeight,autoFloatEnabled:c.autoHeight,serialize:b._serializeConfig,elementPathEnabled:!1,wordCount:!1,sourceEditor:"textarea",imagePopup:!1,focus:c.autoFocus})},_filter:function(){return{styles:{"text-decoration : underline ;":"edui-filter-underline","text-decoration : line-through ;":"edui-filter-line-through","text-decoration : none ;":"edui-filter-decoration-none","list-style-type : decimal ;":"edui-filter-decimal","list-style-type : lower-alpha ;":"edui-filter-lower-alpha","list-style-type : lower-roman ;":"edui-filter-lower-roman","list-style-type : upper-alpha ;":"edui-filter-upper-alpha","list-style-type : upper-roman ;":"edui-filter-upper-roman","list-style-type : disc ;":"edui-filter-disc","list-style-type : square ;":"edui-filter-square","list-style-type : circle ;":"edui-filter-circle","text-align : center ;":"edui-filter-align-center","text-align : left ;":"edui-filter-align-left","text-align : right ;":"edui-filter-align-right"},"<p><br /></p>":"<p>&nbsp;</p>","<pre class=":"<pre config=",getOnly:{"&nbsp;((&nbsp;)*)":" $1","<div[^>]*>":"<p>","</div>":"</p>","<p[^>]*?>[\\s\\n]*</p>":"<p>&nbsp;</p>"},setOnly:{"<p>[\\s\\n]*</p>":"<p><br/></p>"}}}(),_initAdapter:function(){function c(a){return a.replace(/ +/g,"\\s*").replace(/\:/,"\\:").replace(/;/,";?").replace(/\//,"\\/")}function d(a){return"(<[^>]+?)"+a+"([^>]+?>)"}function e(a){return"$1"+a+"$2"}var b=this;b.editor.getData=function(){if(!b.editor.hasContents())return"";var f=b.editor.getContent(),g=b._filter.styles,h=b._filter.getOnly;f=f.replace(new RegExp(d("style\\s*="),"gi"),e("class="));for(var i in g)f=f.replace(new RegExp(d(c(i)),"gi"),e(" "+g[i]+" "));for(var i in h)f=f.replace(new RegExp(i,"gi"),h[i]);for(var i in b._filter){if(!a.isString(b._filter[i]))continue;f=f.replace(new RegExp(c(i),"g"),b._filter[i])}if(a.indexOf("PageBreak",b.opt.toolbars)&&f){f=f.replace(/_dd_page_break_tag_/g,"<!--more-->");var j,k=!0;while((j=f.match(/^(.*?)<\!--more-->/))&&k)j=j[1].replace(/(<p>)|(<\/p>)|(\&nbsp;\s*)|(<br\s*\/?>)/g,""),!j||j.match(/^(<[a-zA-Z]+>)+$/)?f=(j||"")+f.replace(/^(.*?)<\!--more-->/,""):k=!1}return f},b.editor.setData=function(c){var f=b._filter.styles,g=b._filter.setOnly;c=c.replace(new RegExp(d("class\\s*="),"gi"),e("style="));for(var h in f)c=c.replace(new RegExp(d(f[h]),"g"),e(h));for(var h in g)c=c.replace(new RegExp(h,"gi"),g[h]);for(var h in b._filter){if(!a.isString(b._filter[h]))continue;if(_v=b._filter[h])c=c.replace(new RegExp(_v,"g"),h)}a.indexOf("PageBreak",b.opt.toolbars)&&(c=c.replace(/<\!--more-->/g,"_dd_page_break_tag_")),k=!0,b.editor.setContent(c)}},getFileUpload:function(a,b){var c=this,d=new i({clicker:a,clickerWidth:b.width,clickerHeight:b.height,useInputWrap:!0,allowFileTypes:"*.jpg;*.png;*.gif;*.jpeg;*.bmp",url:e.url.host+"/upload?imgsize=b57",zIndex:1e4});return d.guidEle=g("#dd-frameupload-form-"+d.guid),d.on("fileSelected",function(a){c.fileDialogCompleteHandler(a,d),(b.onstart||function(){})(a,d)}),d.on("mouseover",b.over||function(){}),d.on("mouseout",b.out||function(){}),d.on("uploadComplete",function(a){c.uploadCompleteHandler(a,d),(b.oncomplete||function(){})(a,d)}),d},fileDialogCompleteHandler:function(a,c){if(!a.data)return;c.startUpload(),b.hide(c.guidEle)},uploadCompleteHandler:function(a,c){b.show(c.guidEle);if(!a.data.url)e.alert(a.data.result);else try{this.editor.execCommand("inserthtml",'<img src="'+a.data.url+'" id="'+a.data.id+'"/>'),e.Dispatcher.fire("editor-image-upload")}catch(d){}},_dispatchImage:function(){var a=this,c=a.opt,d=g(".edui-for-image",c.target);if(!d)return"";KISSY.use("lib/frameupload.$7202",function(c,e){i=e;var f=b.children(d)[0],g=a.getFileUpload(d,{width:22,height:22,over:function(){b.addClass(f,"edui-state-hover")},out:function(){b.removeClass(f,"edui-state-hover")},onstart:function(){b.removeClass(f,"edui-state-hover"),b.addClass(f,"edui-state-disabled")},oncomplete:function(){b.removeClass(f,"edui-state-disabled")}});a.initToolbarStatus.image=function(){var c=a.editor.queryCommandState("source"),d=a.editor.queryCommandState("highlightcode");c==0&&d==0?c=0:c=1,b[c==1?"addClass":"removeClass"](f,"edui-state-disabled"),g[c==1?"disable":"enable"]()}})},_dispatchPageBreak:function(){var a=this,c=a.opt,d=g(".edui-for-pagebreak",c.target);if(!d)return"";var e=g("#"+d.id+"_state");if(d){function f(){var c=a.editor.queryCommandState("pagebreak"),d=a.editor.queryCommandState("highlightcode"),f=a.editor.body.getElementsByTagName("hr"),g=!1;for(var h=0,i=f.length;h<i;h++)if(f[h].className=="pagebreak"){g=!0;break}return!g&&c!=-1&&d!=1?b.removeClass(e,"edui-state-disabled"):e.className="edui-state-disabled",!f}this.initToolbarStatus.pagebreak=f}},_dispatchFullScreen:function(){var b=this,c=b.opt;if(!a.indexOf("FullScreen",c.toolbars))return"";b.editor.addListener("fullscreenchanged",function(a,c){b.editor.body.style.overflow=c?"auto":"hidden"})},_dispatchExtImage:function(){function d(){var d=b.editor.body.getElementsByTagName("img"),g=[];for(var h=0,i=d.length;h<i;h++){var j=d[h].src;j.match(/(\.libdd\.com)|(\.diandian\.com)\//)||c[j]||(g.push(j),c[j]=1)}g.length!=0&&f({type:"post",url:e.url.host+"/dianlog/editor_download",data:{data:a.JSON.stringify(g)}})}var b=this,c={};this.initToolbarStatus["ext-image"]=d},_codeHandler:function(){if(this.editor.queryCommandState("insertcode")==1)return;var c=this,d=c.editor.selection.getRange().startContainer,e=b.parent(d,".syntaxhighlighter"),f="_cb_"+(new Date).getTime();if(e){var g=b.get(".container",e),h=b.query(".line",g),i=[],j=b.attr(e,"highlighter");j=j.match(/brush:\s*([^;]+);/)[1],a.each(h,function(a,c){i.push(b.text(a))}),i=i.join("\n"),window[f]=function(){return[i,j]},c.editor.execCommand("insertcode",f)}else c.editor.execCommand("insertcode")},_dispatchCode:function(){function e(){a.editor.queryCommandState("source")==1?a.codeButton.setDisabled(!0):a.codeButton.setDisabled(!1)}var a=this,b=a.opt,d=g(".edui-for-code",b.target);if(!d)return"";c.on(d,"click",function(){a._codeHandler()}),this.initToolbarStatus.code=e}}),n},{requires:["dom","event","ua","util.$7202","ajax"]});