KISSY.add("app/publisher/plugins/fixpanel",function(a,b,c,d){var e="#pb-aside",f="#pb-main",g="publisher-fixed-hook",h,i={init:function(c){if(a.UA.ie<7||!b.get(e))return;this.maxY=80,this.minY=108,h=c,this.initParams(),this.addEvent()},initParams:function(){this.left=b.offset(f).left+b.outerWidth(f)},addEvent:function(){var a=this;c.on(window,"scroll",function(c){a.refresh();var e=b.get(".ks-cal-call"),f,g=b.get("#post-by-timer-holder"),h=b.get("#modify-createtime-timer-holder");g&&g.style.display!="none"?f=g:h&&h.style.display!="none"&&(f=h);if(e&&e.style.display!="none"){var i=b.offset(f).top+b.height(f);b.css(e,{top:i})}var j=b.get(".skin-combobox-layer-publisher"),k=d.get("publisher-menu");if(j&&k&&b.offset(j).top>0){k=k.main;var i=b.offset(k).top+b.height(k);b.css(j,{top:i+9})}}),c.on(window,"resize",function(b){a.update()}),c.on(h,"fix:refresh",function(){a.update()})},update:function(){this.initParams(),this.refresh()},refresh:function(){var a=this;a._setMirror();var c=b.scrollTop(),d=b.outerHeight(e),f=b.docHeight();if(c+b.viewportHeight()>f)return;c>a.minY?c+d>f-a.maxY?(c=f-a.maxY-d-c,a._fix(c.toString())):a._fix(0):a._unfix()},_setMirror:function(){var a=this;if(a.fixed){var c=b.outerHeight(e);b.get("#"+g)?b.css("#"+g,{height:c}):b.insertBefore(b.create("<div id='"+g+"' style='height:"+c+"px'></div>"),e)}},_fix:function(a){var c={position:"fixed",left:this.left};a!="null"&&(c.top=a||0),this.fixed=!0,this._setMirror(),b.css(e,c)},_unfix:function(){b.css(e,{position:"static",top:"0",left:"0"}),b.remove("#"+g),this.fixed=!1}};return i},{requires:["dom","event","sky.$6939"]});